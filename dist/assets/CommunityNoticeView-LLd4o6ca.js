import{g as K,M as pe}from"./splitpanes.es-dEoJOrhT.js";import{d as R,a5 as E,bS as fe,a as r,c as v,G as x,al as ye,l as H,Y as e,a0 as h,K as I,F as A,C as P,h as O,ab as he,k as C,j as d,az as ve,ai as _e,aj as B,bV as ge,bW as we,Q as Y,aD as G,o as Z,w as M,X,ax as xe,a3 as Ce,V as W,t as te,$ as be,a1 as $e,a2 as q,aa as ke,an as j,ao as Ne,ah as U,ad as De,bY as J,eF as Ie,bQ as Oe,ae as Se,ap as Le,R as ee}from"./index-eLyz9_Ts.js";import{_ as Ve}from"./PaginationSecondary.vue_vue_type_script_setup_true_lang-5bABwX9_.js";import{_ as Me}from"./NoticeHeader.vue_vue_type_script_setup_true_lang-U6uA3q-H.js";import{_ as se}from"./VDCEditor.vue_vue_type_script_setup_true_lang-IhnNo6sk.js";import{c as Re}from"./comment-helper-7aBDqVRT.js";import{P as Ae}from"./PublicIcon-IoLQp8uU.js";import{u as Ee}from"./file-Gx0JxWZZ.js";import{_ as Fe}from"./FileDropzone.vue_vue_type_script_setup_true_lang-SVeHifZw.js";import{G as Te}from"./GRadioGroup-cHw1G1ew.js";import{_ as Ue}from"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";import{_ as Pe}from"./Comment.vue_vue_type_script_setup_true_lang-4b5dYawy.js";import{_ as ze}from"./PostModal.vue_vue_type_script_setup_true_lang-ywCBp_X3.js";import{_ as He}from"./PrintModal.vue_vue_type_script_setup_true_lang-ZsBYknDF.js";import{u as Be}from"./use-dynamic-height-sJY6bk6Z.js";import"./GSingleSelect-7u8H0FdH.js";import"./vue-multiselect-Yz8FsF-E.js";import"./use-model-wrapper-XtiLc3Xd.js";import"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";import"./use-date-GeeGTbYh.js";import"./ContentHeaderButtons.vue_vue_type_script_setup_true_lang-Db8CUXqr.js";import"./ConfirmModal.vue_vue_type_script_setup_true_lang-k_ZxaDhN.js";import"./ModalButton.vue_vue_type_script_setup_true_lang-WIw8hxFk.js";import"./file-division-code-x51qUgaH.js";import"./FileListView.vue_vue_type_script_setup_true_lang-A40KFqZZ.js";import"./GVideoPlayer-1SUF8s3O.js";import"./main-sHItgwS4.js";import"./vue.runtime.esm-bundler-3P3R-Xon.js";/* empty css                                                                    */import"./comment.helper-kn9hfxav.js";import"./XIcon-gk7lh7BZ.js";import"./vue-resizable.umd.min-blE9hPz6.js";const je={class:"h-[95%]"},Ge=R({__name:"NoticeList",props:{isLoading:{type:Boolean},pageInfo:{},selectedRowIndex:{},rowData:{}},emits:["selected-rows","on-change-page","select-size"],setup(k,{emit:_}){const p=_,{t:s}=E(),f=[{headerName:"NO",field:"NO",maxWidth:45,valueGetter:"node.rowIndex",cellRenderer:o=>{const y=o.api.getDisplayedRowCount();return fe(o,y)},cellStyle:{textAlign:"center"}},{headerName:s("Community.제목"),field:"title",cellStyle:{textAlign:"left"}},{headerName:s("Community.부서"),field:"department",maxWidth:140,cellStyle:{textAlign:"center"}},{headerName:s("Community.작성자"),field:"reporter",maxWidth:110,cellStyle:{textAlign:"center"}},{headerName:s("Community.조회"),field:"check",maxWidth:70,cellStyle:{textAlign:"center"}},{headerName:s("Community.전송일시"),field:"createdDate",maxWidth:100,cellStyle:{textAlign:"center"}}],g=o=>{p("selected-rows",o)},c=o=>{p("on-change-page",o)},b=o=>{p("select-size",o)};return(o,y)=>(r(),v("div",je,[x(ye,{intent:"primary","column-defs":f,"row-data":o.rowData,"selected-row-index":o.selectedRowIndex,"is-loading":"","row-height":25,"page-info":o.pageInfo,"row-selection":"multiple",onSelectedRows:g},null,8,["row-data","selected-row-index","page-info"]),x(Ve,{"current-page":o.pageInfo.page,"page-info":o.pageInfo,onOnChangePage:c,onSelectSize:b},null,8,["current-page","page-info"])]))}}),Ye={class:"space-y-3"},We={class:"flex justify-between items-center gap-4"},Ze={class:"text-xs"},Qe={key:0,class:"flex items-start gap-3 px-2"},Ke={class:"inline-block rounded-sm min-w-max px-1"},Xe=["innerHTML"],oe=R({__name:"NoticeChildComments",props:{child:{},userList:{},userMngId:{}},setup(k){const _=k,p=H(()=>_.child.childComments.length);return(s,f)=>(r(),v("div",Ye,[e("div",We,[e("span",null,h((s.child.inputUserName||"")+" / "+(s.child.inputUserDeptName||"")),1),e("span",Ze,h(s.child.inputDateTime),1)]),s.child.isEditing?I("",!0):(r(),v("div",Qe,[e("b",Ke,"@"+h(s.child.inputUserName||""),1),e("div",{class:"mr-12",innerHTML:s.child.content},null,8,Xe)])),p.value?(r(!0),v(A,{key:1},P(s.child.childComments,g=>(r(),O(oe,{key:g.id,"user-mng-id":s.userMngId,child:g,"user-list":s.userList},null,8,["user-mng-id","child","user-list"]))),128)):I("",!0)]))}}),qe={class:"space-y-4 text-sm p-4 dark:text-white"},Je={class:"space-y-1 p-3 border border-primary-gray-surface"},et={class:"text-sm"},tt={class:"space-y-2"},st={class:"w-full text-xs"},ot={class:"w-[70px] border border-primary-gray-surface text-center p-2"},nt={class:"border border-primary-gray-surface p-2 px-4"},at={class:"w-[70px] border border-primary-gray-surface text-center p-2"},it={class:"border border-primary-gray-surface p-2 px-4"},lt={class:"w-[70px] border border-primary-gray-surface text-center p-2"},rt={class:"border border-primary-gray-surface p-2 px-4"},ct={class:"space-y-1 p-3 border border-primary-gray-surface"},dt={class:"text-sm"},ut={class:"space-y-4"},mt={class:"space-y-2 p-3 border border-primary-gray-surface"},pt={class:"text-sm"},ft={class:"space-y-4"},yt={class:"flex justify-between items-center gap-4"},ht={class:"text-[11px]"},vt={class:"flex justify-between gap-5"},_t=["innerHTML"],gt={key:0,class:"ml-10 space-y-3"},wt=R({__name:"NoticePrintTemplate",props:{commentList:{},noticeDetails:{}},setup(k){const _=k,{t:p}=E(),{userMngId:s}=he(),f=C(),g=H(()=>Re(_.commentList)||0);return(c,b)=>{var o,y,l,$,S;return r(),v("div",qe,[e("div",Je,[e("p",et,[e("b",null,h(d(p)("Community.기본정보")),1)]),e("div",tt,[e("table",st,[e("tbody",null,[e("tr",null,[e("td",ot,h(d(p)("Community.제목")),1),e("td",nt,h(((o=c.noticeDetails)==null?void 0:o.notiTitl)||""),1)]),e("tr",null,[e("td",at,h(d(p)("Community.작성자")),1),e("td",it,h(`${((y=c.noticeDetails)==null?void 0:y.inputrNm)||""} / ${((l=c.noticeDetails)==null?void 0:l.inputrDeptNm)||""}`),1)]),e("tr",null,[e("td",lt,h(d(p)("Community.작성일시")),1),e("td",rt,h(($=c.noticeDetails)==null?void 0:$.inputDtm),1)])])])])]),e("div",ct,[e("p",dt,[e("b",null,h(d(p)("Community.내용")),1)]),e("div",ut,[x(se,{content:(S=c.noticeDetails)==null?void 0:S.notiCtt,disabled:"","editor-class":"vdc-readonly","custom-class":"font-roboto"},null,8,["content"])])]),e("div",mt,[e("p",pt,[e("b",null,h(d(p)("Community.댓글")+" ("+g.value+")"),1)]),e("div",ft,[(r(!0),v(A,null,P(c.commentList,N=>(r(),v("div",{key:N.id,class:"space-y-4 text-xs"},[e("div",yt,[e("span",null,h((N.inputUserName||"")+" / "+(N.inputUserDeptName||"")),1),e("span",ht,h(N.inputDateTime),1)]),e("div",vt,[e("div",{innerHTML:N.content},null,8,_t)]),N.childComments.length?(r(),v("div",gt,[(r(!0),v(A,null,P(N.childComments,L=>(r(),O(oe,{key:L.id,"user-mng-id":d(s),child:L,"user-list":f.value},null,8,["user-mng-id","child","user-list"]))),128))])):I("",!0)]))),128))])])])}}}),xt={},Ct={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function bt(k,_){return r(),v("svg",Ct,_[0]||(_[0]=[e("path",{d:"M4 9L9.5 0L15 9H4ZM15 20C13.75 20 12.6875 19.5625 11.8125 18.6875C10.9375 17.8125 10.5 16.75 10.5 15.5C10.5 14.25 10.9375 13.1875 11.8125 12.3125C12.6875 11.4375 13.75 11 15 11C16.25 11 17.3125 11.4375 18.1875 12.3125C19.0625 13.1875 19.5 14.25 19.5 15.5C19.5 16.75 19.0625 17.8125 18.1875 18.6875C17.3125 19.5625 16.25 20 15 20ZM0.5 19.5V11.5H8.5V19.5H0.5ZM15 18C15.7 18 16.2917 17.7583 16.775 17.275C17.2583 16.7917 17.5 16.2 17.5 15.5C17.5 14.8 17.2583 14.2083 16.775 13.725C16.2917 13.2417 15.7 13 15 13C14.3 13 13.7083 13.2417 13.225 13.725C12.7417 14.2083 12.5 14.8 12.5 15.5C12.5 16.2 12.7417 16.7917 13.225 17.275C13.7083 17.7583 14.3 18 15 18ZM2.5 17.5H6.5V13.5H2.5V17.5ZM7.55 7H11.45L9.5 3.85L7.55 7Z",fill:"#0071FF"},null,-1)]))}const $t=ve(xt,[["render",bt]]),kt={class:"h-full text-sm flex flex-col"},Nt={class:"px-2 py-4 space-y-3"},Dt={class:"min-h-[26px] dark:bg-dark bg-primary-gray-80 py-1 px-3 border border-primary-gray-30 text-primary-black-100 font-roboto font-medium text-xs dark:text-white"},It={class:"flex flex-wrap gap-x-10 text-xs gap-y-3 text-primary-gray-40 dark:text-white"},Ot={class:"flex items-center gap-2"},St={class:"flex items-center gap-2"},Lt={class:"flex items-center gap-2"},Vt={class:"flex items-center gap-2"},Mt={class:"dark:bg-dark-secondary bg-primary-gray-80 p-2 h-full border border-primary-gray-20 rounded-[3px]"},Rt={class:"dark:bg-dark bg-white p-2 h-full rounded-[3px]"},At=R({__name:"NoticeDetail",props:{noticeDetail:{}},setup(k){const{t:_}=E();return(p,s)=>{var g,c,b,o;const f=_e("tooltip");return r(),v("div",kt,[e("div",Nt,[e("div",Dt,h(((g=p.noticeDetail)==null?void 0:g.notiTitl)||""),1),e("div",It,[e("div",Ot,[B(x(ge,null,null,512),[[f,d(_)("Community.작성자")]]),e("p",null,h((c=p.noticeDetail)==null?void 0:c.inputrNm),1)]),e("div",St,[B(x($t,null,null,512),[[f,d(_)("Community.종류")]]),s[0]||(s[0]=e("p",null,"취재",-1))]),e("div",Lt,[B(x(we,null,null,512),[[f,d(_)("Community.작성시간")]]),e("p",null,h((b=p.noticeDetail)==null?void 0:b.inputDtm),1)]),e("div",Vt,[B(x(Ae,null,null,512),[[f,d(_)("Community.공개여부")]]),s[1]||(s[1]=e("p",null,"공개",-1))])])]),e("div",Mt,[e("div",Rt,[x(se,{content:(o=p.noticeDetail)==null?void 0:o.notiCtt,disabled:"","editor-class":"vdc-readonly","custom-class":"font-roboto"},null,8,["content"])])])])}}}),Et={class:"w-2/4 flex justify-between text-xs pt-2 pb-1"},Ft={class:"text-black dark:text-white"},Tt=R({__name:"NoticeAttachedFile",props:{noticeDetail:{}},setup(k){const _=k,{t:p}=E(),{fileDownload:s,downloadAllFiles:f}=Ee(),g=H(()=>{var o;return(o=_.noticeDetail)==null?void 0:o.attcFiles.map(y=>({...y,name:y.fileNm,fileId:y.id}))}),c=async o=>{await s(o.file)},b=async()=>{var o;(o=g.value)!=null&&o.length&&await f(g.value)};return(o,y)=>{var l;return r(),v(A,null,[e("div",Et,[e("p",Ft,h(d(p)("Community.등록된 파일")),1),e("p",{class:"text-primary-blue-100 text-[10px] cursor-pointer hover:no-underline underline",onClick:b},h(d(p)("Community.전체 다운로드")),1)]),e("div",{class:Y(["h-full",{"flex items-center justify-center":!((l=g.value)!=null&&l.length)}])},[x(Fe,{"file-data":g.value,mode:"read","file-list-custom-class":"!p-0 text-black","is-read-only":"","is-show-file":"",onOnDownloadFile:c},null,8,["file-data"])],2)],64)}}}),Ut={class:"flex gap-5 text-sm pt-2 pb-8 dark:text-white"},Pt={class:"text-primary-gray-40 dark:text-white"},zt={class:"space-y-4 w-full"},Ht={class:"space-y-4"},Bt={class:"flex gap-1"},jt={class:"ml-2 space-y-1"},Gt={class:"border border-primary-gray-110 rounded-full overflow-hidden"},Yt={class:"ml-1"},Wt=R({__name:"NoticeVotingModal",props:{voteId:{},title:{}},emits:["on-close"],setup(k,{emit:_}){const p=k,s=G(),{t:f}=E(),g=_,c=C([]),b=()=>{g("on-close")},o=async y=>{const l=await s.community.notice.getVote(y);l&&(c.value=l.data)};return Z(async()=>{await o(p.voteId)}),(y,l)=>(r(),O(Ce,{intent:"primary","modal-class":"max-w-[650px] w-3/5 md:w-2/5 !rounded-b-none !rounded-[3px]",onClose:b},{title:M(()=>[X(h(d(f)("Community.투표결과 보기")),1)]),content:M(()=>[e("div",Ut,[e("p",Pt,h(d(f)("Community.제목")),1),e("div",zt,[e("p",null,h(d(f)("Community.회식에 어울리는 음식은?")),1),e("ul",Ht,[(r(!0),v(A,null,P(c.value,($,S)=>(r(),v("li",{key:S,class:"space-y-2"},[e("div",Bt,[e("span",null,h(S+1)+".",1),X(h($.optCtt),1)]),e("div",jt,[e("div",Gt,[e("div",{class:"bg-primary-gray-110 h-[15px]",style:xe({width:$.percentage+"%"})},null,4)]),e("p",Yt,h(`${$.voteCount}명 (${$.percentage}%) / 투표자 : ${$.voters}`),1)])]))),128))])])])]),_:1}))}}),Zt={class:"p-2 border-b border-primary-gray-surface mb-2"},Qt={class:"font-bold text-black dark:text-white"},Kt={key:0,class:"space-y-3 text-black dark:text-white"},Xt={class:"text-xs gap-5 flex flex-wrap"},qt={class:"text-primary-gray-40 dark:text-white"},Jt={class:"pt-3 pb-4 px-6 border border-black flex gap-5"},es={class:"text-xs text-primary-gray-40 dark:text-white"},ts={class:"space-y-2 flex-grow"},ss={class:"text-xs"},os={class:"dark:bg-dark border border-primary-gray-999 bg-primary-gray-90 py-1 px-3 text-sm max-w-[343px]"},ns={key:0},as={key:1},is={key:2},ls={key:0,class:"flex justify-end"},rs=R({__name:"NoticeVote",props:{voteList:{}},emits:["get-notice"],setup(k,{emit:_}){const p=_,s=k,f=C(),g=G(),{t:c}=E(),b=C([]),o=W({title:"",isShow:!1,voteId:0}),y=W({votes:[],voteOpts:[]}),l=C(s.voteList?s.voteList:[]),$=C([]),S=async()=>{var n,w;(n=l.value)!=null&&n.length&&(y.votes=[...y.votes,...l.value]),(w=b.value)!=null&&w.length&&(y.voteOpts=[...y.voteOpts,...b.value]),await g.community.notice.createVote(y)&&(window.Notify.success({message:"[투표 등록] 완료되었습니다."}),y.votes=[],y.voteOpts=[],f.value="",p("get-notice"))},N=(t,n)=>{o.isShow=!0,o.voteId=t,o.title=n},L=(t,n)=>{if(!l.value.find(i=>i.voteId===t))l.value.push({voteId:t,voteOptId:n.voteOptId});else{const i=l.value.findIndex(u=>u.voteId===t);i!==-1&&(l.value[i].voteOptId=n.voteOptId)}},F=(t,n,w)=>{w?l.value.push({voteId:t,voteOptId:n}):l.value=l.value.filter(i=>i.voteOptId!==n)},T=(t,n)=>{y.voteOpts.find(i=>i.voteId===t)?y.voteOpts=y.voteOpts.map(i=>i.voteId===t?{...i,optCtt:n}:i):y.voteOpts.push({voteId:t,optCtt:n})};return te(()=>s.voteList,t=>{t!=null&&t.length?(l.value=[],$.value=t.map(n=>{var i;let w=null;return(i=n.voteOptions)!=null&&i.length&&n.voteOptions.forEach(u=>{u.checked&&(l.value.push({voteId:n.voteId,voteOptId:u.voteOptId}),w=u.voteOptId)}),{...n,itemChecked:w}})):$.value=[]},{immediate:!0}),(t,n)=>{var w;return r(),v(A,null,[e("div",Zt,[e("p",Qt,h(d(c)("Community.투표")),1)]),$.value.length?(r(),v("div",Kt,[(r(!0),v(A,null,P($.value,i=>(r(),v("div",{key:i.voteId,class:"space-y-2"},[e("div",Xt,[e("p",qt,h(d(c)("Community.투표가능 일정")),1),e("p",null,h(`${i.voteStartDt||""} ~ ${i.voteEndDt||""}`),1)]),e("div",Jt,[e("p",es,h(d(c)("Community.제목")),1),e("div",ts,[e("p",ss,h(i.voteTitl),1),e("div",os,[i.allowAnonymous?(r(),v("span",ns,h(`${d(c)("Community.익명투표")} / ${d(c)("Community.투표진행 비공개")}`),1)):(r(),v("span",as,h(`${d(c)("Community.익명투표 불가")} / ${d(c)("Community.투표진행 공개")}`),1)),i.allowOptionAdd?(r(),v("span",is,h(` / ${d(c)("Community.선택항목 추가")}`),1)):I("",!0)]),i.allowMultiple?(r(!0),v(A,{key:0},P(i.voteOptions,u=>(r(),v("div",{key:u.voteOptId},[x(be,{modelValue:u.checked,"onUpdate:modelValue":V=>u.checked=V,class:"text-primary-gray-40",label:u.voteOptCtt,name:`option_${u.voteOptId}`,onChange:V=>F(i.voteId,u.voteOptId,V)},null,8,["modelValue","onUpdate:modelValue","label","name","onChange"])]))),128)):(r(),O(Te,{key:1,modelValue:i.itemChecked,"onUpdate:modelValue":u=>i.itemChecked=u,class:"text-primary-gray-40",name:`optionRadio_${i.voteId}`,"track-by":"voteOptCtt","value-key":"voteOptId","format-type":"row","font-size":"text-sm",options:i.voteOptions,onChange:u=>L(i.voteId,u)},null,8,["modelValue","onUpdate:modelValue","name","options","onChange"])),i.allowOptionAdd?(r(),O($e,{key:2,modelValue:f.value,"onUpdate:modelValue":[n[0]||(n[0]=u=>f.value=u),u=>T(i.voteId,u)],intent:"primary",placeholder:d(c)("Community.항목입력"),width:"max-w-[320px]","custom-input-class":"font-medium font-roboto text-[11px]"},null,8,["modelValue","placeholder","onUpdate:modelValue"])):I("",!0)])]),e("div",null,[x(q,{type:"primary","button-text":d(c)("Community.투표결과 보기"),class:"w-[110px] h-[24px] !text-sm font-bold",onClick:u=>N(i.voteId,i.voteTitl)},null,8,["button-text","onClick"])])]))),128)),(w=t.voteList)!=null&&w.length?(r(),v("div",ls,[x(q,{type:"primary","button-text":d(c)("Community.저장"),class:"w-[63px] h-[24px] font-bold !text-sm",onClick:S},null,8,["button-text"])])):I("",!0)])):(r(),O(Ue,{key:1})),o.isShow?(r(),O(Wt,{key:2,"vote-id":o.voteId,title:o.title,onOnClose:n[1]||(n[1]=i=>o.isShow=!1)},null,8,["vote-id","title"])):I("",!0)],64)}}}),cs={class:"w-full h-full bg-white dark:bg-dark-grid"},ds=R({__name:"NoticeTabPanel",props:{noticeDetail:{},isShowDetail:{type:Boolean,default:!0},isShowAttachedFile:{type:Boolean,default:!0},isShowComment:{type:Boolean,default:!0},isShowVote:{type:Boolean,default:!0},commentList:{},isLoadingComments:{type:Boolean,default:!1},currentNoticeId:{}},emits:["on-refresh","get-notice"],setup(k,{emit:_}){const p=_,s=k,f=G(),{getChDivId:g}=ke(),c=C(!1),b=C([]),o=H(()=>{var t;return(t=s.noticeDetail)==null?void 0:t.votes}),{t:y}=E(),l=H(()=>[{id:1,name:y("Community.상세정보"),isShow:s.isShowDetail},{id:2,name:y("Community.첨부파일"),isShow:s.isShowAttachedFile},{id:3,name:y("Community.코멘트"),isShow:s.isShowComment},{id:3,name:y("Community.투표"),isShow:s.isShowVote}]),$=async(t,n)=>{if(!s.currentNoticeId)return;(await f.community.notice.editComment(s.currentNoticeId,n,t)).success&&(p("on-refresh"),window.Notify.success({message:U.communityNotice.editComment}))},S=async t=>{if(!s.currentNoticeId)return;(await f.community.notice.createComment(s.currentNoticeId,t)).success&&(p("on-refresh"),window.Notify.success({message:U.communityNotice.createComment}))},N=async t=>{if(!s.currentNoticeId)return;(await f.community.notice.deleteComment(s.currentNoticeId,t)).success&&(p("on-refresh"),window.Notify.success({message:U.communityNotice.createComment}))},L=async(t,n,w,i)=>{if(!s.currentNoticeId||s.isLoadingComments||c.value)return;const u={userId:i,notiCmntId:t,isActive:n};if(n===w){c.value=!0,u.isActive=null;const z=await f.community.notice.cancelCommentLike(s.currentNoticeId,u);z!=null&&z.success&&p("on-refresh"),c.value=!1;return}c.value=!0;const V=await f.community.notice.likeComment(s.currentNoticeId,u);V!=null&&V.success&&p("on-refresh"),c.value=!1},F=async t=>{const n=s.commentList.find(w=>w.id===t);n&&(n.isReplying=!0)},T=async()=>{const t={chDivId:g,useYn:"Y",delYn:"N",size:1e4},n=await f.community.notice.getUsers(t);n.success&&(b.value=n.data.content.map(w=>({id:w.id,name:w.userNm})))};return Z(async()=>{await T()}),(t,n)=>(r(),v("div",cs,[x(Ne,{tabs:l.value,"is-plain-text-mode":!0,"is-compact-mode":!0,class:"!p-0"},{default:M(()=>[t.isShowDetail?(r(),O(d(j),{key:0,unmount:!1,class:"overflow-y-auto flex flex-col h-full"},{default:M(()=>[x(At,{"notice-detail":t.noticeDetail},null,8,["notice-detail"])]),_:1})):I("",!0),t.isShowAttachedFile?(r(),O(d(j),{key:1,unmount:!1,class:"overflow-y-auto flex flex-col h-full"},{default:M(()=>[x(Tt,{"notice-detail":t.noticeDetail},null,8,["notice-detail"])]),_:1})):I("",!0),t.isShowComment?(r(),O(d(j),{key:2,unmount:!1,class:"overflow-y-auto h-full pt-2"},{default:M(()=>[x(Pe,{"user-list":b.value,"parent-id":t.currentNoticeId,"comment-list":t.commentList,onOnEdit:$,onOnSubmit:S,onOnRefresh:n[0]||(n[0]=()=>p("on-refresh")),onOnDelete:N,onOnLikeComment:L,onOnReply:F},null,8,["user-list","parent-id","comment-list"])]),_:1})):I("",!0),t.isShowVote?(r(),O(d(j),{key:3,unmount:!1,class:"overflow-y-auto flex flex-col h-full p-2"},{default:M(()=>[x(rs,{"vote-list":o.value,onGetNotice:n[1]||(n[1]=()=>p("get-notice"))},null,8,["vote-list"])]),_:1})):I("",!0)]),_:1},8,["tabs"])]))}}),us={class:"dark:text-white"},ms={class:"flex flex-grow h-full overflow-y-hidden mr-[-8px]"},Gs=R({__name:"CommunityNoticeView",setup(k){const{dynamicHeightVh:_}=Be("h-[86vh]","h-[86vh]"),{moveEditCommunityNotice:p,moveCreateCommunityNotice:s}=Le(),f=G(),g=C([]),c=C(!0),b=C(!1),o=C(!1),y=C(0),l=C(null),$=C(De.md),S=C([]),N=C(),L=C(),F=C(),T=()=>({searchValue:"",isDelete:!1,inputUser:"",searchDateStart:Ie,searchDateEnd:Oe,size:$.value,page:0,sort:"notiId,desc"}),t=W(T()),n=C(!1),w=C(!1),i=C({page:1,totalElements:0,totalPages:1,numberOfElements:0,size:$.value}),u=async()=>{b.value=!0;try{const a=await f.community.notice.findAll(t);a!=null&&a.success&&(S.value=a.data.content.map(m=>{const D=m.commentCount>0?`[${m.commentCount}]`:"",me=`${m.notiTitl} ${D}`;return{id:m.notiId,title:me,department:m.inputrDeptNm?m.inputrDeptNm:"-",reporter:m.inputrNm?m.inputrNm:"-",createdDate:m.inputDtm?Se(m.inputDtm).format("YYYY-MM-DD"):"-",attachment:m.attcFiles.length?String(m.attcFiles.length):"-",check:m.countHits}}),i.value={page:t.page,totalPages:a.data.totalPages,totalElements:a.data.totalElements,numberOfElements:a.data.numberOfElements,size:a.data.size})}catch(a){console.log("communityNoticeView getNotices error",a)}b.value=!1},V=async a=>{if(a)try{const m=await f.community.notice.findOne(a);m.success&&(L.value=m.data)}catch(m){console.log("Fail to get notice",m)}},z=async a=>{t.page=a,await u()},ne=async a=>{t.page=0,t.size=Number(a),await u()},ae=a=>{var m;a.length!==0&&(y.value=((m=a[0])==null?void 0:m.rowIndex)||0,l.value=a[0].data.id,c.value=!1)},ie=()=>{s()},le=async()=>{const a=await N.value.onUploadFile(),m={notiTitl:N.value.title||"",notiCtt:N.value.content||"",attcFileIds:a.length?a:[],accessUserDeptId:[],accessUserDeptNm:[]};if(l.value){const D=await f.community.notice.updateNotice(l.value,m);D!=null&&D.success?(window.Notify.success({message:U.communityNotice.edit}),await u(),await V(l.value)):window.Notify.error({message:D.msg})}else{const D=await f.community.notice.createNotice(m);D!=null&&D.success&&(window.Notify.success({message:U.communityNotice.create}),await u())}c.value=!1},re=()=>{l.value&&p(l.value)},ce=async()=>{if(!l.value)return;const a=await f.community.notice.removeNotice(l.value);a!=null&&a.success?(window.Notify.success({message:U.communityNotice.delete}),await u()):window.Notify.error({message:a.msg})},de=async a=>{t.isDelete=a.isDelete,t.searchDateStart=a.searchDateStart,t.searchDateEnd=a.searchDateEnd,await u()},Q=async()=>{if(l.value){o.value=!0;try{const a=await f.community.notice.getComments(l.value);if(a.success)return g.value=a.data,!0}catch(a){return console.log("Fail to get comment",a),!1}finally{o.value=!1}}},ue=()=>{var a;Object.assign(t,T()),(a=F.value)==null||a.resetFields()};return J(`${ee.CommunityNotice}Create`,async()=>{ue(),await u()}),J(`${ee.CommunityNotice}Edit`,async()=>{await u()}),Z(async()=>{await u()}),te(()=>l.value,async a=>{a&&(await V(a),await Q())}),(a,m)=>(r(),v("div",us,[x(Me,{ref_key:"headerRef",ref:F,"current-notice-id":l.value,onOnSearch:de,onOnCreate:ie,onOnSave:le,onOnEdit:re,onOnDelete:ce,onOnPrint:m[0]||(m[0]=D=>w.value=!0),onOnPost:m[1]||(m[1]=D=>n.value=!0)},null,8,["current-notice-id"]),e("div",ms,[x(d(pe),{class:"default-theme primary-theme"},{default:M(()=>[x(d(K),{class:Y([d(_),"overflow-auto dark:!bg-dark-secondary pt-2 pr-2"])},{default:M(()=>[x(Ge,{"is-deselected-all":c.value&&!l.value,"is-loading":b.value,"row-data":S.value,"page-info":i.value,"selected-row-index":y.value,onSelectedRows:ae,onOnChangePage:z,onSelectSize:ne},null,8,["is-deselected-all","is-loading","row-data","page-info","selected-row-index"])]),_:1},8,["class"]),x(d(K),{class:Y([d(_),"overflow-visible dark:!bg-dark-secondary p-2 border border-t-0 border-primary-gray-999 rounded-[3px] ml-[-2px]"])},{default:M(()=>[x(ds,{"current-notice-id":l.value,"comment-list":g.value,"notice-detail":L.value,"is-loading-comments":o.value,onOnRefresh:Q,onGetNotice:m[2]||(m[2]=D=>V(l.value))},null,8,["current-notice-id","comment-list","notice-detail","is-loading-comments"])]),_:1},8,["class"])]),_:1})]),n.value?(r(),O(ze,{key:0,title:L.value.notiTitl,content:L.value.notiCtt,onOnClose:m[3]||(m[3]=D=>n.value=!1)},null,8,["title","content"])):I("",!0),w.value?(r(),O(He,{key:1,onOnClose:m[4]||(m[4]=D=>w.value=!1)},{default:M(()=>[x(wt,{"comment-list":g.value,"notice-details":L.value},null,8,["comment-list","notice-details"])]),_:1})):I("",!0)]))}});export{Gs as default};
