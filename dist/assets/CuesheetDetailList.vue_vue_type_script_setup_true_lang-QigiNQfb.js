import{d as U,bc as M,aP as P,k as D,am as F,t as _,a as H,h as q,al as j,b4 as A}from"./index-eLyz9_Ts.js";import{r as z}from"./use-render-component-K20sHqiA.js";import"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";/* empty css                                                                        */import"./vue-multiselect-Yz8FsF-E.js";import"./GSingleSelect-7u8H0FdH.js";import"./tag-Q73uuSte.js";import"./program-omP_c4K3.js";import"./article-type.code-5cb8riL1.js";import"./category-zIRntbmZ.js";import"./department-wnuBQoCo.js";import{S as E,c as $,_ as J}from"./icon-zhslyYqN.js";import{C as L}from"./cuesheet-item-code-_LsFMWbX.js";import{g as K}from"./code-mapper-C6rl9hti.js";const p={Preparing:{id:"cue_st_001",name:"준비중",label:"준비중",color:"text-primary"},Drafting:{id:"cue_st_002",name:"작성중",label:"작성중",color:"text-green-400"},OnAir:{id:"cue_st_003",name:"방송중",label:"방송중",color:"text-yellow-400"},OffAir:{id:"cue_st_004",name:"방송완료",label:"방송완료",color:"text-gray-400"}},Q=[p.Preparing,p.Drafting,p.OnAir,p.OffAir],b={...p,values:Q},me=l=>{let t;switch(l){case b.Drafting.id:t="Drafting";break;case b.OnAir.id:t="OnAir";break;case b.OffAir.id:t="OffAir";break;default:t="Preparing"}return{state:b[t].name,color:b[t].color}},fe=(l="00:00:00",t=0)=>{const[n,s,S]=l.split(":").map(Number),m=new Date;m.setHours(n,s,S,0);const f=new Date(m.getTime()+t*6e4),C=g=>{const x=String(g.getHours()).padStart(2,"0"),I=String(g.getMinutes()).padStart(2,"0"),N=String(g.getSeconds()).padStart(2,"0");return`${x}:${I}:${N}`},k=C(m),v=C(f);return`${k}~${v}`},ge=(l,t)=>l&&t?`${l},${t}`:l||(t?`,${t}`:""),he=(l,t)=>`${l} ${t}`,be=(l=[])=>l.map(n=>n.artclExtTime+n.cueItemTime).reduce((n,s)=>n+s,0),pe=U({__name:"CuesheetDetailList",props:{isLoading:{type:Boolean},rowData:{},iconList:{},cuesheetId:{},mode:{},userInfo:{},fontSize:{}},emits:["on-unlock","selected-rows","on-update-item-order","on-clicked-icon","cuesheet-detail-list-api","on-clicked-contextmenu","on-edit-cuesheet-item","on-changed-cell-value","double-clicked-row","on-clicked-video-link"],setup(l,{emit:t}){const n=l,s=t,S=M(),{getCuesheet:m}=P(S),f=D(),C=D(),k=e=>{console.log("debug selectedRows"),s("selected-rows",e),C.value=e},v=e=>{console.log("debug itemOrder"),s("on-update-item-order",e)},g=e=>{if(console.log("debug rowClass"),e.data.cueItemDivCd!==L.ARTICLE.id)return"!text-[#ff00ff]";if(e.data.stopYn==="Y")return"!text-gray-400"},x=e=>A(e.data.artclExtTime+e.data.cueItemTime),I=e=>{const o=f.value?f.value.api.getRenderedNodes():[];if(!o.length)return"00:00";const r=o.slice(0,e.node.rowIndex+1).map(i=>i.data.artclExtTime+i.data.cueItemTime).reduce((i,c)=>i+c,0);return A(r)},N=(e,o,a,d)=>{const r=document.querySelector(`button[data-button="${e}-${o.rowIndex}-${a}"]`);if(r&&r.getElementsByTagName("img").length>0){const i=r.getElementsByTagName("img")[0];i.src=d.symbolUrl;return}$({url:d.symbolUrl,css:["w-12","h-6"],targetElement:r})},W=(e,o,a,d)=>{var i,c,w,h;const r=e.querySelector(`button[data-button="${o}-${a.rowIndex}-${d}"]`);for(let u=0;u<=d;u+=1)a.data.videoSymbolList&&o===E.videoSymbol.name&&((i=a.data.videoSymbolList[u])==null?void 0:i.symbolOrd)===d?$({url:(c=a.data.videoSymbolList[u].symbol)==null?void 0:c.symbolUrl,css:["w-10","h-6"],targetElement:r}):a.data.audioSymbolList&&o===E.audioSymbol.name&&((w=a.data.audioSymbolList[u])==null?void 0:w.symbolOrd)===d&&$({url:(h=a.data.audioSymbolList[u].symbol)==null?void 0:h.symbolUrl,css:["w-10","h-6"],targetElement:r})},G=(e,o=1)=>{const{lckYn:a,lckrId:d}=m.value,r=e.colDef.field,i=document.createElement("div");i.classList.add("flex","space-x-1","items-center");for(let c=0;c<o;c+=1){const w=document.createElement("div"),h={iconList:n.iconList,rowIndex:e.rowIndex,iconIndex:c,type:r,disabled:a==="N"&&n.userInfo.id!==d,onClickedIcon:y=>{s("on-clicked-icon",{type:r,data:e.data,index:h.iconIndex,icon:y}),N(r,e,c,y)},onClickedContextmenu:(y,Y)=>{s("on-clicked-contextmenu",{event:y,data:e.data,type:r},Y)}},u=z(J,h,w);W(u,r,e,c),i.appendChild(u)}return i},T=D(),V=[{headerName:"",field:"drag",sortable:!1,maxWidth:40,rowDrag:!0},{field:"checkbox",sortable:!1,maxWidth:50,headerCheckboxSelection:!0,checkboxSelection:!0,showDisabledCheckboxes:!0},{headerName:"No",field:"no",sortable:!1,minWidth:60,maxWidth:60,valueGetter:"node.rowIndex",cellRenderer:e=>F(e),cellClass:"text-center"},{headerName:"누적",field:"accumulateTime",tooltipValueGetter:I,minWidth:80,valueFormatter:I,cellClass:"text-center"},{headerName:"소요",field:"itemTime",tooltipValueGetter:x,sortable:!1,minWidth:80,valueGetter:x,cellClass:"text-center"},{headerName:"구분",field:"artclTypCd",cellRenderer:e=>K(e.value,"articleType"),cellClass:"text-center"},{headerName:"상태",field:""},{headerName:"DVE",field:""},{headerName:"DVE Comment",field:""},{headerName:"제목",field:"cueItemTitl",minWidth:250,maxWidth:250,sortable:!1,editable:e=>{const{lckYn:o,lckrId:a}=m.value;return o==="Y"&&n.userInfo.id===a?e.data.cueItemDivCd===L.ITEM.id:!1},valueGetter:e=>e.data.cueItemTitl,valueSetter:e=>(e.data.cueItemTitl=e.newValue,s("on-edit-cuesheet-item",e),!0)},{headerName:"기자",field:"rptrNm",tooltipField:"rptrNm",filter:!1,sortable:!1,minWidth:100,cellClass:"text-center"},{headerName:"VIDEO",field:E.videoSymbol.name,sortable:!1,minWidth:150,maxWidth:150,cellRenderer:e=>G(e,2)},{headerName:"비고",field:"rmk",filter:!1,sortable:!1,minWidth:150,cellClass:"editor-input",cellEditor:"agTextCellEditor",editable:e=>{const{lckYn:o,lckrId:a}=m.value;return o==="Y"&&n.userInfo.id===a?e.data.cueItemDivCd!==L.ARTICLE.id:!1},valueGetter:e=>e.data.rmk,valueSetter:e=>(e.data.rmk=e.newValue,s("on-edit-cuesheet-item",e),!0)},{headerName:"편집배정",field:""},{headerName:"영편데스크",field:""}],O=()=>{const e=["drag","checkbox"],o=n.mode==="edit";T.value.api.setColumnsVisible(e,o),T.value.api.refreshHeader()},R=e=>{f.value=e,T.value=e,O(),s("cuesheet-detail-list-api",e)},B=e=>{s("double-clicked-row",e)};return _(()=>n.mode,()=>{O()}),_(()=>T.value,e=>{e.api.destroyCalled||R(e)}),(e,o)=>(H(),q(j,{"column-defs":V,"row-data":e.rowData,"is-loading":e.isLoading,"first-selected-row":!1,"row-selection":"multiple","row-drag-managed":!0,"row-drag-multi-row":!0,"get-row-class":g,onSelectedRows:k,onOnGridReady:R,onOnRowDragEnd:v,onDoubleClickedRow:B},null,8,["row-data","is-loading"]))}});export{b as C,pe as _,ge as a,be as b,fe as c,he as d,me as g};
