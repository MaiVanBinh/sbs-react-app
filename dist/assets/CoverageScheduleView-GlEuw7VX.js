import{d as P,a as p,h as x,w as y,F as Be,a0 as ne,Y as g,c as X,C as ze,ak as Ve,M as Fe,G as a,j as f,aL as Ke,al as Me,am as Le,aM as Ue,a2 as $,k as t,ae as B,X as Q,a3 as $e,ab as Pe,t as ue,aj as K,aN as Qe,aO as Xe,aP as Ze,ah as re,l as Ne,an as fe,K as M,ao as Je,aa as ea,o as Te,a1 as se,$ as pe,aQ as aa,Q as ta,aR as la,aS as oa,ad as sa,ai as na,af as ra,L as da,aG as ia}from"./index-eLyz9_Ts.js";import{g as De,M as ua}from"./splitpanes.es-dEoJOrhT.js";import{G as _e}from"./GSingleSelect-7u8H0FdH.js";import"./tag-Q73uuSte.js";import"./program-omP_c4K3.js";import"./article-type.code-5cb8riL1.js";import{_ as xe}from"./UserSelect.vue_vue_type_script_setup_true_lang-Hk5THi0e.js";import"./category-zIRntbmZ.js";import"./vue-multiselect-Yz8FsF-E.js";import"./department-wnuBQoCo.js";import{u as ca}from"./use-date-GeeGTbYh.js";import{r as ge}from"./use-render-component-K20sHqiA.js";import{C as he,c as ma,a as va,_ as fa,b as pa}from"./UserSingleAddModal.vue_vue_type_script_setup_true_lang-Ts9ZqV7l.js";import{u as ce,_ as ga}from"./TotalWorkflow.vue_vue_type_script_setup_true_lang-RSVNUNvR.js";import{_ as Re}from"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";import{G as ha}from"./GDateTimePicker-bSYwb_xW.js";import{A as oe}from"./app-authority-code-Q9MU7mjP.js";import{_ as wa}from"./UserAddSelect.vue_vue_type_script_setup_true_lang-1UBsZdY3.js";import{_ as ba}from"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";import{u as Ae}from"./mam-foisk_XK.js";import{G as ya}from"./GVideoPlayer-1SUF8s3O.js";import{_ as Sa}from"./MediaList.vue_vue_type_script_setup_true_lang-dRAm6bIZ.js";import{u as Ca}from"./coverage-plan-nI7mLZOB.js";import{G as ke}from"./GTextarea-5GIFD2Mo.js";import{_ as Ia}from"./GTagSelect.vue_vue_type_script_setup_true_lang-WNNVbcKh.js";import{P as qe}from"./panel-size-enum-06wl-l7a.js";import"./use-model-wrapper-XtiLc3Xd.js";import"./CoveragePlanSearch.vue_vue_type_script_setup_true_lang-kZic9Ocd.js";import"./CoveragePlanList.vue_vue_type_script_setup_true_lang-vJ0F3lvx.js";import"./DepartmentMultiSelect.vue_vue_type_script_setup_true_lang-OqmQVQH2.js";import"./ArticleTypeSelect.vue_vue_type_script_setup_true_lang-Kp5wzGNr.js";import"./ConfirmButton.vue_vue_type_script_setup_true_lang-onM9evN8.js";import"./async-validator.util-IJrtpoc1.js";import"./PageLoader.vue_vue_type_script_setup_true_lang-ZvbvX14z.js";/* empty css                                                                        *//* empty css                                                                  */const Ra={class:"rounded dark:bg-dark-secondary dark:text-dark-gray-200 text-sm"},ka={class:"h-32 w-72 space-y-1 p-2 overflow-y-auto"},_a=["title"],xa=["title"],Va=P({__name:"UserListContextMenu",props:{userList:{},icon:{default:"users"}},setup(R){return(m,n)=>(p(),x(f(Ke),{distance:-10,class:"flex flex-col h-full justify-center items-center"},{popper:y(()=>[g("div",Ra,[g("div",ka,[(p(!0),X(Be,null,ze(m.userList,o=>(p(),X("div",{key:o.id,class:"grid grid-cols-2 gap-4 items-center border-b dark:border-dark-border px-4 py-2 flex justify-between items-center"},[g("div",{class:"truncate",title:`${o.userName}${o!=null&&o.userId?`(${o==null?void 0:o.userId})`:""}`},ne(o.userName)+ne(o!=null&&o.userId?`(${o==null?void 0:o.userId})`:""),9,_a),g("div",{class:"truncate",title:`${o.phoneNumber}`},ne(o.phoneNumber),9,xa)]))),128))])])]),default:y(()=>[a(Ve,{icon:m.icon,onContextmenu:n[0]||(n[0]=Fe(()=>{},["prevent"]))},null,8,["icon"])]),_:1}))}}),$a=P({__name:"CoverageScheduleList",props:{isLoading:{type:Boolean,default:!1},rowData:{},pageInfo:{},selectedRowIndex:{default:0}},emits:["selected-rows","double-clicked-row","on-change-page","on-clicked-assign-reporter","on-clicked-assign-video-reporter","on-show-coverage-plan","on-show-video-reporter"],setup(R,{emit:m}){const n=m,{formatDate:o}=ca(),h=l=>{let b;switch(l){case he.COMPLETE.id:b="primary";break;case he.INGESTING.id:b="pink";break;case he.ASSIGN.id:b="yellow";break;default:b="gray"}return b},I=l=>{const b=document.createElement("div");return b.className="flex flex-col h-6 justify-center items-center w-10",ge($,{onClick:()=>{n("on-clicked-assign-video-reporter",l)},icon:"user-plus",buttonText:"배정"},b)},c=l=>{const b=document.createElement("div");return b.className="flex flex-col h-full justify-center items-center",ge(Ve,{onClick:()=>{n("on-show-coverage-plan",l.data.coveragePlanId)},icon:"arrow-top-right-on-square"},b)},i=l=>{const b=document.createElement("div");b.className="flex flex-col h-full justify-center items-center";const q={icon:"users",userList:l.data.videoReporterList};return ge(Va,q,b)},d=[{headerName:"순번",filter:!1,minWidth:60,maxWidth:60,valueGetter:"node.rowIndex",cellRenderer:l=>Le(l)},{headerName:"취재계획",field:"coveragePlan",minWidth:85,filter:!1,cellRenderer:l=>l.data.coveragePlanId?c(l):""},{headerName:"상태",field:"statusCodeName",filter:!1,minWidth:85,maxWidth:85,cellRenderer:Ue,cellClass:"",cellRendererParams:l=>({text:l.data.scheduleStatusCodeName,color:h(l.data.scheduleStatusCode)})},{headerName:"제목",field:"title",filter:!1,minWidth:200},{headerName:"취재일시",field:"startDateTime",filter:!1,minWidth:160,valueGetter:l=>o(l.data.startDateTime,"YYYY-MM-DD HH:mm:ss")},{headerName:"취재기자",field:"reporterName",tooltipField:"reporterName",filter:!1,minWidth:100,cellRenderer:l=>{if(l.data.reporterId)return l.value}},{headerName:"영상구분",field:"obvAssignDivisionCodeName",filter:!1,minWidth:140},{headerName:"형식",field:"articleTypeCodeName",filter:!1,minWidth:80,maxWidth:80},{headerName:"영상기자",field:"videoReporterList",filter:!1,minWidth:95,cellRenderer:l=>l.value.length?i(l):I(l)},{headerName:"인제스트",field:"ingestYn",filter:!1,minWidth:85,maxWidth:85},{headerName:"작성자",field:"inputerName",filter:!1,minWidth:80,maxWidth:80},{headerName:"작성일시",field:"inputDateTime",filter:!1,minWidth:160,valueGetter:l=>o(l.data.inputDateTime,"YYYY-MM-DD HH:mm:ss")}],S=l=>{n("selected-rows",l)},w=l=>{n("double-clicked-row",l)},V=l=>{n("on-change-page",l)};return(l,b)=>(p(),x(Me,{class:"w-full h-full flex flex-col","column-defs":d,"row-data":l.rowData,"selected-row-index":l.selectedRowIndex,"is-loading":l.isLoading,filter:!1,sortable:!1,"page-info":l.pageInfo,"suppress-movable":!0,"row-selection":"single",onSelectedRows:S,onDoubleClickedRow:w,onOnChangePage:V},null,8,["row-data","selected-row-index","is-loading","page-info"]))}}),Na={class:"flex flex-col h-full"},Da={class:"flex flex-col h-full overflow-auto dark:text-dark-gray-200"},qa=["title"],Ea={class:"sm:flex sm:flex-row-reverse pt-4 pb-2"},Ma={class:"space-x-3 flex items-center"},La=P({__name:"CoverageScheduleCopyModal",props:{title:{default:""}},emits:["close","on-copy"],setup(R,{emit:m}){const n=m,o=t(B().format("YYYY-MM-DD HH:mm:DD")),h=()=>{n("close")},I=()=>{n("on-copy",o.value)};return(c,i)=>(p(),x($e,{"modal-class":"w-1/3","content-class":"h-[30vh]",onClose:h},{title:y(()=>i[1]||(i[1]=[Q(" 취재일정 복사 ")])),content:y(()=>[g("div",Na,[g("div",Da,[a(f(ha),{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=d=>o.value=d),name:"startTime",label:"취재일시",format:"yy-MM-dd HH:mm"},null,8,["modelValue"]),g("div",{class:"truncate text-center text-xl inline-block py-6",title:`${c.title}`},ne(c.title),9,qa),i[2]||(i[2]=g("div",{class:"space-y-1 items-center text-center"},[g("div",null,"항목을 복사하시겠습니까?")],-1))]),g("div",Ea,[g("div",Ma,[a($,{type:"secondary",class:"dark:bg-dark-secondary dark:text-white dark:hover:bg-gray-600",onClick:h},{default:y(()=>i[3]||(i[3]=[Q("취소")])),_:1}),a($,{onClick:I},{default:y(()=>i[4]||(i[4]=[Q(" 복사 ")])),_:1})])])])]),_:1}))}}),Ua={class:"flex flex-col h-full justify-between"},Pa={class:"sm:flex sm:flex-row-reverse pt-4 pb-2"},Ta={class:"space-x-3 flex items-center"},Aa=P({__name:"UserMultiAddModal",props:{headerTitle:{default:"사용자 추가"},label:{default:"사용자 선택"},tableName:{default:"사용자"}},emits:["close","on-add-user"],setup(R,{emit:m}){const n=m,o=t([]),h=()=>{n("close")},I=()=>{n("on-add-user",o.value)};return(c,i)=>(p(),x($e,{"modal-class":"w-1/3","overflow-fixed":"","content-class":"h-[30vh]",onClose:h},{title:y(()=>[Q(ne(c.headerTitle),1)]),content:y(()=>[g("div",Ua,[a(wa,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=d=>o.value=d),name:"userList",label:c.label,"table-name":c.tableName,searchable:"",class:"space-y-2"},null,8,["modelValue","label","table-name"]),g("div",Pa,[g("div",Ta,[a($,{type:"secondary",class:"dark:bg-dark-secondary dark:text-white dark:hover:bg-gray-600",onClick:h},{default:y(()=>i[1]||(i[1]=[Q("취소")])),_:1}),a($,{onClick:I},{default:y(()=>i[2]||(i[2]=[Q(" 추가 ")])),_:1})])])])]),_:1}))}}),Wa=P({__name:"CoverageSchedulePreview",props:{mode:{default:"read"},coverageScheduleId:{default:0},isLoading:{type:Boolean,default:!1}},setup(R){const m=R,{departmentId:n,departmentName:o}=Pe(),h=t({title:"",content:"",startDateTime:"",reportLocation:"",obvAssignDivisionCode:void 0,remark:"",articleTypeCode:void 0,vanNumber:"",departmentId:n,departmentName:o,reporter:void 0,coveragePlanId:void 0,inputerName:"",inputDateTime:"",updaterName:"",updateDateTime:"",scheduleStatusCode:"",scheduleStatusCodeName:""}),{fetchCoverageSchedule:I}=ce(),c=async()=>{var d;const i=await I(m.coverageScheduleId);i.success&&(Object.assign(h.value,i.data),h.value.department=i.data.departmentId,h.value.reporter=i.data.reporterId,h.value.coveragePlanId=(d=i.data.coveragePlan)==null?void 0:d.coveragePlanId)};return ue(()=>[m.coverageScheduleId,m.isLoading],()=>{m.coverageScheduleId&&!m.isLoading&&c()}),(i,d)=>(p(),X("div",null,[i.coverageScheduleId&&!i.isLoading?(p(),x(ma,{key:0,mode:i.mode,"coverage-schedule-meta-data":h.value,class:"flex flex-col w-full h-full"},null,8,["mode","coverage-schedule-meta-data"])):(p(),x(ba,{key:1,class:"flex flex-col w-full h-full"}))]))}}),Oa={class:"flex items-center space-x-1"},Ga=P({__name:"IngestRequestAction",props:{params:{default:void 0},title:{default:""},coverageScheduleId:{default:void 0},ingestRequestId:{default:void 0}},emits:["search-ingest-request","delete-ingest-request"],setup(R,{emit:m}){const n=R,o=m,h=()=>{o("search-ingest-request",n.ingestRequestId??0)};return(I,c)=>(p(),X("div",Oa,[K(a(Ve,{icon:"document-text",onClick:h},null,512),[[f(Qe),"상세"]])]))}}),Ya=P({__name:"IngestRequestList",props:{isLoading:{type:Boolean},rowData:{},selectedRowIndex:{default:0}},emits:["selected-rows","double-clicked-row","search-ingest-request","delete-ingest-request"],setup(R,{emit:m}){const n=m,o=d=>{let S;switch(d){case"commissioned":S="yellow";break;case"approved":S="green";break;case"rejected":S="red";break;case"pink":S="primary";break;default:S="gray";break}return S},h=d=>{const S=document.createElement("div");S.className="flex flex-col justify-center h-full";const w={onSearchIngestRequest:V=>{n("search-ingest-request",V)},onDeleteIngestRequest:V=>{n("delete-ingest-request",V)},title:d.data.title,coverageScheduleId:d.data.coverageScheduleId,ingestRequestId:d.data.ingestRequestId};return ge(Ga,w,S)},I=[{headerName:"순번",field:"NO",filter:!1,hide:!1,sortable:!1,minWidth:60,maxWidth:60,valueGetter:"node.rowIndex",cellRenderer:d=>Le(d)},{headerName:"제목",field:"title",filter:!1,hide:!1,sortable:!1,minWidth:280},{headerName:"상태",field:"statusCode",filter:!1,hide:!1,minWidth:100,headerClass:"justify-center",cellRenderer:Ue,cellRendererParams:d=>({text:d.data.status,color:o(d.value)})},{headerName:"ACTIONS",field:"action",filter:!1,hide:!1,minWidth:160,cellRenderer:d=>h(d)}],c=d=>{n("selected-rows",d)},i=d=>{n("double-clicked-row",d)};return(d,S)=>(p(),x(Me,{class:"w-full h-full flex flex-col","column-defs":I,"row-data":d.rowData,"is-loading":d.isLoading,filter:!1,sortable:!1,"suppress-movable":!1,onSelectedRows:c,onDoubleClickedRow:i},null,8,["row-data","is-loading"]))}}),Ee=Xe("ingest-event",{state:()=>({ingestRequestId:0,eventName:null,eventState:!1}),actions:{ingestRequestEventHandler(R,m){console.log("eventName",R),this.eventState=!0,this.eventName=R,this.ingestRequestId=m},clearEventHandler(){this.eventState=!1,this.eventName=null,this.ingestRequestId=0}}}),ja={class:"flex flex-col h-full space-y-2 p-1"},Ha={class:"flex justify-end"},Ba={class:"flex flex-col h-full"},za=P({__name:"IngestRequestMetaData",props:{coverageScheduleId:{default:void 0}},emits:["search-ingest-request"],setup(R,{emit:m}){const n=R,o=m,{clearEventHandler:h}=Ee(),{eventState:I,eventName:c,ingestRequestId:i}=Ze(Ee()),{deleteIngestRequest:d}=Ae(),{fetchCoverageScheduleIngestRequest:S}=ce(),w=t(!1),V=t([]),l=async()=>{try{w.value=!0;const k=await S(n.coverageScheduleId);k.success&&(V.value=k.data)}catch(k){console.error(k)}finally{w.value=!1}},b=async()=>{(await d(i.value)).success&&(window.Notify.success({message:re.ingestRequest.delete}),await l(),h())},q=k=>{k==="delete-ingest-request"&&b()},Y=()=>{l()},T=k=>{o("search-ingest-request",k)};return ue(()=>n.coverageScheduleId,k=>{k&&l()},{immediate:!0}),ue(()=>I.value,()=>{I.value&&q(c.value)},{deep:!0}),(k,z)=>(p(),X("div",ja,[g("div",Ha,[a($,{icon:"arrow-path",onClick:Y})]),g("div",Ba,[a(Ya,{"row-data":V.value,"is-loading":w.value,onSearchIngestRequest:T},null,8,["row-data","is-loading"])])]))}}),Fa={class:"flex flex-col h-full space-y-2 p-1"},Ka={class:"flex justify-end"},Qa={class:"flex flex-col h-full"},Xa=P({__name:"CoverageScheduleMedia",props:{coverageScheduleId:{default:void 0}},setup(R){const m=R,{fetchCoverageScheduleIngestMedia:n}=ce(),o=t(!1),h=t(),I=t([]),c=Ne(()=>{var w;return{src:(w=h.value)==null?void 0:w.proxyUrl,type:"video/mp4"}}),i=async()=>{try{o.value=!0;const w=await n(m.coverageScheduleId);w.success&&(I.value=w.data.content)}catch(w){console.error(w)}finally{o.value=!1}},d=()=>{i()},S=w=>{var V;h.value=(V=w[0])==null?void 0:V.data};return ue(()=>m.coverageScheduleId,w=>{w?i():I.value=[]},{immediate:!0}),(w,V)=>(p(),X("div",Fa,[g("div",Ka,[a($,{icon:"arrow-path",onClick:d})]),g("div",Qa,[a(ya,{"video-source":c.value},null,8,["video-source"]),a(Sa,{"row-data":I.value,"is-loading":o.value,"hide-actions":"",onSelectedRows:S},null,8,["row-data","is-loading"])])]))}}),Za={class:"flex flex-col h-full"},Ja=P({__name:"CoverageScheduleTabPanel",props:{isShowMetaData:{type:Boolean,default:!0},isShowMedia:{type:Boolean,default:!0},isShowRequestIngest:{type:Boolean,default:!0},isShowWorkflow:{type:Boolean,default:!0},coverageScheduleId:{default:0},isLoading:{type:Boolean,default:!1}},emits:["search-ingest-request"],setup(R,{emit:m}){const n=R,o=m,h=Ne(()=>[{id:1,name:"메타데이터",isShow:n.isShowMetaData},{id:2,name:"미디어",isShow:n.isShowMedia},{id:3,name:"인제스트 의뢰",isShow:n.isShowRequestIngest},{id:4,name:"통합이력",isShow:n.isShowWorkflow}].filter(c=>c.isShow)),I=c=>{o("search-ingest-request",c)};return(c,i)=>(p(),x(Je,{tabs:h.value},{default:y(()=>[c.isShowMetaData?(p(),x(f(fe),{key:0,unmount:!0,class:"flex flex-col h-full"},{default:y(()=>[a(Wa,{"coverage-schedule-id":c.coverageScheduleId,"is-loading":c.isLoading,class:"p-1 flex flex-col w-full h-full"},null,8,["coverage-schedule-id","is-loading"])]),_:1})):M("",!0),c.isShowMedia?(p(),x(f(fe),{key:1,unmount:!0,class:"flex flex-col h-full"},{default:y(()=>[a(Xa,{"coverage-schedule-id":c.coverageScheduleId},null,8,["coverage-schedule-id"])]),_:1})):M("",!0),c.isShowRequestIngest?(p(),x(f(fe),{key:2,unmount:!0,class:"flex flex-col h-full"},{default:y(()=>[a(za,{"coverage-schedule-id":c.coverageScheduleId,onSearchIngestRequest:I},null,8,["coverage-schedule-id"])]),_:1})):M("",!0),c.isShowWorkflow?(p(),x(f(fe),{key:3,unmount:!0,class:"flex flex-col h-full"},{default:y(()=>[g("div",Za,[a(ga,{id:c.coverageScheduleId,type:"coverageSchedule"},null,8,["id"])])]),_:1})):M("",!0)]),_:1},8,["tabs"]))}});function et(R,m){return p(),X("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[g("path",{"fill-rule":"evenodd",d:"M9.47 6.47a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 1 1-1.06 1.06L10 8.06l-3.72 3.72a.75.75 0 0 1-1.06-1.06l4.25-4.25Z","clip-rule":"evenodd"})])}const at={class:"flex flex-col h-full space-y-3 overflow-auto"},tt={class:"w-full"},lt={class:"sm:flex sm:flex-row-reverse pt-4 pb-2"},ot={class:"space-x-3 flex items-center"},st=P({__name:"IngestRequestModal",props:{coverageScheduleId:{},ingestRequestId:{default:0},mode:{default:"create"}},emits:["close"],setup(R,{emit:m}){const n=R,o=m,{fetchCoverageSchedule:h}=ce(),{fetchMetaField:I,createIngestRequest:c,updateIngestRequest:i,fetchIngestRequest:d}=Ae(),{fetchUsers:S,getChDivId:w}=ea(),V=t(!1),l=t(""),b=t(!1),q=t(!1),Y=t(!1),T=t(!1),k=t(""),z=t(""),F=t(),le=t(""),Z=t(""),J=t(),A=t(""),_=t(),L=t([]),U=t(),W=t([]),ee=t([]),O=t(),j=t(),ae=t(),de=t([]),E=t(""),we=t([{label:"1개월",value:B().add(1,"month").format()},{label:"3개월",value:B().add(3,"month").format()},{label:"6개월",value:B().add(6,"month").format()},{label:"1년",value:B().add(1,"year").format()},{label:"2년",value:B().add(2,"year").format()},{label:"영구",value:B("9999-12-31").format()}]),te=Ne(()=>n.mode==="create"?"등록":"수정"),me=()=>{o("close")},be=async()=>{try{const s=await h(n.coverageScheduleId);s.success&&(l.value=s.data.title,A.value=s.data.remark,U.value={id:s.data.reporterId,label:s.data.reporterName,name:s.data.reporterName},W.value=s.data.videoReporterList.length&&s.data.videoReporterList.map(e=>({...e,userNm:e.userName})),O.value=s.data.reportLocation)}catch(s){console.error(s)}},ye=async()=>{const s=await d(n.ingestRequestId);s.success&&(l.value=s.data.title,F.value=s.data.permanentDate,le.value=s.data.restrictionNote,Z.value=s.data.copyrightSource,b.value=s.data.embargoUse,J.value=s.data.embargo,q.value=s.data.mosaicUse,z.value=s.data.mosaic,Y.value=s.data.voiceChangeUse,k.value=s.data.voiceChange,T.value=s.data.notArchive,A.value=s.data.etc,_.value=s.data.videoVersion,U.value={id:s.data.reporterId,name:s.data.reporterName,label:s.data.reporterName},W.value=s.data.videoReporterList.map(e=>({...e,id:e.videoReporterId,userNm:e.videoReporterName})),O.value=s.data.shootingPlace,j.value=s.data.shootingDate,ae.value=s.data.videoType,E.value=s.data.comment)},ie=async s=>{try{const v=await S({chDivId:w,useYn:"Y",delYn:"N",deptId:s,size:1e4});if(v.success)return v.data.content}catch(e){return console.error(e),[]}},ve=async s=>{try{const v=await I({code:s});if(v.success)return v.data.metaOption}catch(e){return console.error(e),[]}},Se=async s=>{try{V.value=!0,(await c(s)).success&&(window.Notify.success({message:re.ingestRequest.create}),o("close"))}catch(e){console.error(e)}finally{V.value=!1}},Ce=async s=>{(await i(n.ingestRequestId,s)).success&&(window.Notify.success({message:re.ingestRequest.edit}),o("close"))},Ie=async()=>{const s={coverageScheduleId:n.coverageScheduleId,title:l.value,permanentDate:F.value,restrictionNote:le.value,copyrightSource:Z.value,embargo:J.value,mosaic:z.value,voiceChange:k.value,notArchive:T.value,etc:A.value,videoVersion:_.value,reporterId:U.value.id,videoReporterIds:W.value.length?W.value.map(e=>e.id):null,shootingPlace:O.value,shootingDate:j.value,videoType:ae.value,comment:E.value};n.mode==="create"&&await Se(s),n.mode==="edit"&&await Ce(s)};return Te(async()=>{n.mode==="create"&&await be(),n.mode==="edit"&&await ye(),ee.value=await ie(7),L.value=await ve("video_version"),de.value=await ve("video_type")}),(s,e)=>(p(),x($e,{"modal-class":"sm:w-full sm:max-w-lg","content-class":"h-[70vh]",onClose:me},{title:y(()=>e[19]||(e[19]=[g("div",null,"인제스트 의뢰 등록",-1)])),content:y(()=>[g("div",at,[a(se,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=v=>l.value=v),label:"제목",placeholder:"제목을(를) 입력해주세요"},null,8,["modelValue"]),a(Re,{modelValue:F.value,"onUpdate:modelValue":e[1]||(e[1]=v=>F.value=v),"preset-dates":we.value,"year-range":[1900,9999],label:"보관기간",placeholder:"보관기간을(를) 입력해주세요"},null,8,["modelValue","preset-dates"]),a(ke,{modelValue:le.value,"onUpdate:modelValue":e[2]||(e[2]=v=>le.value=v),label:"필독시 주의사항",rows:5,placeholder:"필독시 주의사항을(를) 입력해주세요"},null,8,["modelValue"]),a(se,{modelValue:Z.value,"onUpdate:modelValue":e[3]||(e[3]=v=>Z.value=v),label:"저작권 출처",placeholder:"저작권 출처을(를) 입력해주세요"},null,8,["modelValue"]),a(pe,{id:"isEmbargo",modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=v=>b.value=v),name:"isEmbargo",label:"엠바고 여부"},null,8,["modelValue"]),b.value?(p(),x(Re,{key:0,modelValue:J.value,"onUpdate:modelValue":e[5]||(e[5]=v=>J.value=v),placeholder:"엠바고 해제일시을(를) 입력해주세요"},null,8,["modelValue"])):M("",!0),a(pe,{id:"isMosaic",modelValue:q.value,"onUpdate:modelValue":e[6]||(e[6]=v=>q.value=v),name:"isMosaic",label:"모자이크 처리 필요"},null,8,["modelValue"]),q.value?(p(),x(se,{key:1,modelValue:z.value,"onUpdate:modelValue":e[7]||(e[7]=v=>z.value=v),placeholder:"모자이크 대상을(를) 입력해주세요"},null,8,["modelValue"])):M("",!0),a(pe,{id:"isVoiceModulation",modelValue:Y.value,"onUpdate:modelValue":e[8]||(e[8]=v=>Y.value=v),name:"isVoiceModulation",label:"음성변조 처리 필요",placeholder:"음성변조 대상을(를) 입력해주세요"},null,8,["modelValue"]),Y.value?(p(),x(se,{key:2,modelValue:k.value,"onUpdate:modelValue":e[9]||(e[9]=v=>k.value=v),placeholder:"음성변조 대상을(를) 입력해주세요"},null,8,["modelValue"])):M("",!0),a(pe,{id:"isArchive",modelValue:T.value,"onUpdate:modelValue":e[10]||(e[10]=v=>T.value=v),name:"isArchive",label:"아카이브 금지"},null,8,["modelValue"]),a(ke,{modelValue:A.value,"onUpdate:modelValue":e[11]||(e[11]=v=>A.value=v),label:"기타(또는 특이사항)",rows:5,placeholder:"기타(또는 특이사항)을(를) 입력해주세요"},null,8,["modelValue"]),g("div",tt,[a(f(oa),null,{default:y(({open:v})=>[a(f(aa),{class:"flex w-full justify-between items-center rounded-lg p-2 text-left cursor-pointer hover:bg-gray-100 hover:dark:bg-dark-selection transition duration-150 ease-in-out"},{default:y(()=>[e[20]||(e[20]=g("span",{class:"font-bold float-left pt-1 dark:text-dark-gray"},"촬영정보",-1)),a(f(et),{class:ta([v?"rotate-180 transform":"","h-5 w-5"])},null,8,["class"])]),_:2},1024),a(f(la),{class:"truncate p-2 space-y-3",placeholder:"영상버전을(를) 검색하세요"},{default:y(()=>[a(_e,{modelValue:_.value,"onUpdate:modelValue":e[12]||(e[12]=N=>_.value=N),label:"영상버전",options:L.value,"item-label":"value","track-by":"id",placeholder:"이름/아이디를 검색하세요"},null,8,["modelValue","options"]),a(xe,{modelValue:U.value,"onUpdate:modelValue":e[13]||(e[13]=N=>U.value=N),label:"취재기자","dept-id":5,placeholder:"이름/아이디를 검색하세요"},null,8,["modelValue"]),a(Ia,{modelValue:W.value,"onUpdate:modelValue":e[14]||(e[14]=N=>W.value=N),label:"userNm","item-label":"영상기자","track-by":"id",options:ee.value,placeholder:"이름/아이디를 검색하세요"},null,8,["modelValue","options"]),a(se,{modelValue:O.value,"onUpdate:modelValue":e[15]||(e[15]=N=>O.value=N),label:"촬영장소",placeholder:"촬영장소을(를) 입력해주세요"},null,8,["modelValue"]),a(Re,{modelValue:j.value,"onUpdate:modelValue":e[16]||(e[16]=N=>j.value=N),label:"촬영일",placeholder:"촬영일을(를) 입력해주세요"},null,8,["modelValue"]),a(_e,{modelValue:ae.value,"onUpdate:modelValue":e[17]||(e[17]=N=>ae.value=N),label:"촬영유형",options:de.value,"item-label":"value","track-by":"id",placeholder:"촬영유형을(를) 검색하세요"},null,8,["modelValue","options"]),a(ke,{modelValue:E.value,"onUpdate:modelValue":e[18]||(e[18]=N=>E.value=N),label:"Comments",rows:4,placeholder:"Comments을(를) 입력해주세요"},null,8,["modelValue"])]),_:1})]),_:1})])]),g("div",lt,[g("div",ot,[a($,{type:"secondary",class:"dark:bg-dark-secondary dark:text-white dark:hover:bg-gray-600",onClick:me},{default:y(()=>e[21]||(e[21]=[Q("취소")])),_:1}),a($,{"is-loading":V.value,onClick:Ie},{default:y(()=>[Q(ne(te.value),1)]),_:1},8,["is-loading"])])])]),_:1}))}}),nt={class:"flex justify-between flex-wrap gap-1.5"},rt={class:"flex items-center flex-wrap gap-1.5"},dt={class:"flex items-center flex-wrap gap-1.5"},Ht=P({__name:"CoverageScheduleView",props:{id:{default:0}},setup(R){const m=R,{fetchCoverageSchedules:n,deleteCoverageSchedule:o,copyCoverageSchedule:h,assignVideoReporter:I}=ce(),{fetchCoveragePlan:c}=Ca(),{departmentId:i,can:d}=Pe(),S=t([B().subtract(1,"day").format("YYYY-MM-DD"),B().format("YYYY-MM-DD")]),w=t(),V=t(),l=t(),b=t(),q=t(!1),Y=t(),T=t(!1),k=t(!1),z=t(),F=t(1),le=t(sa.sm),Z=t({isShow:!0,page:1,totalElements:0,totalPages:1,numberOfElements:0,size:le.value}),J=t([]),A=t(0),_=t(),L=t(),U=t(!1),W=t(!1),ee=t(!1),O=t("create"),j=t(!1),ae=t("create"),de=t(0),E=async()=>{var u,r,C;try{T.value=!0;const G={searchValue:b.value,startDate:S.value[0],endDate:S.value[1],statusCode:(u=l.value)==null?void 0:u.id,reporterId:(r=w.value)==null?void 0:r.id,videoReporterId:(C=V.value)==null?void 0:C.id},H=await n(G);H.success&&(J.value=H.data.content,Z.value={isShow:!0,page:F.value,totalPages:H.data.totalPages,totalElements:H.data.totalElements,numberOfElements:H.data.numberOfElements,size:H.data.size})}catch(G){console.error("Failed fetch getCoverageSchedules()",G)}finally{T.value=!1}},we=u=>{S.value=u,E()},te=()=>{F.value=1,A.value=0,_.value=null,E()},me=()=>{E()},be=()=>{O.value="create",U.value=!0},ye=()=>{O.value="edit",U.value=!0},ie=()=>{L.value=0,A.value=0,_.value=null},ve=async u=>{try{const r={startDateTime:u};(await h(L.value,r)).success&&(W.value=!1,window.Notify.success({message:re.coverageSchedule.copy}),ie(),await E())}catch(r){console.error("Failed copyCoverageSchedule",r)}},Se=async()=>{(await o(L.value)).success&&(window.Notify.success({message:re.coverageSchedule.delete}),ie(),await E())},Ce=(u,r)=>{u&&(r==="create"&&ie(),E()),U.value=!1},Ie=u=>{var r,C,G;A.value=(r=u[0])==null?void 0:r.rowIndex,_.value=(C=u[0])==null?void 0:C.data,L.value=(G=u[0])==null?void 0:G.data.id},s=u=>{A.value=u==null?void 0:u.rowIndex,_.value=u==null?void 0:u.data,L.value=u==null?void 0:u.data.id,O.value="edit",U.value=!0},e=u=>{F.value=u,E()},v=async u=>{let r=i;if(u.data.coveragePlanId){const C=await c(u.data.coveragePlanId);C.success&&C.data.departmentId&&(r=C.data.departmentId)}z.value=r,k.value=!0},N=()=>{ee.value=!0},We=async u=>{try{const r={videoReporterIdList:u.map(G=>G.id)};(await I(L.value,r)).success&&(window.Notify.success({message:re.coverageSchedule.assignVideoReporter}),await E(),ee.value=!1)}catch(r){console.error("Failed assigning coverage schedule",r)}},Oe=u=>{Y.value=u,q.value=!0},Ge=u=>{console.log("user",u),k.value=!1},Ye=()=>{j.value=!0},je=()=>{const u=new URLSearchParams;for(let C=0;C<_.value.videoReporterList.length;C+=1)u.append(`video_reporter[${C}]`,_.value.videoReporterList[C].userId);const r=`https://dev-cms.sbs.co.kr/v2/file-upload?meta_set_code=ingest_commission&coverage_schedule_id=${_.value.id}&title=${_.value.title}&reporter=${_.value.reporterUserId||""}&${u.toString()}`;window.open(r,"_blank")},He=u=>{de.value=u,ae.value="edit",j.value=!0};return ue(()=>m.id,()=>{m.id&&(L.value=m.id,O.value="edit",U.value=!0)},{immediate:!0}),Te(()=>{E()}),(u,r)=>{var G,H;const C=na("tooltip");return p(),X("div",null,[g("div",nt,[g("div",rt,[a(ra,{modelValue:S.value,"onUpdate:modelValue":r[0]||(r[0]=D=>S.value=D),onChange:we},null,8,["modelValue"]),a(f(xe),{modelValue:w.value,"onUpdate:modelValue":r[1]||(r[1]=D=>w.value=D),class:"w-36",name:"coverageReporter","is-all-option":!0,"label-name":"취재기자 전체",placeholder:"취재기자 전체","preselect-first":!0,onOnSelected:te},null,8,["modelValue"]),a(f(xe),{modelValue:V.value,"onUpdate:modelValue":r[2]||(r[2]=D=>V.value=D),class:"w-36",name:"videoReporter","is-all-option":!0,"label-name":"영상기자 전체",placeholder:"영상기자 전체","preselect-first":!0,onOnSelected:te},null,8,["modelValue"]),a(_e,{modelValue:l.value,"onUpdate:modelValue":r[3]||(r[3]=D=>l.value=D),name:"coverage-state","is-loading":T.value,options:f(he).allValues,"item-label":"label","track-by":"id","allow-empty":!1,"preselect-first":!0,placeholder:"상태 전체","onSelect:value":te},null,8,["modelValue","is-loading","options"]),a(se,{modelValue:b.value,"onUpdate:modelValue":r[4]||(r[4]=D=>b.value=D),placeholder:"검색어",width:"w-72",onKeyup:da(te,["enter"])},null,8,["modelValue"]),a($,{icon:"magnifying-glass",onClick:te})]),g("div",dt,[K(a($,{icon:"plus","button-text":"일정 등록",disabled:!f(d)(f(oe).COVERAGE_SCHEDULE_WRITE.code),onClick:be},null,8,["disabled"]),[[C,"일정 등록"]]),K(a($,{icon:"flag","button-text":"인제스트 의뢰",disabled:!_.value||!f(d)(f(oe).COVERAGE_SCHEDULE_WRITE.code),onClick:Ye},null,8,["disabled"]),[[C,"인제스트 의뢰"]]),K(a($,{icon:"cloud-arrow-up","button-text":"인제스트",disabled:!_.value||!f(d)(f(oe).COVERAGE_SCHEDULE_WRITE.code),onClick:je},null,8,["disabled"]),[[C,"인제스트"]]),K(a($,{icon:"arrow-path",onClick:me},null,512),[[C,"새로고침"]]),K(a($,{icon:"pencil",disabled:!_.value||!f(d)(f(oe).COVERAGE_SCHEDULE_WRITE.code),onClick:ye},null,8,["disabled"]),[[C,"취재일정 수정"]]),K(a($,{icon:"document-duplicate",disabled:!_.value||!f(d)(f(oe).COVERAGE_SCHEDULE_WRITE.code),onClick:r[5]||(r[5]=D=>W.value=!0)},null,8,["disabled"]),[[C,"취재일정 복사"]]),K(a(ia,{title:`${(G=_.value)==null?void 0:G.title}`,disabled:!_.value||!f(d)(f(oe).COVERAGE_SCHEDULE_WRITE.code),onOnConfirm:Se},null,8,["title","disabled"]),[[C,"취재일정 삭제"]])])]),a(f(ua),{class:"default-theme"},{default:y(()=>[a(f(De),{class:"flex flex-col h-full"},{default:y(()=>[a($a,{"page-info":Z.value,"row-data":J.value,"selected-row-index":A.value,onOnClickedAssignVideoReporter:N,onOnClickedAssignReporter:v,onSelectedRows:Ie,onDoubleClickedRow:s,onOnChangePage:e,onOnShowCoveragePlan:Oe},null,8,["page-info","row-data","selected-row-index"])]),_:1}),a(f(De),{size:f(qe).basic.size,"min-size":f(qe).basic.minSize},{default:y(()=>[a(Ja,{"coverage-schedule-id":L.value,"is-loading":T.value,class:"bg-white dark:bg-dark border dark:border-dark-border rounded-md",onSearchIngestRequest:He},null,8,["coverage-schedule-id","is-loading"])]),_:1},8,["size","min-size"])]),_:1}),U.value?(p(),x(va,{key:0,"coverage-schedule-id":L.value,mode:O.value,onClose:Ce},null,8,["coverage-schedule-id","mode"])):M("",!0),W.value?(p(),x(La,{key:1,title:`${(H=_.value)==null?void 0:H.title}`,onOnCopy:ve,onClose:r[6]||(r[6]=D=>W.value=!1)},null,8,["title"])):M("",!0),ee.value?(p(),x(Aa,{key:2,"header-title":"영상기자 배정",label:"영상기자 배정","table-name":"영상기자",onOnAddUser:We,onClose:r[7]||(r[7]=D=>ee.value=!1)})):M("",!0),q.value?(p(),x(fa,{key:3,mode:"readOnly","coverage-plan-id":Y.value,onClose:r[8]||(r[8]=D=>q.value=!1)},null,8,["coverage-plan-id"])):M("",!0),k.value?(p(),x(pa,{key:4,"dept-id":z.value,onOnAddUser:Ge,onClose:r[9]||(r[9]=D=>k.value=!1)},null,8,["dept-id"])):M("",!0),j.value?(p(),x(st,{key:5,"coverage-schedule-id":_.value.id,"ingest-request-id":de.value,mode:ae.value,onClose:r[10]||(r[10]=D=>j.value=!1)},null,8,["coverage-schedule-id","ingest-request-id","mode"])):M("",!0)])}}});export{Ht as default};
