import{d as R,a5 as K,k as x,t as U,a as u,c as _,Y as t,G as r,a6 as re,a0 as w,j as m,a1 as X,$ as A,K as y,bX as G,w as b,X as ce,a2 as de,aD as me,u as ue,V as pe,l as fe,o as ve,an as F,h as I,ao as ye,ah as P,ap as _e}from"./index-eLyz9_Ts.js";import{_ as ge}from"./VDCEditor.vue_vue_type_script_setup_true_lang-IhnNo6sk.js";import{_ as he}from"./ConfirmModal.vue_vue_type_script_setup_true_lang-k_ZxaDhN.js";import{_ as S}from"./ModalButton.vue_vue_type_script_setup_true_lang-WIw8hxFk.js";import{_ as Y}from"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";import{_ as xe}from"./FileDropzone.vue_vue_type_script_setup_true_lang-SVeHifZw.js";import{u as q}from"./file-Gx0JxWZZ.js";import{a as be,_ as Ce}from"./ReporterBoardComment.vue_vue_type_script_setup_true_lang-Gytzq9bJ.js";import{F as ke}from"./file-division-code-x51qUgaH.js";import{c as J,d as we}from"./time-formatter-ySAnBDjB.js";const De={class:"text-primary-gray-40 dark:text-white"},Ve={class:"flex items-center justify-start mb-4"},$e={class:"font-bold"},Te={class:"grid grid-cols-12 gap-2 mb-2.5 items-center"},Ie={class:"col-span-2 text-right"},Se={class:"grid grid-cols-12 gap-2 mb-2.5"},Ne={class:"col-span-2 flex items-center text-right justify-end"},Be={class:"col-span-9 grid grid-cols-24 gap-2 items-center"},Fe={class:"col-span-4 h-full flex items-center"},Oe={key:0,class:"col-span-11"},Ee={key:1,class:"col-span-5"},Ue={class:"grid grid-cols-12 gap-2 mb-1"},Re={class:"col-span-9 grid grid-cols-24 gap-2 items-center"},Le={class:"col-span-4 h-full flex items-center"},Me={key:0,class:"col-span-11"},je={key:1,class:"col-span-5"},He={class:"grid grid-cols-12 gap-2 mb-2.5"},Ae={class:"col-span-9 grid grid-cols-24 gap-2 items-center"},Ge={key:0,class:"col-span-20 text-black font-normal"},Pe={class:"grid grid-cols-12 gap-2"},Ye=R({__name:"ReporterBoardInformation",props:{dataInfo:{}},emits:["update:dataInfo"],setup(D,{emit:p}){const d=D,C=p,{t:f}=K(),a=x(d.dataInfo),g=(v,e)=>JSON.stringify(v)!==JSON.stringify(e);return U(()=>d.dataInfo,v=>{g(a.value,v)&&(a.value=v)},{deep:!0}),U(()=>a.value,v=>{g(d.dataInfo,v)&&C("update:dataInfo",v)},{deep:!0}),(v,e)=>(u(),_("div",De,[t("div",Ve,[r(re,{icon:"custom-chevron",size:"w-5 h-5",class:"mr-2"}),t("p",$e,w(m(f)("Community.상세정보")),1)]),t("div",Te,[e[7]||(e[7]=t("div",{class:"col-span-1"},null,-1)),t("p",Ie,w(m(f)("Community.작성자")),1),r(X,{modelValue:a.value.displayNm,"onUpdate:modelValue":e[0]||(e[0]=n=>a.value.displayNm=n),intent:"primary",class:"col-span-9",placeholder:m(f)("Community.텍스트를 입력하세요")},null,8,["modelValue","placeholder"])]),t("div",Se,[e[8]||(e[8]=t("div",{class:"col-span-1"},null,-1)),t("p",Ne,w(m(f)("Community.게시일 설정")),1),t("div",Be,[t("div",Fe,[r(A,{modelValue:a.value.startCheck,"onUpdate:modelValue":e[1]||(e[1]=n=>a.value.startCheck=n),name:"startCheck",label:m(f)("Community.시작"),"custom-class-input":"!w-4 !h-4"},null,8,["modelValue","label"])]),a.value.startCheck?(u(),_("div",Oe,[r(Y,{modelValue:a.value.pubStartDtm,"onUpdate:modelValue":e[2]||(e[2]=n=>a.value.pubStartDtm=n),class:"space-y-0",intent:"primary"},null,8,["modelValue"])])):y("",!0),a.value.startCheck?(u(),_("div",Ee,[r(G,{modelValue:a.value.startTime,"onUpdate:modelValue":e[3]||(e[3]=n=>a.value.startTime=n),intent:"primary","enable-seconds":!1,"model-type":"HH:mm:ss",format:"HH:mm","show-icon":!1},null,8,["modelValue"])])):y("",!0)])]),t("div",Ue,[e[9]||(e[9]=t("div",{class:"col-span-1"},null,-1)),e[10]||(e[10]=t("p",{class:"col-span-2"},null,-1)),t("div",Re,[t("div",Le,[r(A,{modelValue:a.value.endCheck,"onUpdate:modelValue":e[4]||(e[4]=n=>a.value.endCheck=n),name:"endCheck",label:m(f)("Community.종료"),"custom-class-input":"!w-4 !h-4"},null,8,["modelValue","label"])]),a.value.endCheck?(u(),_("div",Me,[r(Y,{modelValue:a.value.pubEndDtm,"onUpdate:modelValue":e[5]||(e[5]=n=>a.value.pubEndDtm=n),intent:"primary",class:"space-y-0"},null,8,["modelValue"])])):y("",!0),a.value.endCheck?(u(),_("div",je,[r(G,{modelValue:a.value.endTime,"onUpdate:modelValue":e[6]||(e[6]=n=>a.value.endTime=n),intent:"primary","enable-seconds":!1,"model-type":"HH:mm:ss",format:"HH:mm","show-icon":!1},null,8,["modelValue"])])):y("",!0)])]),t("div",He,[e[12]||(e[12]=t("div",{class:"col-span-1"},null,-1)),e[13]||(e[13]=t("p",{class:"col-span-2"},null,-1)),t("div",Ae,[e[11]||(e[11]=t("div",{class:"col-span-4 h-full flex items-center"},null,-1)),a.value.startCheck||a.value.endCheck?(u(),_("div",Ge,w(m(f)("Community.게시일 설정 시 해당 시간 외 게시글 비공개 전환")),1)):y("",!0)])]),t("div",Pe,[e[14]||(e[14]=t("p",{class:"col-span-3"},null,-1)),t("div",null,[r(de,{class:"!bg-dark-secondary text-white text-sm font-bold hover:!bg-primary"},{default:b(()=>[ce(w(m(f)("Community.권한설정")),1)]),_:1})])])]))}}),Je={class:"text-primary-purple-500 dark:text-white"},Ke=R({__name:"ReporterBoardAttachFile",props:{fileList:{}},emits:["update:fileList"],setup(D,{emit:p}){const d=D,C=p,{fileDownload:f}=q(),a=x(d.fileList||[]),g=e=>{f(e.file)},v=(e,n)=>{n.stopPropagation(),n.preventDefault(),a.value.splice(e,1)};return U(()=>a.value,e=>{C("update:fileList",e)}),(e,n)=>(u(),_("div",Je,[t("div",null,[r(xe,{"file-data":a.value,"onUpdate:fileData":n[0]||(n[0]=h=>a.value=h),mode:"create","is-tripped":!0,"is-center":!0,icon:"plus-circle",message:"드래그앤 드랍 또는 클릭으로 파일을 추가하세요","custom-class-icon":"mb-2 text-primary-gray-surface-500","file-list-custom-class":"text-black dark:text-white px-0","is-show-file-list-bottom":"",onOnDownloadFile:g,onOnDeleteFile:v},{description:b(()=>n[1]||(n[1]=[t("div",{class:"mb-8 mt-2 mx-2"},[t("p",null,"* 파일 하나당 최대 200MB까지 업로드할 수 있습니다."),t("p",null,"* 등록 개수는 최대 5개 입니다.")],-1)])),_:1},8,["file-data"])])]))}}),Xe={class:"dark:text-white text-xs"},qe={class:"flex justify-between flex-grow h-full overflow-y-hidden flex-wrap pt-2"},ze={class:"flex flex-col w-[70%] p-2.5 border border-primary-gray-999 rounded-md h-[85vh]"},Qe={class:"flex items-center gap-2 mb-3"},We={class:"w-[40px] text-right mr-2 font-bold text-primary-gray-40 dark:text-white"},Ze={class:"flex-grow overflow-y-auto"},et={class:"flex flex-col w-[29.5%] py-2 px-1 border border-primary-gray-999 rounded-md h-[85vh]"},tt={class:"px-11 h-[50px] border-t border-primary-gray-surface flex items-center justify-center"},st={key:0,class:"flex items-center justify-center gap-x-2 p-2 w-full"},at={key:1,class:"flex items-center justify-center gap-x-2 w-full"},O="00:00:00",E="Invalid Date",ft=R({__name:"ReporterBoardCreateAndEdit",props:{id:{}},setup(D){const p=D,{t:d}=K(),C={id:3,name:d("Community.코맨트")},f=[{id:1,name:d("Community.상세정보")},{id:2,name:d("Community.첨부파일")},C],{fileUpload:a}=q(),g=me(),{moveListCommunityReporterBoard:v}=_e(),e=ue(),n=x([]),h=x([]),c=x({titl:"",ctt:"",displayNm:"",attcFileIds:[],pubStartDtm:"",pubEndDtm:"",startTime:O,endTime:O,startCheck:!1,endCheck:!1}),L=x(null),N=x(!1),l=pe({isOpen:!1,title:"",content:"",type:"confirm",case:"confirm",icon:"exclamationCircle"}),V=fe(()=>!!p.id),z=s=>s.map(o=>({...o,name:o.fileNm,fileId:o.id})),M=s=>s===E?O:s,Q=s=>{const{date:o,time:i}=J(s.pubStartDtm),{date:k,time:B}=J(s.pubEndDtm);return{...s,displayNm:s.displayInputrName,startTime:M(i),endTime:M(B),startCheck:!!s.pubStartDtm,endCheck:!!s.pubEndDtm,attcFileIds:s.attcFiles.map(T=>T.id),pubStartDtm:o,pubEndDtm:k}},W=async s=>{try{const o=await g.community.reporterBoard.findOne(s);o.success&&(c.value=Q(o.data),h.value=z(o.data.attcFiles))}catch(o){console.log("Fail to get reporter board",o)}},Z=async()=>{var i;if(!h.value)return[];const s=(i=h==null?void 0:h.value)==null?void 0:i.map(async k=>{if(k.type){const B={fileName:k.name,fileDivisionCode:ke.Board.id,publicYn:"Y",file:k},T=await a(B);if(T.success)return T.data.id}else return k.id});return await Promise.all(s)},ee=()=>{l.title="Information",l.isOpen=!0,l.content=d("Community.제목을 입력하여 주세요"),l.type="basic",l.case="check-title",l.icon="customInfo"},te=()=>{l.title="확인",l.isOpen=!0,l.content=V.value?`${d("Community.내용이 변경되었습니다")}.
${d("Community.저장하시겠습니까?")}`:d("Community.저장하시겠습니까?"),l.type="confirm",l.case=V.value?"edit":"create",l.icon="customQuestionMark"},se=()=>{L.value.onClose()},$=()=>{l.isOpen=!1},ae=async(s,o)=>{const i=await g.community.reporterBoard.update(s,o);i!=null&&i.success?(window.Notify.success({message:P.communityReporterBoard.edit}),v(e,"Edit")):window.Notify.error({message:i.msg})},oe=async s=>{const o=await g.community.reporterBoard.create(s);o!=null&&o.success?(window.Notify.success({message:P.communityReporterBoard.create}),v(e)):window.Notify.error({message:o.msg})},ne=()=>{if(!c.value.titl){ee();return}te()},j=(s,o,i)=>s?o===E||i===E?null:we(o,i):null,le=async()=>{$();const s=await Z(),o={titl:c.value.titl,ctt:c.value.ctt,displayNm:c.value.displayNm,attcFileIds:s.length?s:[],pubStartDtm:j(c.value.startCheck,c.value.pubStartDtm,c.value.startTime),pubEndDtm:j(c.value.endCheck,c.value.pubEndDtm,c.value.endTime)};V.value&&p.id?ae(p.id,o):oe(o)},ie=s=>{c.value={...c.value,...s}},H=async()=>{N.value=!0;try{if(p.id){const s=await g.community.reporterBoard.getComments(p.id);s.success&&(n.value=s.data)}}catch(s){console.log("Fail to get comment",s)}finally{N.value=!1}};return ve(()=>{p.id&&(W(p.id),H())}),(s,o)=>(u(),_("div",Xe,[r(be,{ref_key:"headerRef",ref:L,"is-edit-and-create":!0,onOnSave:ne},null,512),t("div",qe,[t("div",ze,[t("div",Qe,[t("p",We,w(m(d)("Community.제목")),1),r(X,{modelValue:c.value.titl,"onUpdate:modelValue":o[0]||(o[0]=i=>c.value.titl=i),name:"title",class:"w-3/5",intent:"primary","custom-input-class":"rounded-none"},null,8,["modelValue"])]),t("div",Ze,[r(ge,{content:c.value.ctt,"editor-class":"h-full","onUpdate:content":o[1]||(o[1]=i=>c.value.ctt=i)},null,8,["content"])])]),t("div",et,[t("div",null,[r(ye,{"is-plain-text-mode":!0,"overflow-class":!0,tabs:V.value?f:f.filter(i=>i.id!==C.id),"is-compact-mode":!0,class:"justify-center space-y-3 rounded-xl"},{default:b(()=>[r(m(F),null,{default:b(()=>[r(Ye,{"data-info":c.value,"onUpdate:dataInfo":ie},null,8,["data-info"])]),_:1}),r(m(F),null,{default:b(()=>[r(Ke,{"file-list":h.value},null,8,["file-list"])]),_:1}),V.value?(u(),I(m(F),{key:0},{default:b(()=>{var i;return[p.id?(u(),I(Ce,{key:0,class:"overflow-auto dark:!bg-dark-secondary h-[calc(100vh-260px)]","comment-list":n.value,"comment-count":(i=c.value)==null?void 0:i.cmntCnt,"current-id":p.id,"is-loading-comments":N.value,onOnRefresh:H},null,8,["comment-list","comment-count","current-id","is-loading-comments"])):y("",!0)]}),_:1})):y("",!0)]),_:1},8,["tabs"])])])]),l.isOpen?(u(),I(he,{key:0,"use-slot":"",intent:"secondary",text:l.content,type:l.type,title:l.title,icon:l.icon,onClose:$},{bottom:b(()=>[t("div",tt,[l.type==="basic"?(u(),_("div",st,[r(S,{text:"OK",icon:"check",onClick:$})])):y("",!0),l.type==="confirm"?(u(),_("div",at,[r(S,{text:m(d)("Community.예"),icon:"check",onClick:le},null,8,["text"]),r(S,{type:"warning",text:m(d)("Community.아니요"),icon:"xMark",onClick:se},null,8,["text"]),l.case==="edit"?(u(),I(S,{key:0,type:"warning",text:m(d)("Community.취소"),icon:"xMark",onClick:$},null,8,["text"])):y("",!0)])):y("",!0)])]),_:1},8,["text","type","title","icon"])):y("",!0)]))}});export{ft as _};
