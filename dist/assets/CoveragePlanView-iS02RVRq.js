import{d as q,k as l,a as g,h as b,w as v,Y as C,G as t,X as ae,a2 as f,a3 as be,l as se,j as o,an as te,K as I,ao as he,ab as ke,ae as oe,ad as ye,t as Se,o as xe,ai as Re,c as Ee,af as Ie,L as Ve,a1 as $e,aj as P,aG as Ae,ah as E,ap as Oe}from"./index-eLyz9_Ts.js";import{g as le,M as De}from"./splitpanes.es-dEoJOrhT.js";import{G as Me}from"./GSingleSelect-7u8H0FdH.js";import"./tag-Q73uuSte.js";import"./program-omP_c4K3.js";import"./article-type.code-5cb8riL1.js";import{_ as ze}from"./UserSelect.vue_vue_type_script_setup_true_lang-Hk5THi0e.js";import"./category-zIRntbmZ.js";import"./vue-multiselect-Yz8FsF-E.js";import{_ as je}from"./DepartmentMultiSelect.vue_vue_type_script_setup_true_lang-OqmQVQH2.js";import{c as N,_ as Ne}from"./CoveragePlanList.vue_vue_type_script_setup_true_lang-vJ0F3lvx.js";import{u as Te}from"./coverage-plan-nI7mLZOB.js";import{_ as Ge,a as Be,b as Le}from"./UserSingleAddModal.vue_vue_type_script_setup_true_lang-Ts9ZqV7l.js";import{G as Ye}from"./GTextarea-5GIFD2Mo.js";import{_ as Ue}from"./ConfirmButton.vue_vue_type_script_setup_true_lang-onM9evN8.js";import{_ as We}from"./CoveragePlanSearch.vue_vue_type_script_setup_true_lang-kZic9Ocd.js";import{_ as Ke}from"./TotalWorkflow.vue_vue_type_script_setup_true_lang-RSVNUNvR.js";import"./company-enum-MfEiIQ-N.js";import{P as K}from"./panel-size-enum-06wl-l7a.js";import{A as y}from"./app-authority-code-Q9MU7mjP.js";import"./use-model-wrapper-XtiLc3Xd.js";import"./department-wnuBQoCo.js";import"./use-date-GeeGTbYh.js";import"./use-render-component-K20sHqiA.js";import"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";import"./async-validator.util-IJrtpoc1.js";import"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";import"./GDateTimePicker-bSYwb_xW.js";/* empty css                                                                        */import"./ArticleTypeSelect.vue_vue_type_script_setup_true_lang-Kp5wzGNr.js";import"./UserAddSelect.vue_vue_type_script_setup_true_lang-1UBsZdY3.js";/* empty css                                                                  */import"./PageLoader.vue_vue_type_script_setup_true_lang-ZvbvX14z.js";const qe={class:"flex flex-col space-x-2 h-full"},He={class:"sm:flex sm:flex-row-reverse pt-4 pb-2"},Je={class:"space-x-3 flex items-center"},Xe=q({__name:"CoveragePlanRejectModal",emits:["close","on-reject"],setup(V,{emit:w}){const r=w,_=l(""),h=()=>{r("close")},S=()=>{r("on-reject",_.value)};return(d,s)=>(g(),b(be,{"modal-class":"w-1/3","content-class":"h-[23vh]",onClose:h},{title:v(()=>s[1]||(s[1]=[C("div",null,"반려사유",-1)])),content:v(()=>[C("div",qe,[t(Ye,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=$=>_.value=$),label:"반려사유",rows:4},null,8,["modelValue"]),C("div",He,[C("div",Je,[t(f,{type:"secondary",class:"dark:bg-dark-secondary dark:text-white dark:hover:bg-gray-600",onClick:h},{default:v(()=>s[2]||(s[2]=[ae("취소")])),_:1}),t(f,{onClick:S},{default:v(()=>s[3]||(s[3]=[ae(" 확인 ")])),_:1})])])])]),_:1}))}}),Fe={class:"flex flex-col h-full"},Qe=q({__name:"CoveragePlanTabPanel",props:{isShowMetaData:{type:Boolean,default:!0},coveragePlanId:{default:0},isLoading:{type:Boolean,default:!1},isShowWorkflow:{type:Boolean,default:!0}},emits:["on-change-state","on-clicked-reject-button"],setup(V,{emit:w}){const r=V,_=w,h=se(()=>[{id:1,name:"메타데이터",isShow:r.isShowMetaData},{id:2,name:"통합이력",isShow:r.isShowWorkflow}].filter(d=>d.isShow)),S=d=>{_("on-change-state",d)};return(d,s)=>(g(),b(he,{tabs:h.value},{default:v(()=>[t(o(te),{class:"flex flex-col h-full"},{default:v(()=>[t(We,{"coverage-plan-id":d.coveragePlanId,"is-loading":d.isLoading,class:"p-1 flex flex-col h-full overflow-auto",onOnChangeState:S,onOnClickedRejectButton:s[0]||(s[0]=$=>d.$emit("on-clicked-reject-button"))},null,8,["coverage-plan-id","is-loading"])]),_:1}),d.isShowWorkflow?(g(),b(o(te),{key:0,class:"flex flex-col h-full"},{default:v(()=>[C("div",Fe,[t(Ke,{id:d.coveragePlanId,type:"coveragePlan"},null,8,["id"])])]),_:1})):I("",!0)]),_:1},8,["tabs"]))}}),Ze={class:"flex justify-between flex-wrap gap-1.5"},ea={class:"flex items-center flex-wrap gap-1.5"},aa={class:"flex items-center flex-wrap gap-1.5"},Ma=q({__name:"CoveragePlanView",props:{id:{default:0}},setup(V){const w=V,{can:r}=ke(),{fetchCoveragePlans:_,deleteCoveragePlan:h,confirmCoveragePlan:S,copyCoveragePlan:d,assignCoveragePlan:s}=Te(),{moveNewMyArticle:$}=Oe(),x=l([oe().subtract(1,"day").format("YYYY-MM-DD"),oe().format("YYYY-MM-DD")]),T=l(),G=l(""),R=l("create"),A=l(1),H=l(ye.sm),J=l({isShow:!0,page:1,totalElements:0,totalPages:1,numberOfElements:0,size:H.value}),X=l([]),k=l(!1),B=l(!1),O=l([]),L=l(),D=l(!1),Y=l(!1),n=l(),U=l(0),p=l(0),M=l(!1),F=l(),m=async()=>{var e,a;try{Y.value=!0;const i={searchValue:G.value,startDate:x.value[0],endDate:x.value[1],reporterId:(e=T.value)==null?void 0:e.id,statusCode:(a=L.value)==null?void 0:a.id,departmentIds:O.value.map(j=>j.departmentId),page:A.value-1,size:H.value},c=await _(i);c.success&&(X.value=c.data.content,J.value={isShow:!0,page:A.value,totalPages:c.data.totalPages,totalElements:c.data.totalElements,numberOfElements:c.data.numberOfElements,size:c.data.size})}finally{Y.value=!1}},ne=e=>{O.value=e,m()},W=()=>{p.value=0,U.value=0,n.value=null},ie=e=>{var a,i,c;U.value=(a=e[0])==null?void 0:a.rowIndex,n.value=(i=e[0])==null?void 0:i.data,p.value=(c=e[0])==null?void 0:c.data.coveragePlanId},re=e=>{n.value=e.data,p.value=e.data.coveragePlanId,R.value="edit",k.value=!0},de=e=>{x.value=e,m()},z=()=>{A.value=1,W(),m()},ce=()=>{R.value="create",k.value=!0},ue=()=>{B.value=!0},me=()=>{m()},ve=()=>{R.value="edit",k.value=!0},pe=async()=>{(await h(n.value.coveragePlanId)).success&&(window.Notify.success({message:E.coveragePlan.delete}),W(),await m())},fe=()=>{const e={coveragePlanId:n.value.coveragePlanId};$(e)},Q=(e,a)=>{e&&(a==="create"&&W(),m()),k.value=!1,B.value=!1},Z=async e=>{(await S(n.value.coveragePlanId,e)).success&&(window.Notify.success({message:e.statusCode===N.APPROVE.id?E.coveragePlan.approve:E.coveragePlan.reject}),await m(),D.value=!1)},ge=e=>{const a={statusCode:N.REJECT.id,rejectionReason:e};Z(a)},Ce=e=>{A.value=e,m()},we=async()=>{(await d(p.value)).success&&(window.Notify.success({message:E.coveragePlan.copy}),await m())},_e=e=>{F.value=e.data.departmentId,M.value=!0},Pe=async e=>{try{const a={departmentId:e==null?void 0:e.deptId,reporterId:e==null?void 0:e.id};(await s(p.value,a)).success&&(window.Notify.success({message:E.coveragePlan.assignReporter}),await m()),M.value=!1}catch(a){console.error(a)}},ee=se(()=>{var e;return!n.value||((e=n.value)==null?void 0:e.statusCode)!==N.APPROVE.id});return Se(()=>w.id,()=>{w.id&&(p.value=w.id,R.value="edit",k.value=!0)},{immediate:!0}),xe(async()=>{await m()}),(e,a)=>{var c,j;const i=Re("tooltip");return g(),Ee("div",null,[C("div",Ze,[C("div",ea,[t(Ie,{modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=u=>x.value=u),onChange:de},null,8,["modelValue"]),t(o(ze),{modelValue:T.value,"onUpdate:modelValue":a[1]||(a[1]=u=>T.value=u),class:"w-36","is-all-option":!0,"label-name":"취재기자 전체","preselect-first":!0,onOnSelected:z},null,8,["modelValue"]),t(je,{"selected-departments":O.value,"onUpdate:selectedDepartments":a[2]||(a[2]=u=>O.value=u),onOnSelectedDepartment:ne},null,8,["selected-departments"]),t(Me,{modelValue:L.value,"onUpdate:modelValue":a[3]||(a[3]=u=>L.value=u),name:"state",class:"w-32",options:o(N).allValues,"item-label":"label","track-by":"id","preselect-first":!0,searchable:!1,placeholder:"상태 전체","onSelect:value":z},null,8,["modelValue","options"]),t($e,{modelValue:G.value,"onUpdate:modelValue":a[4]||(a[4]=u=>G.value=u),placeholder:"제목/내용 검색",width:"w-72",onKeyup:Ve(z,["enter"])},null,8,["modelValue"]),t(f,{icon:"magnifying-glass",onClick:z})]),C("div",aa,[P(t(f,{icon:"plus","button-text":"계획 등록",disabled:!o(r)(o(y).COVERAGE_PLAN_WRITE.code),onClick:ce},null,8,["disabled"]),[[i,"계획 등록"]]),P(t(f,{icon:"plus","button-text":"일정 등록",disabled:ee.value||!o(r)(o(y).COVERAGE_SCHEDULE_WRITE.code),onClick:ue},null,8,["disabled"]),[[i,"일정 등록"]]),P(t(f,{icon:"pen","button-text":"기사화",disabled:ee.value||!o(r)(o(y).MY_ARTICLE_WRITE.code),onClick:fe},null,8,["disabled"]),[[i,"기사화"]]),P(t(f,{icon:"arrow-path",onClick:me},null,512),[[i,"새로고침"]]),P(t(f,{icon:"pencil",disabled:!n.value||!o(r)(o(y).COVERAGE_PLAN_WRITE.code),onClick:ve},null,8,["disabled"]),[[i,"취재계획 수정"]]),P(t(Ue,{icon:"document-duplicate",title:`${(c=n.value)==null?void 0:c.title}`,html:"(을)를 복사하시겠습니까?",disabled:!n.value||!o(r)(o(y).COVERAGE_PLAN_WRITE.code),onOnConfirm:we},null,8,["title","disabled"]),[[i,"취재계획 복사"]]),P(t(Ae,{title:`${(j=n.value)==null?void 0:j.title}`,disabled:!n.value||!o(r)(o(y).COVERAGE_PLAN_WRITE.code),onOnConfirm:pe},null,8,["title","disabled"]),[[i,"취재계획 삭제"]])])]),t(o(De),{class:"default-theme"},{default:v(()=>[t(o(le),{size:"70",class:"flex flex-col h-full"},{default:v(()=>[t(Ne,{"page-info":J.value,"row-data":X.value,"selected-row-index":U.value,onSelectedRows:ie,onDoubleClickedRow:re,onOnChangePage:Ce,onOnClickedAssignReporter:_e},null,8,["page-info","row-data","selected-row-index"])]),_:1}),t(o(le),{size:o(K).basic.size,"max-size":o(K).basic.maxSize,"min-size":o(K).basic.minSize},{default:v(()=>[t(Qe,{"coverage-plan-id":p.value,"is-loading":Y.value,class:"bg-white dark:bg-dark border dark:border-dark-border rounded-md",onOnChangeState:Z,onOnClickedRejectButton:a[5]||(a[5]=u=>D.value=!0)},null,8,["coverage-plan-id","is-loading"])]),_:1},8,["size","max-size","min-size"])]),_:1}),k.value?(g(),b(Ge,{key:0,mode:R.value,"coverage-plan-id":p.value,onClose:Q},null,8,["mode","coverage-plan-id"])):I("",!0),B.value?(g(),b(Be,{key:1,"coverage-plan-id":p.value,onClose:Q},null,8,["coverage-plan-id"])):I("",!0),D.value?(g(),b(Xe,{key:2,onClose:a[6]||(a[6]=u=>D.value=!1),onOnReject:ge})):I("",!0),M.value?(g(),b(Le,{key:3,"dept-id":F.value,"disabled-dept":"",onOnAddUser:Pe,onClose:a[7]||(a[7]=u=>M.value=!1)},null,8,["dept-id"])):I("",!0)])}}});export{Ma as default};
