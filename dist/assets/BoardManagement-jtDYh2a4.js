import{d as A,k as y,c6 as me,a as U,c as Q,Y as o,F as pe,C as be,h as S,aM as fe,al as ve,am as ge,ew as ye,V as le,W as oe,a5 as X,o as J,w as F,j as a,a0 as V,a1 as B,G as l,X as E,a2 as T,a6 as q,Q as se,a3 as te,aD as de,L as xe,aG as we,K as ae}from"./index-eLyz9_Ts.js";import{r as Me}from"./use-render-component-K20sHqiA.js";import{d as re}from"./vuedraggable.umd--AjKxttX.js";import{f as ie}from"./async-validator.util-IJrtpoc1.js";import{_ as ne}from"./GTagSelect.vue_vue_type_script_setup_true_lang-WNNVbcKh.js";import{G as H}from"./GSingleSelect-7u8H0FdH.js";import{G as ue}from"./GRadioGroup-cHw1G1ew.js";import{u as ce}from"./group-jQnorhMh.js";import"./vue.runtime.esm-bundler-3P3R-Xon.js";import"./vue-multiselect-Yz8FsF-E.js";import"./use-model-wrapper-XtiLc3Xd.js";/* empty css                                                                    */const he={class:"flex flex-col w-full"},_e={class:"flex flex-wrap p-1 gap-1 items-center"},ke=A({__name:"BoardTag",props:{params:{default:void 0}},setup(I){const C=I,c=y();return me(()=>{C.params.data.userGrps.length&&(c.value=C.params.data.userGrps.map(x=>x))}),(x,h)=>(U(),Q("div",he,[o("div",_e,[(U(!0),Q(pe,null,be(c.value,f=>(U(),S(fe,{key:f.groupId,text:f==null?void 0:f.groupName,color:"primary"},null,8,["text"]))),128))])]))}}),Ve=A({__name:"BoardList",props:{boardList:{}},emits:["selected-row","double-clicked-row","on-draggable","on-update"],setup(I,{emit:C}){const c=C,x=t=>{const p=document.createElement("div");p.className="h-full";const N={"onUpdate:modelValue":v=>{c("on-update",{bbId:t.data.bbId,useYn:v})},modelValue:t.data.useYn===!0};return Me(ye,N,p)},h=[{headerName:"",field:"drag",sortable:!1,maxWidth:40,rowDrag:!0},{headerName:"순번",field:"no",maxWidth:60,valueGetter:"node.rowIndex",cellRenderer:t=>ge(t)},{headerName:"게시판명",field:"bbNm",sortable:!1},{headerName:"설명",field:"bbExpl",sortable:!1},{headerName:"접근권한",field:"userGrps",autoHeight:!0,cellRenderer:ke},{headerName:"등록자",field:"inputrNm"},{headerName:"등록일시",field:"inputDtm",minWidth:140},{headerName:"수정자",field:"updtrNm"},{headerName:"수정일시",field:"updtDtm",minWidth:140},{headerName:"비고",field:"rmk",sortable:!1},{headerName:"사용여부",field:"useYn",filter:!1,maxWidth:100,cellRenderer:t=>x(t)}],f=t=>{c("selected-row",t[0].data)},_=t=>{c("double-clicked-row",t.data)},w=t=>{c("on-draggable",t)},u=t=>{c("on-update",t)};return(t,p)=>(U(),S(ve,{"row-data":t.boardList,"column-defs":h,"row-drag-managed":!0,onOnUpdate:u,onOnRowDragEnd:w,onSelectedRows:f,onDoubleClickedRow:_},null,8,["row-data"]))}}),Te={class:""},Ce={class:"flex justify-center space-x-2 h-full"},Ne={class:"space-y-8 w-full dark:bg-none p-1.5 dark:border-none border-gray-300 dark:border-dark-border rounded-md"},Fe={class:"space-y-4"},Le={class:"flex justify-between items-center mb-2 text-sm dark:text-white"},Be={class:"flex items-center"},$e={class:"text-error text-xs pl-2"},Ue={class:"min-h-56 max-h-64 overflow-y-auto overflow-x-hidden"},Ye={class:"flex gap-2 justify-between items-center"},Ee={class:"flex gap-2 justify-between items-center"},De={class:"space-x-3 flex items-center justify-end"},Ge=A({__name:"BoardCreateModal",emits:["close","on-create"],setup(I,{emit:C}){const c=y(),x=y(),h=y(!1),f=y([]),_=y([]),w=ce(),{fetchGroups:u}=w,t=y({fieldName:"제목",fieldType:"single"}),p=le({name:"",useFile:!0,boardMemoFieldTemplateList:[{fieldName:"",fieldType:"editor",useYn:"Y",fieldOrder:0,disabled:!0}]}),N=[{label:"텍스트 박스",type:"single"},{label:"웹 에디터",type:"editor"},{label:"멀티라인 ",type:"multi"}],{pass:v,errorFields:Y}=oe(p,ie),{t:g}=X(),R=C,O=()=>{R("close")},z=L=>{p.boardMemoFieldTemplateList.splice(L,1)},m=()=>{if(p.boardMemoFieldTemplateList.length>8){window.Notify.error({message:"구성요소는 최대 10개 입니다."});return}p.boardMemoFieldTemplateList.push({fieldName:"",fieldType:"",label:"",useYn:"Y",fieldOrder:p.boardMemoFieldTemplateList.length+1})},r=async()=>{const L=p.boardMemoFieldTemplateList.map(k=>{var D;return typeof k.fieldType=="object"&&((D=k.fieldType)!=null&&D.type)?{...k,fieldType:k.fieldType.type}:k}),s={bbNm:p.name,bbExpl:c.value,rmk:x.value,userGrpIds:f.value.map(k=>k.groupId),boardMemoFieldTemplateList:L};R("on-create",s),O()},M=async()=>{h.value=!1;const L={isUse:!0,size:1e4};try{const s=await u(L);s.success&&(_.value=s.data.content.map(k=>({...k,isChecked:!1})))}catch(s){console.log("Fail to get group list",s)}finally{h.value=!1}},$=()=>{p.boardMemoFieldTemplateList=p.boardMemoFieldTemplateList.map((L,s)=>({...L,fieldOrder:s}))};return J(()=>M()),(L,s)=>(U(),S(te,{"modal-class":"sm:w-2/5","is-change":!1,"dialog-overlay":!1,onClose:O},{title:F(()=>[o("span",Te,V(a(g)("Modal.Board.CreateModal.게시판_추가")),1)]),content:F(()=>{var k,D,W,i,e,b;return[o("div",Ce,[o("div",Ne,[o("div",Fe,[l(B,{modelValue:p.name,"onUpdate:modelValue":s[0]||(s[0]=d=>p.name=d),name:"boardName",required:!0,"error-placeholder":!0,"error-msg":(D=(k=a(Y))==null?void 0:k.name)!=null&&D.length?(W=a(Y))==null?void 0:W.name[0].message:"",label:a(g)("Modal.Board.CreateModal.게시판_명")},null,8,["modelValue","error-msg","label"]),l(B,{modelValue:c.value,"onUpdate:modelValue":s[1]||(s[1]=d=>c.value=d),name:"boardExpl",label:a(g)("Modal.Board.CreateModal.설명")},null,8,["modelValue","label"]),l(B,{modelValue:x.value,"onUpdate:modelValue":s[2]||(s[2]=d=>x.value=d),name:"boardRemark",label:a(g)("Modal.Board.CreateModal.비고")},null,8,["modelValue","label"]),l(ue,{modelValue:p.useFile,"onUpdate:modelValue":s[3]||(s[3]=d=>p.useFile=d),label:a(g)("Modal.Board.CreateModal.파일_첨부_기능"),"track-by":"label",options:[{label:"사용",value:!0}]},null,8,["modelValue","label"]),l(ne,{modelValue:f.value,"onUpdate:modelValue":s[4]||(s[4]=d=>f.value=d),options:_.value,"track-by":"groupId",label:"groupName","deselect-label":a(g)("UserGroupEdit.취소"),placeholder:a(g)("Modal.Board.EditModal.그룹을_선택해주세요"),"item-label":a(g)("Modal.Board.EditModal.그룹"),"is-loading":h.value},null,8,["modelValue","options","deselect-label","placeholder","item-label","is-loading"]),s[11]||(s[11]=o("p",{class:"border-t border-gray-300 dark:border-slate-600 dark:text-white"},null,-1)),o("div",null,[o("div",Le,[o("div",Be,[E(V(a(g)("Modal.Board.CreateModal.게시판_구성"))+" ",1),o("div",$e,V((e=(i=a(Y))==null?void 0:i.boardMemoFieldTemplateList)!=null&&e.length?(b=a(Y))==null?void 0:b.boardMemoFieldTemplateList[0].message:""),1)]),l(T,{class:"w-20",icon:"plus",onClick:s[5]||(s[5]=d=>m())},{default:F(()=>[E(V(a(g)("Modal.Board.CreateModal.추가")),1)]),_:1})]),o("div",Ue,[o("div",Ye,[l(q,{class:"cursor-grab",size:"w-4 h-4 invisible",icon:"ellipsis-vertical"}),s[9]||(s[9]=o("div",{class:"text-xs mx-1 dark:text-white"},"제목 / 타입",-1)),l(B,{modelValue:t.value.fieldName,"onUpdate:modelValue":s[6]||(s[6]=d=>t.value.fieldName=d),class:"min-w-24 flex-1",disabled:""},null,8,["modelValue"]),l(H,{modelValue:t.value.fieldType,"onUpdate:modelValue":s[7]||(s[7]=d=>t.value.fieldType=d),"track-by":"type","item-label":"label",class:"min-w-24 flex-1",options:N,disabled:""},null,8,["modelValue"]),l(T,{icon:"trash",class:"invisible"})]),l(a(re),{tag:"div",list:p.boardMemoFieldTemplateList,class:"mt-2 flex gap-2 flex-col",handle:".handle","item-key":"index",onChange:$},{item:F(({element:d,index:j})=>[o("div",Ee,[l(q,{class:"cursor-grab dark:text-white handle",size:"w-4 h-4",icon:"ellipsis-vertical"}),s[10]||(s[10]=o("div",{class:"text-xs mx-1 dark:text-white"},"제목 / 타입",-1)),l(B,{modelValue:d.fieldName,"onUpdate:modelValue":G=>d.fieldName=G,class:"min-w-24 flex-1",disabled:d.readonly},null,8,["modelValue","onUpdate:modelValue","disabled"]),l(H,{modelValue:d.fieldType,"onUpdate:modelValue":G=>d.fieldType=G,"track-by":"type","item-label":"label",class:"min-w-24 flex-1",options:N,placeholder:a(g)("Modal.Board.CreateModal.타입을_선택해주세요"),disabled:d.disabled},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled"]),l(T,{icon:"trash",class:se({invisible:d.disabled}),onClick:G=>z(j)},null,8,["class","onClick"])])]),_:1},8,["list"])])])]),o("div",De,[l(T,{type:"secondary",onClick:s[8]||(s[8]=d=>L.$emit("close"))},{default:F(()=>[E(V(a(g)("Modal.Board.CreateModal.취소")),1)]),_:1}),l(T,{disabled:!a(v),onClick:r},{default:F(()=>[E(V(a(g)("Modal.Board.CreateModal.추가")),1)]),_:1},8,["disabled"])])])])]}),_:1}))}}),Ie={class:""},Re={class:"flex justify-center space-x-2 h-full"},Oe={class:"space-y-8 w-full dark:bg-none p-1.5 dark:border-none border-gray-300 dark:border-dark-border rounded-md"},je={class:"space-y-4"},Se={class:"flex justify-between items-center mb-2 text-sm dark:text-white"},ze={class:"flex items-center"},Ae={class:"text-error text-xs pl-2"},We={class:"min-h-56 max-h-64 overflow-y-auto overflow-x-hidden"},Ke={class:"flex gap-2 justify-between items-center"},qe={class:"flex gap-2 justify-between items-center"},He={class:"flex items-center justify-end"},Qe={class:"space-x-3 flex items-center justify-end"},Xe=A({__name:"BoardEditModal",props:{id:{}},emits:["close","on-update"],setup(I,{emit:C}){const c=y(),x=y(),h=y(!1),f=y([]),_=y([]),w=y({fieldName:"제목",fieldType:"single"}),u=le({name:"",useFile:!0,boardMemoFieldTemplateList:[{fieldName:"",fieldType:"editor",label:"웹 에디터",disabled:!0}]}),t=[{label:"텍스트 박스",type:"single"},{label:"웹 에디터",type:"editor"},{label:"멀티라인 ",type:"multi"}],{pass:p,errorFields:N}=oe(u,ie),{t:v}=X(),Y=I,g=C,R=()=>{g("close")},O=de(),z=ce(),{fetchGroups:m}=z,r=i=>{const e=u.boardMemoFieldTemplateList[i].useYn==="Y";u.boardMemoFieldTemplateList[i].useYn=e?"N":"Y"},M=()=>{if(u.boardMemoFieldTemplateList.length>8){window.Notify.error({message:"구성요소는 최대 10개 입니다."});return}u.boardMemoFieldTemplateList.push({fieldName:"",fieldType:"",label:"",useYn:"Y",fieldOrder:u.boardMemoFieldTemplateList.length+1})},$=i=>{u.boardMemoFieldTemplateList.splice(i,1)},L=i=>{const e=i;e.sort((d,j)=>d.fieldOrder-j.fieldOrder);const b=e.findIndex(d=>d.fieldType==="editor"&&d.useYn==="Y");return b>-1&&(e[b].disabled=!0),i},s=async()=>{try{const i=await O.board.basic.findDetailBoard(Y.id,!1);i.success&&(u.name=i.data.bbNm,c.value=i.data.bbExpl,x.value=i.data.rmk,f.value=i.data.userGrps,u.boardMemoFieldTemplateList=L(i.data.boardMemoFieldTemplateList))}catch(i){console.log("Fail to get detail board",i)}},k=async()=>{const i=u.boardMemoFieldTemplateList.map(b=>{var d;return typeof b.fieldType=="object"&&((d=b.fieldType)!=null&&d.type)?{...b,fieldType:b.fieldType.type}:b}),e={bbNm:u.name,bbExpl:c.value,rmk:x.value,userGrpIds:f.value.map(b=>b.groupId),boardMemoFieldTemplateList:i};try{g("on-update",e),g("close")}catch(b){console.log("Fail to update board",b)}},D=async()=>{h.value=!1;const i={isUse:!0,size:1e4};try{const e=await m(i);e.success&&(_.value=e.data.content.map(b=>({...b,isChecked:!1})))}catch(e){console.log("Fail to get group list",e)}finally{h.value=!1}},W=()=>{u.boardMemoFieldTemplateList=u.boardMemoFieldTemplateList.map((i,e)=>({...i,fieldOrder:e}))};return J(async()=>{await s(),await D()}),(i,e)=>(U(),S(te,{"modal-class":"sm:w-2/5","is-change":!1,"dialog-overlay":!1,onClose:R},{title:F(()=>[o("span",Ie,V(a(v)("Modal.Board.EditModal.게시판_수정")),1)]),content:F(()=>{var b,d,j,G,P,Z;return[o("div",Re,[o("div",Oe,[o("div",je,[l(B,{modelValue:u.name,"onUpdate:modelValue":e[0]||(e[0]=n=>u.name=n),name:"boardName","error-placeholder":!0,"error-msg":(d=(b=a(N))==null?void 0:b.name)!=null&&d.length?(j=a(N))==null?void 0:j.name[0].message:"",label:a(v)("Modal.Board.EditModal.게시판_명")},null,8,["modelValue","error-msg","label"]),l(B,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=n=>c.value=n),name:"boardExpl",label:a(v)("Modal.Board.EditModal.설명")},null,8,["modelValue","label"]),l(B,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=n=>x.value=n),name:"boardRemark",label:a(v)("Modal.Board.EditModal.비고")},null,8,["modelValue","label"]),l(ue,{modelValue:u.useFile,"onUpdate:modelValue":e[3]||(e[3]=n=>u.useFile=n),label:a(v)("Modal.Board.CreateModal.파일_첨부_기능"),"track-by":"label",options:[{label:"사용",value:!0}]},null,8,["modelValue","label"]),l(ne,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=n=>f.value=n),options:_.value,"track-by":"groupId",label:"groupName",placeholder:a(v)("Modal.Board.EditModal.그룹을_선택해주세요"),"deselect-label":a(v)("UserGroupEdit.취소"),"item-label":a(v)("Modal.Board.EditModal.그룹"),"is-loading":h.value},null,8,["modelValue","options","placeholder","deselect-label","item-label","is-loading"]),e[11]||(e[11]=o("p",{class:"border-t border-gray-300 dark:border-slate-600 dark:text-white"},null,-1)),o("div",null,[o("div",Se,[o("div",ze,[E(V(a(v)("Modal.Board.CreateModal.게시판_구성"))+" ",1),o("div",Ae,V((P=(G=a(N))==null?void 0:G.boardMemoFieldTemplateList)!=null&&P.length?(Z=a(N))==null?void 0:Z.boardMemoFieldTemplateList[0].message:""),1)]),l(T,{class:"w-20",icon:"plus",onClick:e[5]||(e[5]=n=>M())},{default:F(()=>[E(V(a(v)("Modal.Board.CreateModal.추가")),1)]),_:1})]),o("div",We,[o("div",Ke,[l(q,{class:"cursor-grab",size:"w-4 h-4 invisible",icon:"ellipsis-vertical"}),e[9]||(e[9]=o("div",{class:"text-xs mx-1 dark:text-white"},"제목 / 타입",-1)),l(B,{modelValue:w.value.fieldName,"onUpdate:modelValue":e[6]||(e[6]=n=>w.value.fieldName=n),class:"min-w-24 flex-1",disabled:""},null,8,["modelValue"]),l(H,{modelValue:w.value.fieldType,"onUpdate:modelValue":e[7]||(e[7]=n=>w.value.fieldType=n),"track-by":"type","item-label":"label",class:"min-w-24 flex-1",options:t,disabled:""},null,8,["modelValue"]),l(T,{icon:"trash",class:"invisible"})]),l(a(re),{tag:"div",list:u.boardMemoFieldTemplateList,class:"mt-2 flex gap-2 flex-col",handle:".handle","item-key":"index",onChange:W},{item:F(({element:n,index:ee})=>[o("div",qe,[l(q,{class:"cursor-grab dark:text-white handle",size:"w-4 h-4",icon:"ellipsis-vertical"}),e[10]||(e[10]=o("div",{class:"text-xs mx-1 dark:text-white"},"제목 / 타입",-1)),l(B,{modelValue:n.fieldName,"onUpdate:modelValue":K=>n.fieldName=K,class:"min-w-24 flex-1",disabled:n.useYn==="N"},null,8,["modelValue","onUpdate:modelValue","disabled"]),l(H,{modelValue:n.fieldType,"onUpdate:modelValue":K=>n.fieldType=K,"track-by":"type","item-label":"label",class:"min-w-24 flex-1",options:t,placeholder:a(v)("Modal.Board.CreateModal.타입을_선택해주세요"),disabled:n.disabled||n.useYn==="N"},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled"]),l(T,{icon:n.id?n.useYn==="Y"?"eye":"eye-slash":"trash",class:se({invisible:n.disabled}),onClick:K=>n.id?r(ee):$(ee)},null,8,["icon","class","onClick"])])]),_:1},8,["list"])])])]),o("div",He,[o("div",Qe,[l(T,{type:"secondary",onClick:e[8]||(e[8]=n=>i.$emit("close"))},{default:F(()=>[E(V(a(v)("Modal.Board.EditModal.취소")),1)]),_:1}),l(T,{disabled:!a(p),onClick:k},{default:F(()=>[E(V(a(v)("Modal.Board.EditModal.수정")),1)]),_:1},8,["disabled"])])])])])]}),_:1}))}}),Je={class:"h-full"},Pe={class:"flex justify-between"},Ze={class:"flex space-x-2 items-center"},ea={class:"space-x-2 w-[210px]"},aa={class:"text-xl dark:text-dark-gray-200"},la={class:"text-xl text-gray-500"},oa={class:"flex items-center space-x-1.5"},va=A({__name:"BoardManagement",setup(I){const{t:C}=X(),c=de(),x=y(),h=y([]),f=y(!1),_=y(!1),w=y(),u=y(),t=async()=>{const m={adminYn:!0,bbNm:x.value};try{const r=await c.board.basic.findAll(m);r.success&&(h.value=r.data.map(M=>({...M,useYn:M.useYn==="Y"})))}catch(r){console.error("Fail to get board list",r)}},p=async()=>{x.value="",await t()},N=async()=>{try{(await c.board.basic.deleteBoard(w.value)).success&&(window.Notify.success({message:"[게시판 삭제] 완료되었습니다."}),_.value&&(_.value=!1),await t())}catch(m){console.log("Fail to delete board",m)}},v=async m=>{const r={bbOrd:m.node.rowIndex};try{(await c.board.basic.updateBoardOrder(w.value,r)).success&&(window.Notify.success({message:"[게시판 수정] 완료되었습니다."}),await t())}catch(M){console.log("Fail to update board order",M)}},Y=async m=>{try{const r=await c.board.basic.createBoard(m);console.log(r),r.success&&(window.Notify.success({message:"[게시판 생성] 완료되었습니다."}),await t())}catch(r){console.log("Fail to create board",r)}},g=async m=>{try{(await c.board.basic.updateBoard(w.value,m)).success&&(window.Notify.success({message:"[게시판 수정] 완료되었습니다."}),await t())}catch(r){console.log("Fail to update board",r)}},R=async m=>{const r={useYn:m.useYn?"Y":"N"};try{(await c.board.basic.updateBoard(m.bbId,r)).success&&(window.Notify.success({message:"[게시판 수정] 완료되었습니다."}),await t())}catch(M){console.log("Fail to update board",M)}},O=m=>{u.value=m,w.value=m.bbId},z=m=>{_.value=!0,w.value=m.bbId};return J(async()=>{await t()}),(m,r)=>{var M;return U(),Q("div",Je,[o("div",Pe,[o("div",Ze,[o("div",ea,[o("span",aa,V(a(C)("BoardManagement.게시판")),1),o("span",la,V(a(C)("BoardManagement.게시판수",{board:h.value.length})),1)]),l(B,{modelValue:x.value,"onUpdate:modelValue":r[0]||(r[0]=$=>x.value=$),width:"w-96",placeholder:a(C)("BoardManagement.게시판명으로_검색하세요"),onKeydown:xe(t,["enter"])},null,8,["modelValue","placeholder"]),l(T,{icon:"magnifying-glass",onClick:t})]),o("div",oa,[l(T,{icon:"arrow-path",onClick:p}),l(T,{icon:"plus",onClick:r[1]||(r[1]=$=>f.value=!0)}),l(T,{icon:"pencil",disabled:!w.value,onClick:r[2]||(r[2]=$=>_.value=!0)},null,8,["disabled"]),l(we,{icon:"trash",title:(M=u.value)==null?void 0:M.bbNm,disabled:!w.value,onOnConfirm:N},null,8,["title","disabled"])])]),l(Ve,{"board-list":h.value,onSelectedRow:O,onDoubleClickedRow:z,onOnDraggable:v,onOnUpdate:R},null,8,["board-list"]),f.value?(U(),S(Ge,{key:0,onOnCreate:Y,onClose:r[3]||(r[3]=$=>f.value=!1)})):ae("",!0),_.value?(U(),S(Xe,{key:1,id:w.value,onOnUpdate:g,onOnDelete:N,onClose:r[4]||(r[4]=$=>_.value=!1)},null,8,["id"])):ae("",!0)])}}});export{va as default};
