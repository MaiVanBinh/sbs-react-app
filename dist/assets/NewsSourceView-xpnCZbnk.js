import{d as A,V as q,W as B,k as u,a as E,h as O,w as D,Y as o,G as n,j as v,a1 as f,aj as U,at as P,a2 as C,a3 as z,az as L,o as G,aD as R,ai as W,c as Y,aG as J,K as j}from"./index-eLyz9_Ts.js";import{C as Q}from"./company-enum-MfEiIQ-N.js";import{_ as X}from"./NewsSourceList.vue_vue_type_script_setup_true_lang-y3fTp4YU.js";import{_ as Z}from"./SearchForm.vue_vue_type_script_setup_true_lang-iGmgdrLf.js";import{v as H,r as K}from"./async-validator.util-IJrtpoc1.js";import"./make-grid-column-aeLSdEws.js";import"./journalist-QNhBHHjf.js";import"./organization-qjYuRO6g.js";import"./time-formatter-ySAnBDjB.js";import"./BaseList.vue_vue_type_script_setup_true_lang-aJzIAVm-.js";const ee={class:"flex flex-col space-y-4 rounded-md"},ae={class:"flex flex-col space-y-1"},oe={class:"flex justify-end space-x-4"},le=A({__name:"NewsSourceCreateModal",emits:["close","on-submit"],setup(I,{emit:S}){const y=S,c=q({name:"",email:""}),{pass:b,errorFields:t}=B(c,K,{validateOption:H}),m=u(),p=u(),r=u(),N=u(),i=()=>{m.value=m.value.replace(/[^0-9]/g,"").replace(/^(\d{2,3})(\d{3,4})(\d{4})$/,"$1-$2-$3")},w=()=>{y("close")},g=()=>{const _={providerName:c.name.trim(),phoneNumber:m.value,email:c.email.trim(),dutyName:p.value,companyName:r.value,memo:N.value};y("on-submit",_),w()};return(_,l)=>(E(),O(z,{"modal-class":"sm:w-1/3",onClose:w},{title:D(()=>l[6]||(l[6]=[o("div",null,"취재원",-1)])),content:D(()=>{var a,x,V,k,h;return[o("div",ee,[o("div",null,[n(f,{modelValue:c.name,"onUpdate:modelValue":l[0]||(l[0]=d=>c.name=d),name:"providerName",label:"이름",required:"","error-msg":(x=(a=v(t))==null?void 0:a.name)!=null&&x.length?(V=v(t))==null?void 0:V.name[0].message:"",placeholder:"이름"},null,8,["modelValue","error-msg"])]),o("div",null,[n(f,{modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=d=>r.value=d),label:"소속",name:"companyName",placeholder:"소속"},null,8,["modelValue"])]),o("div",null,[n(f,{modelValue:p.value,"onUpdate:modelValue":l[2]||(l[2]=d=>p.value=d),label:"분류",name:"dutyName",placeholder:"분류"},null,8,["modelValue"])]),o("div",null,[n(f,{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=d=>m.value=d),name:"phoneNumber",placeholder:"010-1234-5678",onInput:i},null,8,["modelValue"])]),o("div",null,[n(f,{modelValue:c.email,"onUpdate:modelValue":l[4]||(l[4]=d=>c.email=d),label:"이메일",required:"",name:"email","error-msg":(h=(k=v(t))==null?void 0:k.email)!=null&&h.length?v(t).email[0].message:"",placeholder:"이메일"},null,8,["modelValue","error-msg"])]),o("div",ae,[l[7]||(l[7]=o("span",{class:"text-xs dark:text-gray-200 text-gray-700 font-medium"},"메모",-1)),l[8]||(l[8]=o("label",{for:"memo"},null,-1)),U(o("textarea",{id:"schedule","onUpdate:modelValue":l[5]||(l[5]=d=>N.value=d),rows:"5",placeholder:"메모",class:"text-xs p-2 dark:bg-dark-input dark:text-white dark:border-dark-border border focus:outline-none focus:ring-1 rounded-md focus:ring-primary focus:border-primary"},null,512),[[P,N.value]])]),o("div",oe,[n(C,{type:"secondary","button-text":"취소",class:"border dark:border-dark-border",onClick:w}),n(C,{"button-text":"추가",disabled:!v(b),class:"border dark:border-dark-border",onClick:g},null,8,["disabled"])])])]}),_:1}))}}),se=L(le,[["__scopeId","data-v-53ad1b9a"]]),ne={class:"flex flex-col space-y-4 rounded-md"},te={class:"flex flex-col space-y-1"},re={class:"flex justify-end space-x-4"},de=A({__name:"NewsSourceEditModal",props:{id:{}},emits:["close","on-edit"],setup(I,{emit:S}){const y=I,c=S,b=u(),t=u(),m=u(),p=u(),r=q({name:"",email:""}),{pass:N,errorFields:i}=B(r,K,{validateOption:H}),w=async()=>{const l=R();try{const a=await l.newsSource.basic.findOne(y.id);a.success&&(r.name=a.data.providerName,r.email=a.data.email,b.value=a.data.phoneNumber,t.value=a.data.dutyName,m.value=a.data.dutyName,p.value=a.data.memo)}catch(a){console.log("Fail to get news source info",a)}},g=()=>{c("close")},_=()=>{const l={providerName:r.name.trim(),phoneNumber:b.value,email:r.email.trim(),dutyName:t.value,companyName:m.value,memo:p.value};c("on-edit",l),g()};return G(()=>w()),(l,a)=>(E(),O(z,{"modal-class":"sm:w-1/3",onClose:g},{title:D(()=>a[6]||(a[6]=[o("div",null,"취재원",-1)])),content:D(()=>{var x,V,k,h,d;return[o("div",ne,[o("div",null,[n(f,{modelValue:r.name,"onUpdate:modelValue":a[0]||(a[0]=e=>r.name=e),label:"이름",name:"providerName",required:"","error-msg":(V=(x=v(i))==null?void 0:x.name)!=null&&V.length?(k=v(i))==null?void 0:k.name[0].message:"",placeholder:"이름"},null,8,["modelValue","error-msg"])]),o("div",null,[n(f,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),label:"소속",name:"companyName",placeholder:"소속"},null,8,["modelValue"])]),o("div",null,[n(f,{modelValue:t.value,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value=e),label:"분류",name:"dutyName",placeholder:"분류"},null,8,["modelValue"])]),o("div",null,[n(f,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e),label:"연락처",name:"phoneNumber",placeholder:"010-1234-5678"},null,8,["modelValue"])]),o("div",null,[n(f,{modelValue:r.email,"onUpdate:modelValue":a[4]||(a[4]=e=>r.email=e),label:"이메일",name:"email",required:"","error-msg":(d=(h=v(i))==null?void 0:h.email)!=null&&d.length?v(i).email[0].message:"",placeholder:"이메일"},null,8,["modelValue","error-msg"])]),o("div",te,[a[7]||(a[7]=o("span",{class:"text-xs dark:text-gray-200 text-gray-700 font-medium"},"메모",-1)),a[8]||(a[8]=o("label",{for:"memo"},null,-1)),U(o("textarea",{id:"schedule","onUpdate:modelValue":a[5]||(a[5]=e=>p.value=e),rows:"5",placeholder:"메모",class:"text-xs p-2 dark:bg-dark-input dark:text-white dark:border-dark-border border focus:outline-none focus:ring-1 rounded-md focus:ring-primary focus:border-primary"},null,512),[[P,p.value]])]),o("div",re,[n(C,{type:"secondary","button-text":"취소",class:"border dark:border-dark-border",onClick:g}),n(C,{"button-text":"수정",disabled:!v(N),class:"border dark:border-dark-border",onClick:_},null,8,["disabled"])])])]}),_:1}))}}),ue=L(de,[["__scopeId","data-v-072bc7e3"]]),me={class:"flex flex-col h-full gap-y-3"},ie={class:"flex justify-between items-center flex-wrap"},ce={class:"flex gap-x-1.5"},ke=A({__name:"NewsSourceView",setup(I){const S=u(),y=u(1),c=u(),b=u(""),t=u(),m=u(!1),p=u(!1),r=R(),N=Q.basic,i=async()=>{const e={channelDivisionIds:N,page:y.value-1,searchValue:b.value};try{const s=await r.newsSource.basic.findAll(e);s.success&&(S.value=s.data.content,c.value={isShow:!0,page:y.value,numberOfElements:s.data.numberOfElements,totalElements:s.data.totalElements,totalPages:s.data.totalPages,size:s.data.size})}catch(s){console.log("Fail to get news source",s)}},w=()=>{m.value=!0},g=()=>{p.value=!0},_=async e=>{try{const s={providerName:e.providerName,phoneNumber:e.phoneNumber,email:e.email,dutyName:e.dutyName,companyName:e.companyName,memo:e.memo,publishDivisionCode:"all"};(await r.newsSource.basic.create(s)).success&&(window.Notify.success({message:"[취재원] 등록되었습니다."}),await i())}catch(s){console.log("Fail to add news source",s)}},l=e=>{var s;t.value=(s=e[0])==null?void 0:s.data},a=async()=>{try{(await r.newsSource.basic.delete(t.value.newsSourceId)).success&&(window.Notify.success({message:"[취재원] 삭제 되었습니다."}),await i())}catch(e){console.log("Fail to delete news source",e)}},x=async e=>{try{const s={providerName:e.providerName,phoneNumber:e.phoneNumber,email:e.email,dutyName:e.dutyName,companyName:e.companyName,memo:e.memo,publishDivisionCode:"all"};(await r.newsSource.basic.update(t.value.newsSourceId,s)).success&&(window.Notify.success({message:"[취재원] 수정 되었습니다."}),await i())}catch(s){console.log("Fail to update news source",s)}},V=e=>{b.value=e.value,i()},k=()=>{y.value=1,i()},h=e=>{y.value=e,i()},d=e=>{t.value=e.data,p.value=!0};return G(()=>i()),(e,s)=>{var F,M;const $=W("tooltip");return E(),Y("div",null,[o("div",me,[o("div",ie,[n(Z,{"search-value":b.value,class:"gap-1.5","onClick:search":V},null,8,["search-value"]),o("div",ce,[U(n(v(C),{icon:"arrow-path",onClick:k},null,512),[[$,"새로고침"]]),U(n(v(C),{icon:"plus",onClick:w},null,512),[[$,"추가"]]),U(n(v(C),{icon:"pencil",disabled:!t.value,onClick:g},null,8,["disabled"]),[[$,"수정"]]),U(n(J,{title:(F=t.value)==null?void 0:F.providerName,disabled:!t.value,icon:"trash",onOnConfirm:a},null,8,["title","disabled"]),[[$,"삭제"]])])]),n(X,{"row-data":S.value,"page-info":c.value,onOnSelected:l,onOnDoubleClick:d,onOnChangePage:h},null,8,["row-data","page-info"])]),o("div",null,[m.value?(E(),O(se,{key:0,onOnSubmit:_,onClose:s[0]||(s[0]=T=>m.value=!1)})):j("",!0),p.value?(E(),O(ue,{key:1,id:(M=t.value)==null?void 0:M.newsSourceId,onOnEdit:x,onClose:s[1]||(s[1]=T=>p.value=!1)},null,8,["id"])):j("",!0)])])}}});export{ke as default};
