import{_ as S}from"./Comment.vue_vue_type_script_setup_true_lang-4b5dYawy.js";import{d as N,aD as A,aa as D,k as x,o as $,t as R,a as y,c as _,G as d,a5 as E,u as T,aq as P,aP as V,V as j,l as Y,Y as I,a6 as U,w as O,X as z,a0 as F,j as G,a2 as Q,K as L,h as q,F as H}from"./index-eLyz9_Ts.js";import{_ as K}from"./ContentHeaderButtons.vue_vue_type_script_setup_true_lang-Db8CUXqr.js";import{_ as X}from"./ConfirmModal.vue_vue_type_script_setup_true_lang-k_ZxaDhN.js";import{_ as M}from"./ModalButton.vue_vue_type_script_setup_true_lang-WIw8hxFk.js";const ie=N({__name:"BulletinBoardComment",props:{commentList:{},currentBoardId:{},currentPostId:{},isLoadingComments:{type:Boolean},commentCount:{}},emits:["on-refresh"],setup(g,{emit:h}){const c=h,e=g,o=A(),{getChDivId:r}=D(),m=x(!1),l=x([]),C=x([]),t=async s=>{if(!e.currentBoardId||!e.currentPostId)return;const n=await o.community.bulletinBoard.createComment(e.currentBoardId,e.currentPostId,s);if(n.success){c("on-refresh"),window.Notify.success({message:"success"});return}window.Notify.error({message:n.msg})},v=async()=>{c("on-refresh")},B=async s=>{if(!e.currentBoardId||!e.currentPostId)return;const n=await o.community.bulletinBoard.deleteComment(e.currentBoardId,e.currentPostId,s);if(n.success){c("on-refresh"),window.Notify.success({message:"success"});return}window.Notify.error({message:n.message})},w=async(s,n,i,u)=>{if(!e.currentBoardId||!e.currentPostId||e.isLoadingComments||m.value)return;const a={userId:u||0,bulletBbCmntId:s,isActive:n};if(n===i){m.value=!0,a.isActive=null;const k=await o.community.bulletinBoard.cancelCommentLike(e.currentBoardId,e.currentPostId,a);k!=null&&k.success&&c("on-refresh"),m.value=!1;return}m.value=!0;const p=await o.community.bulletinBoard.likeComment(e.currentBoardId,e.currentPostId,a);p!=null&&p.success&&c("on-refresh"),m.value=!1},b=async s=>{const n=l.value.find(i=>i.id===s);n&&(n.isReplying=!0)},f=async()=>{const s={chDivId:r,useYn:"Y",delYn:"N",size:1e4},n=await o.community.bulletinBoard.getUsers(s);n.success&&(C.value=n.data.content.map(i=>({id:i.id,name:i.userNm})))};return $(async()=>{await f()}),R(()=>[e.commentList,e.currentBoardId,e.currentPostId],()=>{if(!e.currentBoardId||!e.currentPostId){l.value=[];return}l.value=e.commentList},{immediate:!0}),(s,n)=>(y(),_("div",null,[d(S,{"parent-id":s.currentPostId,"user-list":C.value,"comment-list":l.value,"comment-count":s.commentCount,onOnSubmit:t,onOnRefresh:v,onOnDelete:B,onOnLikeComment:w,onOnReply:b},null,8,["parent-id","user-list","comment-list","comment-count"])]))}}),J={class:"border-t border-primary-gray-surface-500 flex items-center justify-between m-[-0.5rem] mb-0 px-2 py-2 bg-primary-gray-900 border-b dark:bg-dark"},W={key:0,class:"flex items-center gap-x-2.5 ml-4"},Z={key:1,class:"ml-auto"},ee={class:"px-11 h-[50px] border-t border-primary-gray-surface flex items-center justify-center"},te={class:"flex items-center justify-center gap-x-2 w-full"},ce=N({__name:"BulletinBoardHeader",props:{title:{default:""},isEditAndCreate:{type:Boolean,default:!1},shouldShowMenu:{type:Boolean,default:!1}},emits:["on-create","on-create-board","on-save","on-edit","on-delete","on-delete-click","on-print","on-post","on-close","on-search"],setup(g,{expose:h,emit:c}){const e=g,o=c,{t:r}=E(),m=T(),{deleteTab:l}=P(),{getTabs:C}=V(P()),t=j({isOpen:!1,title:"",content:"",type:"confirm",intent:"",icon:"customQuestionMark"}),v=Y(()=>e.isEditAndCreate?!0:e.shouldShowMenu),B=()=>{t.isOpen=!0,t.title=r("Community.확인"),t.content=r("Community.자료를 삭제하시겠습니까?"),t.intent="delete",t.type="confirm",t.icon="customQuestionMark"},w=()=>{o("on-delete")},b=()=>{switch(t.intent){case"delete":w();break}t.isOpen=!1},f=()=>{const u=C.value.filter(a=>a.path===m.path);u.length&&l(u[0])},s=[{id:1,label:r("Community.신규"),action:()=>o("on-create")},{id:2,label:r("Community.교정"),action:()=>o("on-edit")},{id:3,label:r("Community.삭제"),action:()=>o("on-delete-click")},{id:4,label:r("Community.인쇄"),selectList:[r("Community.기본"),r("Community.목록")],action:()=>o("on-print")},{id:5,label:"Post",action:()=>o("on-post")},{id:6,label:r("Community.닫기"),action:f}],n=[{id:1,label:"저장",action:()=>o("on-save")},{id:2,label:"닫기",action:f}],i=()=>{o("on-create-board")};return h({onClose:f,confirmDeleteModal:B}),(u,a)=>(y(),_(H,null,[I("div",J,[u.isEditAndCreate?L("",!0):(y(),_("div",W,[d(U,{icon:"star",color:"text-gray-400",size:"h-5 w-5"}),a[2]||(a[2]=I("p",{class:"text-primary-gray-50 text-sm font-bold"},"게시판 생성",-1)),d(Q,{class:"!rounded-xl w-[78px] !text-[10px] font-bold",onClick:i},{default:O(()=>[z(F(G(r)("Community.게시판 생성")),1)]),_:1})])),v.value?(y(),_("div",Z,[d(K,{"menu-items":u.isEditAndCreate?n:s},null,8,["menu-items"])])):L("",!0)]),t.isOpen?(y(),q(X,{key:0,"use-slot":"",intent:"secondary",text:t.content,type:t.type,title:t.title,icon:t.icon,onOnSubmit:b,onClose:a[1]||(a[1]=p=>t.isOpen=!1)},{bottom:O(()=>[I("div",ee,[I("div",te,[d(M,{text:"예",icon:"check",onClick:b}),d(M,{type:"warning",text:"아니요",icon:"xMark",onClick:a[0]||(a[0]=p=>t.isOpen=!1)})])])]),_:1},8,["text","type","title","icon"])):L("",!0)],64))}});export{ce as _,ie as a};
