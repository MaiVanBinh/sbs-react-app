import{d as y,k,ag as _,t as L,a7 as $,a as i,c as m,F as N,C as B,Y as c,a0 as x,Q as S,G as h,K as b,bf as C,o as j,h as M,w as g,j as I,X as E,a2 as w,a3 as V,l as U,ai as F,aj as T,as as Y}from"./index-eLyz9_Ts.js";import{u as z}from"./department-wnuBQoCo.js";const G=["onClick"],K={key:0,class:"ml-4 mt-2"},O=y({__name:"DepartmentChildList",props:{departments:{},selectedDepartments:{},useMultiSelect:{type:Boolean,default:!0}},emits:["update:selected-departments"],setup(f,{emit:v}){const r=f,o=v,s=k(_.cloneDeep(r.selectedDepartments)),l=e=>{r.useMultiSelect||(s.value=[]),s.value.push({departmentId:e.departmentId,departmentName:e.departmentName}),e.childDepartmentList&&r.useMultiSelect&&e.childDepartmentList.forEach(a=>l(a))},u=e=>{s.value=s.value.filter(a=>a.departmentId!==e),r.departments.forEach(a=>{a.childDepartmentList&&a.childDepartmentList.forEach(t=>{t.departmentId===e&&(s.value=s.value.filter(d=>d.departmentId!==t.departmentId))})})},p=e=>s.value.some(a=>a.departmentId===e),D=e=>{s.value=r.useMultiSelect?_.cloneDeep(e):e.filter((a,t)=>(console.log(a),t===e.length-1)),o("update:selected-departments",s.value)},n=e=>{p(e.departmentId)?u(e.departmentId):l(e),o("update:selected-departments",s.value)};return L(()=>r.selectedDepartments,e=>{s.value=_.cloneDeep(e)},{deep:!0}),(e,a)=>{const t=$("department-child-list",!0);return i(),m("ul",null,[(i(!0),m(N,null,B(e.departments,d=>(i(),m("li",{key:d.departmentId,class:"mb-2"},[c("div",{class:S(["cursor-pointer p-2 border rounded-lg",p(d.departmentId)?"bg-primary":"bg-white","hover:bg-primary-100"]),onClick:J=>n(d)},x(d.departmentName),11,G),d.childDepartmentList&&d.childDepartmentList.length?(i(),m("ul",K,[h(t,{departments:d.childDepartmentList,"selected-departments":e.selectedDepartments,"onUpdate:selectedDepartments":D},null,8,["departments","selected-departments"])])):b("",!0)]))),128))])}}}),Q={class:"flex flex-col h-full justify-between"},R={class:"flex flex-col h-full overflow-auto pr-1"},X={class:"flex justify-end space-x-2 pt-4 pb-2"},q=y({__name:"DepartmentMultiSelectModal",props:{selectedDepartments:{default:()=>[]},useMultiSelect:{type:Boolean,default:!0}},emits:["on-selected-department","close"],setup(f,{emit:v}){const r=f,o=v,{fetchDepartments:s}=z(),l=k([]),{selectedDepartments:u}=C(r,o),p=async()=>{const t=await s({useYn:!0});t.success&&(l.value=t.data.departmentList)},D=a=>{u.value=[...a]},n=()=>{o("close")},e=()=>{o("on-selected-department",u.value)};return j(()=>{p()}),(a,t)=>(i(),M(V,{"modal-class":"w-1/3","content-class":"h-[70vh]",onClose:n},{title:g(()=>t[0]||(t[0]=[c("div",null,"부서선택",-1)])),content:g(()=>[c("div",Q,[t[2]||(t[2]=c("div",null,"부서 목록",-1)),c("div",R,[h(O,{departments:l.value,"selected-departments":I(u),"use-multi-select":a.useMultiSelect,"onUpdate:selectedDepartments":D},null,8,["departments","selected-departments","use-multi-select"])]),c("div",X,[h(w,{type:"secondary",class:"dark:bg-dark-secondary dark:text-white dark:hover:bg-gray-600",onClick:n},{default:g(()=>t[1]||(t[1]=[E("취소")])),_:1}),h(w,{"button-text":"선택",onClick:e})])])]),_:1}))}}),A={ref:"selectedItems",class:"flex flex-wrap max-w-full overflow-hidden text-xs"},H={class:"truncate"},Z=y({__name:"DepartmentMultiSelect",props:{selectedDepartments:{default:()=>[]},width:{default:"w-44"},useMultiSelect:{type:Boolean,default:!0}},emits:["on-selected-department","update:selectedDepartments"],setup(f,{emit:v}){const r=f,o=v,s=k(!1),{selectedDepartments:l}=C(r,o),u=()=>{s.value=!0},p=U(()=>{let n="";return l.value.length?n=l.value.map(e=>e.departmentName).join(", "):n="부서를 선택해주세요.",n}),D=n=>{l.value=n,o("on-selected-department",l.value),s.value=!1};return(n,e)=>{const a=F("tooltip");return i(),m("div",{class:S(["select-none min-w-[8rem]",[n.width]])},[T((i(),m("div",{class:"p-2 border border-gray-300 bg-white cursor-pointer rounded-md active:border-primary focus:ring-1 ring-primary",onClick:u},[c("div",A,[c("div",H,x(p.value),1)],512)])),[[a,p.value]]),s.value?(i(),M(q,{key:0,"selected-departments":I(l),"onUpdate:selectedDepartments":e[0]||(e[0]=t=>Y(l)?l.value=t:null),"use-multi-select":n.useMultiSelect,onOnSelectedDepartment:D,onClose:e[1]||(e[1]=t=>s.value=!1)},null,8,["selected-departments","use-multi-select"])):b("",!0)],2)}}});export{Z as _};
