import{d as G,k as l,c6 as te,a as $,c as J,h as P,K as z,a6 as X,al as ve,am as fe,aD as W,a5 as Q,V as ae,W as oe,o as le,w as H,X as se,a0 as ne,j as b,Y as L,G as t,a1 as x,$ as re,a2 as I,a3 as de,aJ as Z,aO as Ce,ab as be,ae as ee,ad as ge,ai as Ue,af as Ve,L as we,aj as j,aG as Me,ap as he}from"./index-eLyz9_Ts.js";import{C as ye}from"./company-enum-MfEiIQ-N.js";import{u as De}from"./use-date-GeeGTbYh.js";import{r as xe}from"./use-render-component-K20sHqiA.js";import{G as q}from"./GTextarea-5GIFD2Mo.js";import{_ as ie}from"./FileDropzone.vue_vue_type_script_setup_true_lang-SVeHifZw.js";import{F as ce}from"./file-division-code-x51qUgaH.js";import{u as ue}from"./file-Gx0JxWZZ.js";import{d as me}from"./async-validator.util-IJrtpoc1.js";import{_ as pe}from"./UserAddSelect.vue_vue_type_script_setup_true_lang-1UBsZdY3.js";import{A as _e}from"./app-authority-code-Q9MU7mjP.js";/* empty css                                                                  */import"./use-model-wrapper-XtiLc3Xd.js";import"./FileListView.vue_vue_type_script_setup_true_lang-A40KFqZZ.js";import"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";import"./GVideoPlayer-1SUF8s3O.js";import"./main-sHItgwS4.js";import"./vue.runtime.esm-bundler-3P3R-Xon.js";import"./GSingleSelect-7u8H0FdH.js";import"./vue-multiselect-Yz8FsF-E.js";import"./DepartmentMultiSelect.vue_vue_type_script_setup_true_lang-OqmQVQH2.js";import"./department-wnuBQoCo.js";const Ne={class:"flex items-center"},Ye=G({__name:"ContactAgreeCheckIcon",props:{params:{}},setup(g){const r=g,n=l();return te(()=>{n.value=r.params.value==="Y"}),(p,_)=>($(),J("div",Ne,[n.value?($(),P(X,{key:0,icon:"check"})):z("",!0)]))}}),Ae={class:"flex items-center"},Ee=G({__name:"ContactAttachIcon",props:{params:{}},setup(g){const r=g,n=l();return te(()=>{n.value=r.params.value.length!==0}),(p,_)=>($(),J("div",Ae,[n.value?($(),P(X,{key:0,icon:"paper-clip"})):z("",!0)]))}}),ke=G({__name:"ContactUsList",props:{isLoading:{type:Boolean},rowData:{},pageInfo:{}},emits:["selected-row","double-clicked-row","on-change-page"],setup(g,{emit:r}){const n=r,{formatDate:p}=De(),_=()=>{const a=document.createElement("div");return a.className="h-full flex flex-col justify-center items-center",xe(X,{icon:"check-circle"},a)},c=[{headerName:"순번",maxWidth:60,valueGetter:"node.rowIndex",cellRenderer:a=>fe(a)},{headerName:"기사화",field:"publishYn",filter:!1,minWidth:70,maxWidth:70,cellRenderer:a=>{if(a.value==="Y")return _()}},{headerName:"제목",field:"reportTitl",sortable:!1,minWidth:360},{headerName:"개인정보 동의 여부",field:"agreedYn",maxWidth:150,cellRenderer:Ye,cellStyle:{display:"flex",AlignItems:"center"}},{headerName:"첨부파일",field:"reportAttachmentFileList",maxWidth:150,cellRenderer:Ee,valueFormatter:"",cellStyle:{display:"flex",AlignItems:"center"}},{headerName:"등록일시",field:"inputDtm",valueFormatter:a=>p(a.data.inputDtm,"YYYY-MM-DD HH:mm:ss")},{headerName:"메모",field:"memo",sortable:!1},{headerName:"수정자",field:"updtrNm",sortable:!1,maxWidth:160},{headerName:"수정일시",field:"updtDtm",valueFormatter:a=>p(a.data.updtDtm,"YYYY-MM-DD HH:mm:ss")}],O=a=>{n("selected-row",a)},N=a=>{n("double-clicked-row",a)},D=a=>{n("on-change-page",a)};return(a,V)=>($(),P(ve,{"column-defs":c,"row-data":a.rowData,"is-loading":a.isLoading,filter:!1,"page-info":a.pageInfo,"suppress-movable":!1,"row-selection":"single",onSelectedRows:O,onDoubleClickedRow:N,onOnChangePage:D},null,8,["row-data","is-loading","page-info"]))}}),Fe={class:"flex flex-col h-full space-y-2"},Le={class:"flex space-x-2"},$e={class:"flex space-x-2"},Ie={class:"space-x-3 flex items-center justify-end"},Re=G({__name:"ContactEditModal",props:{id:{}},emits:["close","on-edit"],setup(g,{emit:r}){const n=g,p=r,_=W(),{t:c}=Q(),{fileUpload:O}=ue(),N=l(),D=ae({title:N}),{pass:a,errorFields:V}=oe(D,me.rules),U=l(),w=l(),M=l(),Y=l(),h=l(),A=l(),C=l(),E=l(),R=l(),S=l([]),k=l([]),d=[],f={reportTitl:c("Modal.ContactUs.EditModal.제목"),reportCtt:c("Modal.ContactUs.EditModal.제보_내용"),agreedYn:c("Modal.ContactUs.EditModal.개인정보_동의_여부"),email:c("Modal.ContactUs.EditModal.이메일"),inputDtm:c("Modal.ContactUs.EditModal.등록일시"),reportNm:c("Modal.ContactUs.EditModal.제보자"),updtrNm:c("Modal.ContactUs.EditModal.수정자"),updtDtm:c("Modal.ContactUs.EditModal.수정일시"),memo:c("Modal.ContactUs.EditModal.관리자_메모"),phone:c("Modal.ContactUs.EditModal.연락처"),reportAttachmentFileList:c("Modal.ContactUs.EditModal.첨부파일")},y=()=>{p("close")},F=async()=>{try{const o=await _.contactUs.basic.findOne(n.id);o.success&&(console.log(o),N.value=o.data.reportTitl,U.value=o.data.reportCtt,w.value=o.data.agreedYn==="Y",M.value=o.data.email,h.value=o.data.reportNm,Y.value=Z(o.data.inputDtm),C.value=Z(o.data.updtDtm),A.value=o.data.updtrNm,E.value=o.data.memo,R.value=o.data.phone,k.value=o.data.reportAttachmentFileList.map(e=>({...e,name:e.fileName})),S.value=o.data.reportViewerList)}catch(o){console.log("Fail to get detail contact",o)}},i=async o=>{const e={reportAttachFileIdList:[o]};try{const v=await _.contactUs.basic.addAttachFile(n.id,e);v.success&&(console.log(v),window.Notify.success({message:"[첨부파일 추가] 완료되었습니다."}),await F())}catch(v){console.log("Fail to add attachment file",v)}},K=async()=>{var e;const o={reportTitl:N.value,reportCtt:U.value,reportNm:h.value,email:M.value,phone:R.value,agreedYn:w.value?"Y":"N",memo:E.value,targetViewerIds:(e=S.value)==null?void 0:e.map(v=>v.id)};p("on-edit",o),y()},u=async o=>{o.map(async e=>{const v={fileName:e.name,publicYn:"Y",fileDivisionCode:ce.Report.id,file:e};try{const T=await O(v);if(T.success){d.push(T.data.id);const B=T.data.id;await i(B)}}catch(T){console.log("Fail to add file",T)}})},s=async o=>{try{const e={reportAttachFileIdList:[o.id]},v=await _.contactUs.basic.deleteAttachFile(n.id,e);v.success&&(console.log(v),await F())}catch(e){console.log("Fail to delete attachment file",e)}};return le(()=>F()),(o,e)=>($(),P(de,{"modal-class":"sm:w-1/2","content-class":"h-[85vh]",onClose:y},{title:H(()=>[se(ne(b(c)("Menu.ContactUsManagementView")),1)]),content:H(()=>{var v,T,B;return[L("div",Fe,[t(x,{modelValue:N.value,"onUpdate:modelValue":e[0]||(e[0]=m=>N.value=m),label:f.reportTitl,required:"","error-msg":(T=(v=b(V))==null?void 0:v.title)!=null&&T.length?(B=b(V))==null?void 0:B.title[0].message:""},null,8,["modelValue","label","error-msg"]),t(q,{modelValue:U.value,"onUpdate:modelValue":e[1]||(e[1]=m=>U.value=m),label:f.reportCtt},null,8,["modelValue","label"]),t(re,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=m=>w.value=m),label:f.agreedYn,checked:w.value},null,8,["modelValue","label","checked"]),L("div",Le,[t(x,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=m=>h.value=m),label:f.reportNm},null,8,["modelValue","label"]),t(x,{modelValue:R.value,"onUpdate:modelValue":e[4]||(e[4]=m=>R.value=m),label:f.phone},null,8,["modelValue","label"]),t(x,{modelValue:M.value,"onUpdate:modelValue":e[5]||(e[5]=m=>M.value=m),label:f.email},null,8,["modelValue","label"])]),L("div",$e,[t(x,{modelValue:Y.value,"onUpdate:modelValue":e[6]||(e[6]=m=>Y.value=m),label:f.inputDtm,disabled:""},null,8,["modelValue","label"]),t(x,{modelValue:A.value,"onUpdate:modelValue":e[7]||(e[7]=m=>A.value=m),label:f.updtrNm,disabled:""},null,8,["modelValue","label"]),t(x,{modelValue:C.value,"onUpdate:modelValue":e[8]||(e[8]=m=>C.value=m),label:f.updtDtm,disabled:""},null,8,["modelValue","label"])]),t(q,{modelValue:E.value,"onUpdate:modelValue":e[9]||(e[9]=m=>E.value=m),label:f.memo,rows:4},null,8,["modelValue","label"]),t(pe,{modelValue:S.value,"onUpdate:modelValue":e[10]||(e[10]=m=>S.value=m),label:"공개 대상자 지정","table-name":"공개 대상자",class:"space-y-2"},null,8,["modelValue"]),t(ie,{"file-data":k.value,"onUpdate:fileData":e[11]||(e[11]=m=>k.value=m),mode:"edit","is-read-only":!1,onOnUploadFile:u,onOnDeleteFile:s},null,8,["file-data"]),L("div",Ie,[t(I,{type:"secondary","button-text":b(c)("Modal.ContactUs.EditModal.취소"),onClick:y},null,8,["button-text"]),t(I,{"button-text":b(c)("Modal.ContactUs.EditModal.수정"),disabled:!b(a),onClick:K},null,8,["button-text","disabled"])])])]}),_:1}))}}),Se={class:"flex flex-col h-full space-y-2"},Te={class:"flex space-x-2"},Oe={class:"space-x-3 flex items-center justify-end"},Pe=G({__name:"ContactCreateModal",emits:["close","on-submit"],setup(g,{emit:r}){const n=r,{t:p}=Q(),{fileUpload:_}=ue(),c=l(),O=ae({title:c}),{pass:N,errorFields:D}=oe(O,me.rules),a=l(),V=l(),U=l(),w=l(),M=l(),Y=l(),h=l([]),A=l([]),C={reportTitl:p("Modal.ContactUs.CreateModal.제목"),reportCtt:p("Modal.ContactUs.CreateModal.제보_내용"),agreedYn:p("Modal.ContactUs.CreateModal.개인정보_동의_여부"),email:p("Modal.ContactUs.CreateModal.이메일"),reportNm:p("Modal.ContactUs.CreateModal.제보자"),memo:p("Modal.ContactUs.CreateModal.관리자_메모"),phone:p("Modal.ContactUs.CreateModal.연락처"),reportAttachmentFileList:p("Modal.ContactUs.CreateModal.첨부파일")},E=()=>{n("close")},R=async()=>{var f;if(!h.value)return[];const k=(f=h==null?void 0:h.value)==null?void 0:f.map(async y=>{const F={fileName:y.name,publicYn:"Y",fileDivisionCode:ce.Report.id,file:y},i=await _(F);if(i.success)return i.data.id});return await Promise.all(k)},S=async()=>{var f;const k=await R(),d={reportTitl:c.value,reportCtt:a.value,reportNm:w.value,email:U.value,phone:Y.value,agreedYn:V.value?"Y":"N",memo:M.value,attcFileIds:k,targetViewerIds:(f=A.value)==null?void 0:f.map(y=>y.id)};n("on-submit",d),E()};return(k,d)=>($(),P(de,{"modal-class":"sm:w-1/2","content-class":"h-[85vh]",onClose:E},{title:H(()=>[se(ne(b(p)("Menu.ContactUsManagementView")),1)]),content:H(()=>{var f,y,F;return[L("div",Se,[t(x,{modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=i=>c.value=i),label:C.reportTitl,required:"","error-msg":(y=(f=b(D))==null?void 0:f.title)!=null&&y.length?(F=b(D))==null?void 0:F.title[0].message:""},null,8,["modelValue","label","error-msg"]),t(q,{modelValue:a.value,"onUpdate:modelValue":d[1]||(d[1]=i=>a.value=i),label:C.reportCtt},null,8,["modelValue","label"]),t(re,{modelValue:V.value,"onUpdate:modelValue":d[2]||(d[2]=i=>V.value=i),label:C.agreedYn,checked:V.value},null,8,["modelValue","label","checked"]),L("div",Te,[t(x,{modelValue:w.value,"onUpdate:modelValue":d[3]||(d[3]=i=>w.value=i),label:C.reportNm},null,8,["modelValue","label"]),t(x,{modelValue:Y.value,"onUpdate:modelValue":d[4]||(d[4]=i=>Y.value=i),label:C.phone},null,8,["modelValue","label"]),t(x,{modelValue:U.value,"onUpdate:modelValue":d[5]||(d[5]=i=>U.value=i),label:C.email},null,8,["modelValue","label"])]),t(q,{modelValue:M.value,"onUpdate:modelValue":d[6]||(d[6]=i=>M.value=i),label:C.memo,rows:4},null,8,["modelValue","label"]),t(pe,{modelValue:A.value,"onUpdate:modelValue":d[7]||(d[7]=i=>A.value=i),label:"공개 대상자 지정","table-name":"공개 대상자",class:"space-y-2"},null,8,["modelValue"]),t(ie,{"file-data":h.value,"onUpdate:fileData":d[8]||(d[8]=i=>h.value=i),mode:"create","is-read-only":!1},null,8,["file-data"]),L("div",Oe,[t(I,{type:"secondary","button-text":b(p)("Modal.ContactUs.CreateModal.취소"),onClick:E},null,8,["button-text"]),t(I,{"button-text":b(p)("Modal.ContactUs.CreateModal.등록"),disabled:!b(N),onClick:S},null,8,["button-text","disabled"])])])]}),_:1}))}}),We=Ce("contact-us",{actions:{async fetchContactUsList(g){try{return await W().contactUs.basic.findAll(g)}catch(r){console.error("store: fetchContactUsData() Error",r)}},async fetchContactUsData(g){try{return await W().contactUs.basic.findOne(g)}catch(r){console.error("store: fetchContactUs() Error",r)}},async createContactUs(g){try{return await W().contactUs.basic.create(g)}catch(r){console.error("store: createContactUs() Error",r)}},async updateContactUs(g,r){try{return await W().contactUs.basic.update(g,r)}catch(n){console.error("store: updateContactUs() Error",n)}},async deleteContactUs(g){try{return await W().contactUs.basic.delete(g)}catch(r){console.error("store: deleteContactUs() Error",r)}}}}),Ge={class:"space-y-3"},je={class:"flex justify-between flex-wrap gap-1"},Be={class:"flex items-center flex-wrap gap-1.5"},ze={class:"space-x-1.5"},ft=G({__name:"ContactUsManagementView",setup(g){const{can:r}=be(),{t:n}=Q(),{moveNewMyArticle:p}=he(),{fetchContactUsList:_,createContactUs:c,updateContactUs:O,deleteContactUs:N}=We(),D=l([ee().subtract(1,"month").format("YYYY-MM-DD"),ee().format("YYYY-MM-DD")]),a=l(1),V=l(""),U=l(),w=l(!1),M=l(!1),Y=l(),h=l(ge.sm),A=l({isShow:!1,page:1,totalElements:0,totalPages:1,numberOfElements:0,size:h.value}),C=async()=>{try{const u={startDate:D.value[0],endDate:D.value[1],chDivIds:ye.basic,searchValue:V.value,page:a.value-1},s=await _(u);s.success&&(Y.value=s.data.content.filter(o=>o.delYn==="N"),A.value={isShow:!0,page:a.value,totalPages:s.data.totalPages,totalElements:s.data.totalElements,numberOfElements:s.data.numberOfElements,size:s.data.size})}catch(u){console.error("ContactUsManagement: getContactUsData() Error",u)}},E=async u=>{try{(await c(u)).success&&(window.Notify.success({message:"[제보 등록] 완료되었습니다."}),await C())}catch(s){console.log("Fail to add report",s)}},R=async()=>{try{(await N(U.value.id)).success&&(window.Notify.success({message:"[제보 삭제] 완료되었습니다"}),await C())}catch(u){console.log("Fail to delete report",u)}},S=async u=>{try{(await O(U.value.id,u)).success&&(window.Notify.success({message:"[제보 수정] 완료되었습니다."}),await C())}catch(s){console.log("Fail to update contact memo",s)}},k=async()=>{a.value=1,V.value="",await C()},d=u=>{var s;U.value=(s=u[0])==null?void 0:s.data},f=u=>{U.value=u.data,M.value=!0},y=u=>{a.value=u,C()},F=u=>{a.value=1,D.value=u,C()},i=()=>{a.value=1,C()},K=()=>{const u={reportId:U.value.id};p(u)};return le(()=>{C()}),(u,s)=>{var e;const o=Ue("tooltip");return $(),J("div",Ge,[L("div",je,[L("div",Be,[t(Ve,{modelValue:D.value,"onUpdate:modelValue":s[0]||(s[0]=v=>D.value=v),onChange:F},null,8,["modelValue"]),t(x,{modelValue:V.value,"onUpdate:modelValue":s[1]||(s[1]=v=>V.value=v),placeholder:b(n)("ContactUsManagement.검색어"),width:"w-72",onKeyup:we(i,["enter"])},null,8,["modelValue","placeholder"]),t(I,{icon:"magnifying-glass",onClick:i})]),L("div",ze,[j(t(I,{icon:"pen","button-text":"기사화",disabled:!U.value,onClick:K},null,8,["disabled"]),[[o,"기사화"]]),j(t(I,{icon:"plus",onClick:s[2]||(s[2]=v=>w.value=!0)},null,512),[[o,b(n)("ContactUsManagement.등록")]]),j(t(I,{icon:"arrow-path",onClick:k},null,512),[[o,b(n)("ContactUsManagement.새로고침")]]),j(t(I,{icon:"pencil",disabled:!b(r)(b(_e).REPORT_WRITE.code)||!U.value,onClick:s[3]||(s[3]=v=>M.value=!0)},null,8,["disabled"]),[[o,b(n)("ContactUsManagement.수정")]]),j(t(Me,{icon:"trash",disabled:!U.value,onOnConfirm:R},null,8,["disabled"]),[[o,b(n)("ContactUsManagement.삭제")]])])]),t(ke,{"row-data":Y.value,"page-info":A.value,onSelectedRow:d,onDoubleClickedRow:f,onOnChangedPage:y},null,8,["row-data","page-info"]),w.value?($(),P(Pe,{key:0,onOnSubmit:E,onClose:s[4]||(s[4]=v=>w.value=!1)})):z("",!0),M.value?($(),P(Re,{key:1,id:(e=U.value)==null?void 0:e.id,onOnEdit:S,onClose:s[5]||(s[5]=v=>M.value=!1)},null,8,["id"])):z("",!0)])}}});export{ft as default};
