import{d as T,aa as Q,ab as Z,k as p,l as j,t as z,o as K,ai as ee,a as v,c as Y,G as u,j as a,a1 as S,Y as s,aM as ae,aj as G,h as P,K as _,a2 as U,au as te,a4 as se,a0 as $,ae as B,ad as oe,w as E,X as L,af as le,L as re,a3 as de}from"./index-eLyz9_Ts.js";import{c as w,_ as ne}from"./CoveragePlanList.vue_vue_type_script_setup_true_lang-vJ0F3lvx.js";import"./vue-multiselect-Yz8FsF-E.js";import{G as ie}from"./GSingleSelect-7u8H0FdH.js";import"./tag-Q73uuSte.js";import"./program-omP_c4K3.js";import"./article-type.code-5cb8riL1.js";import{_ as ue}from"./UserSelect.vue_vue_type_script_setup_true_lang-Hk5THi0e.js";import"./category-zIRntbmZ.js";import{_ as ce}from"./DepartmentMultiSelect.vue_vue_type_script_setup_true_lang-OqmQVQH2.js";import{u as H}from"./coverage-plan-nI7mLZOB.js";import{u as me}from"./use-model-wrapper-XtiLc3Xd.js";import{u as pe}from"./use-date-GeeGTbYh.js";import{_ as ve}from"./ArticleTypeSelect.vue_vue_type_script_setup_true_lang-Kp5wzGNr.js";import{G as F}from"./GTextarea-5GIFD2Mo.js";import{_ as fe}from"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";import{_ as ge}from"./ConfirmButton.vue_vue_type_script_setup_true_lang-onM9evN8.js";import{A}from"./app-authority-code-Q9MU7mjP.js";import{_ as be}from"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";const ye={class:"space-y-2"},ke={key:0,class:"space-y-1 sm:text-xs text-xs font-medium text-gray-700 dark:text-white"},xe={class:"flex items-center space-x-2 truncate"},Ce={key:0,class:"space-x-1"},_e={class:"flex space-x-2 items-center"},Pe={class:"flex space-x-2 items-center"},Ie={key:1,class:"dark:text-dark-gray-200 space-y-2 pt-2 border-t dark:border-dark-border"},he={class:"flex space-x-2 items-center"},De={class:"flex-1 text-xs space-y-1"},Ve={class:"truncate p-2 h-8 border shadow-sm focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary block rounded-md border-gray-300 dark:border-slate-600 bg-gray-200 dark:bg-dark-disabled"},we={class:"flex-1 text-xs space-y-1"},Ne={class:"truncate p-2 h-8 border shadow-sm focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary block rounded-md border-gray-300 dark:border-slate-600 bg-gray-200 dark:bg-dark-disabled"},$e={class:"flex space-x-2 items-center"},Ye={class:"flex-1 text-xs space-y-1"},Se={class:"truncate p-2 h-8 border shadow-sm focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary block rounded-md border-gray-300 dark:border-slate-600 bg-gray-200 dark:bg-dark-disabled"},Ue={class:"flex-1 text-xs space-y-1"},Re={class:"truncate p-2 h-8 border shadow-sm focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary block rounded-md border-gray-300 dark:border-slate-600 bg-gray-200 dark:bg-dark-disabled"},Me={class:"flex space-x-2 items-center"},Oe={class:"flex-1 text-xs space-y-1"},Ee={class:"truncate p-2 h-8 border shadow-sm focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary block rounded-md border-gray-300 dark:border-slate-600 dark:text-white bg-gray-200 dark:bg-dark-disabled"},Ae={class:"flex-1 text-xs space-y-1"},Te={class:"truncate p-2 h-8 border shadow-sm focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary block rounded-md border-gray-300 dark:border-slate-600 dark:text-white bg-gray-200 dark:bg-dark-disabled"},je=T({__name:"CoveragePlanMetaData",props:{coveragePlanMetaData:{default:()=>({coveragePlanId:0,title:"",departmentId:0,departmentName:"",reporter:void 0,reportDate:"",articleType:void 0,content:"",remark:"",phoneNumber:"",stateCode:"",stateName:"",rejectionReason:"",approveDateTime:"",approverId:"",approverUserId:"",approverName:"",updateDateTime:"",inputDateTime:"",inputerrUserId:"",inputerName:"",updaterUserId:"",updaterId:"",isSensitiveArticle:!1})},mode:{default:"create"},errorTitleMsg:{default:""}},emits:["update:coveragePlanMetaData","on-change-state","on-clicked-reject-button"],setup(N,{emit:V}){const n=N,k=V,{fetchUsers:x,getChDivId:b}=Q(),{formatDate:f}=pe(),{can:i}=Z(),e=me(n,k,"coveragePlanMetaData"),C=p([]),g=j(()=>n.mode==="read"||n.mode==="readOnly"),D=j(()=>n.mode!=="readOnly"),y=async()=>{const l={chDivId:b,useYn:"Y",delYn:"N",deptId:e.value.departmentId,size:1e4},t=e.value.reporter,h=await x(l);h.success&&(C.value=h.data.content,e.value.reporter=t)},o=()=>{k("on-clicked-reject-button")},I=()=>{const l={statusCode:w.APPROVE.id,rejectionReason:""};k("on-change-state",l)},R=l=>{e.value.reportDate=f(l,"YYYY-MM-DD")},M=j(()=>{let l="gray";switch(e.value.statusCode){case w.APPROVE.id:l="green";break;case w.REJECT.id:l="red";break;default:l="gray"}return l});return z(()=>e.value.coveragePlanId,()=>{y()}),K(()=>{n.mode==="create"&&y()}),(l,t)=>{const h=ee("tooltip");return v(),Y("div",ye,[u(a(S),{modelValue:a(e).title,"onUpdate:modelValue":t[0]||(t[0]=r=>a(e).title=r),placeholder:"제목",label:"제목",required:"",disabled:g.value,"error-msg":l.errorTitleMsg},null,8,["modelValue","disabled","error-msg"]),l.mode==="read"||l.mode==="readOnly"?(v(),Y("div",ke,[t[10]||(t[10]=s("div",null,"상태",-1)),s("div",xe,[u(ae,{color:M.value,"font-size":"text-sm",text:a(e).statusCodeName,class:"w-12"},null,8,["color","text"]),D.value?(v(),Y("div",Ce,[a(e).statusCode!==a(w).APPROVE.id&&a(i)(a(A).COVERAGE_PLAN_CONFIRM.code)?G((v(),P(ge,{key:0,title:`${a(e).title}`,html:"(을)를 승인하시겠습니까?",icon:"check-circle","button-text":"승인",disabled:!a(i)(a(A).COVERAGE_PLAN_CONFIRM.code),onOnConfirm:I},null,8,["title","disabled"])),[[h,"승인"]]):_("",!0),a(e).statusCode===a(w).PENDING.id&&a(i)(a(A).COVERAGE_PLAN_CONFIRM.code)?G((v(),P(U,{key:1,icon:"x-circle",type:"secondary","button-text":"반려",disabled:!a(i)(a(A).COVERAGE_PLAN_CONFIRM.code),onClick:o},null,8,["disabled"])),[[h,"반려"]]):_("",!0)])):_("",!0)]),G(u(F,{modelValue:a(e).rejectionReason,"onUpdate:modelValue":t[1]||(t[1]=r=>a(e).rejectionReason=r),label:"반려사유",rows:4,disabled:g.value},null,8,["modelValue","disabled"]),[[te,a(e).statusCode===a(w).REJECT.id]])])):_("",!0),s("div",_e,[u(a(S),{modelValue:a(e).departmentName,"onUpdate:modelValue":t[2]||(t[2]=r=>a(e).departmentName=r),placeholder:"부서명",label:"부서명",class:"flex-1",disabled:!0},null,8,["modelValue"]),u(ve,{modelValue:a(e).articleTypeCode,"onUpdate:modelValue":t[3]||(t[3]=r=>a(e).articleTypeCode=r),label:"형식","preselect-first":"",required:"",class:"flex-1",disabled:g.value},null,8,["modelValue","disabled"])]),s("div",Pe,[g.value?_("",!0):(v(),P(ie,{key:0,modelValue:a(e).reporterId,"onUpdate:modelValue":t[4]||(t[4]=r=>a(e).reporterId=r),name:"userNm",label:"취재기자",options:C.value,"item-label":"userNm","track-by":"id","allow-empty":"",searchable:!1,placeholder:"취재기자를 선택해주세요.",disabled:g.value,class:"flex-1"},null,8,["modelValue","options","disabled"])),g.value?(v(),P(a(S),{key:1,modelValue:a(e).reporterName,"onUpdate:modelValue":t[5]||(t[5]=r=>a(e).reporterName=r),label:"취재기자",class:"flex-1",disabled:!0},null,8,["modelValue"])):_("",!0),a(e).reporter?(v(),P(se,{key:2,modelValue:a(e).phoneNumber,"onUpdate:modelValue":t[6]||(t[6]=r=>a(e).phoneNumber=r),label:"연락처","mask-format":"###-####-####",placeholder:"등록된 연락처가 없습니다.",disabled:!0,class:"flex-1"},null,8,["modelValue"])):_("",!0)]),u(fe,{modelValue:a(e).reportDate,"onUpdate:modelValue":t[7]||(t[7]=r=>a(e).reportDate=r),name:"reportDate",label:"취재일",disabled:g.value,onChange:R},null,8,["modelValue","disabled"]),u(F,{modelValue:a(e).content,"onUpdate:modelValue":t[8]||(t[8]=r=>a(e).content=r),label:"내용",rows:8,disabled:g.value},null,8,["modelValue","disabled"]),u(a(S),{modelValue:a(e).remark,"onUpdate:modelValue":t[9]||(t[9]=r=>a(e).remark=r),placeholder:"비고",label:"비고",disabled:g.value},null,8,["modelValue","disabled"]),l.mode==="read"?(v(),Y("div",Ie,[s("div",he,[s("div",De,[t[11]||(t[11]=s("span",{class:"truncate"},"작성자",-1)),s("div",Ve,$(a(e).inputerUserId?`${a(e).inputerName}(${a(e).inputerUserId})`:""),1)]),s("div",we,[t[12]||(t[12]=s("span",{class:"truncate"},"작성일시",-1)),s("div",Ne,$(a(f)(a(e).inputDateTime,"YYYY-MM-DD HH:mm:ss")),1)])]),s("div",$e,[s("div",Ye,[t[13]||(t[13]=s("span",{class:"truncate"},"수정자",-1)),s("div",Se,$(a(e).updaterUserId?`${a(e).updaterName}(${a(e).updaterUserId})`:""),1)]),s("div",Ue,[t[14]||(t[14]=s("span",{class:"truncate"},"수정일시",-1)),s("div",Re,$(a(f)(a(e).updateDateTime,"YYYY-MM-DD HH:mm:ss")),1)])]),s("div",Me,[s("div",Oe,[t[15]||(t[15]=s("span",{class:"truncate"},"승인자",-1)),s("div",Ee,$(a(e).approverUserId?`${a(e).approverName}(${a(e).approverUserId})`:""),1)]),s("div",Ae,[t[16]||(t[16]=s("span",{class:"truncate"},"승인일시",-1)),s("div",Te,$(a(f)(a(e).approveDateTime,"YYYY-MM-DD HH:mm:ss")),1)])])])):_("",!0)])}}}),Ge=T({__name:"CoveragePreview",props:{mode:{default:"read"},coveragePlanId:{default:0},isLoading:{type:Boolean,default:!1}},emits:["on-change-state","on-clicked-reject-button"],setup(N,{emit:V}){const n=N,k=V,{fetchCoveragePlan:x}=H(),b=p({coveragePlanId:0,title:"",departmentId:0,departmentName:"",reporter:void 0,reportDate:B().format("YYYY-MM-DD"),articleType:void 0,content:"",remark:"",stateCode:"",stateName:"",rejectionReason:"",approveDateTime:"",inputDateTime:"",inputerUserId:"",inputerName:"",approverId:"",approverUserId:"",approverName:"",updateDateTime:"",updaterUserId:"",updaterId:"",isSensitiveArticle:!1}),f=async()=>{const e=await x(n.coveragePlanId);e.success&&(Object.assign(b.value,e.data),b.value.isSensitiveArticle=e.data.sensitiveArticleYn==="Y")},i=e=>{k("on-change-state",e)};return z(()=>[n.coveragePlanId,n.isLoading],()=>{n.coveragePlanId&&!n.isLoading&&f()}),(e,C)=>(v(),Y("div",null,[e.coveragePlanId&&!e.isLoading?(v(),P(je,{key:0,mode:e.mode,"coverage-plan-meta-data":b.value,onOnChangeState:i,onOnClickedRejectButton:C[0]||(C[0]=g=>e.$emit("on-clicked-reject-button"))},null,8,["mode","coverage-plan-meta-data"])):(v(),P(be,{key:1}))]))}}),Le={class:"flex flex-col h-full space-y-2"},Be={class:"flex items-center flex-wrap gap-1.5"},ze={class:"flex h-full items-center space-x-2 overflow-hidden"},He={class:"w-2/3 flex flex-col h-full"},Fe={class:"w-1/3 flex flex-col h-full"},Ke={class:"sm:flex sm:flex-row-reverse pt-4 pb-2"},qe={class:"space-x-3 flex items-center"},Je=T({__name:"CoveragePlanSearchModal",props:{mode:{default:"create"},coverageScheduleId:{default:0}},emits:["close","on-selected"],setup(N,{emit:V}){const n=V,{fetchCoveragePlans:k}=H(),x=p([B().subtract(1,"day").format("YYYY-MM-DD"),B().format("YYYY-MM-DD")]),b=p(),f=p(""),i=p(1),e=p(oe.sm),C=p({isShow:!0,page:1,totalElements:0,totalPages:1,numberOfElements:0,size:e.value}),g=p([]),D=p([]),y=p(!1),o=p(),I=p(0),R=p(0),M=()=>{n("close")},l=async()=>{var c;try{y.value=!0;const d={searchValue:f.value,startDate:x.value[0],endDate:x.value[1],reporterId:(c=b.value)==null?void 0:c.id,statusCode:w.APPROVE.id,departmentIds:D.value.map(O=>O.departmentId),page:i.value-1,size:e.value},m=await k(d);m.success&&(g.value=m.data.content,C.value={isShow:!0,page:i.value,totalPages:m.data.totalPages,totalElements:m.data.totalElements,numberOfElements:m.data.numberOfElements,size:m.data.size})}finally{y.value=!1}},t=c=>{x.value=c,l()},h=()=>{i.value=1,I.value=0,o.value=null,l()},r=c=>{i.value=c,l()},q=c=>{var d,m,O;I.value=(d=c[0])==null?void 0:d.rowIndex,o.value=(m=c[0])==null?void 0:m.data,R.value=(O=c[0])==null?void 0:O.data.coveragePlanId},J=c=>{o.value=c.data,R.value=c.data.coveragePlanId,n("on-selected",o.value)},W=()=>{n("on-selected",o.value)},X=c=>{D.value=c,l()};return K(async()=>{await l()}),(c,d)=>(v(),P(de,{"modal-class":"w-3/5","content-class":"h-[65vh]",onClose:M},{title:E(()=>d[4]||(d[4]=[L(" 취재계획 ")])),content:E(()=>[s("div",Le,[s("div",Be,[u(le,{modelValue:x.value,"onUpdate:modelValue":d[0]||(d[0]=m=>x.value=m),onChange:t},null,8,["modelValue"]),u(ce,{"selected-departments":D.value,"onUpdate:selectedDepartments":d[1]||(d[1]=m=>D.value=m),"use-multi-select":!1,onOnSelectedDepartment:X},null,8,["selected-departments"]),u(a(ue),{modelValue:b.value,"onUpdate:modelValue":d[2]||(d[2]=m=>b.value=m),class:"w-32","is-all-option":!0,"label-name":"기획자 전체","preselect-first":!0,onOnSelected:h},null,8,["modelValue"]),u(S,{modelValue:f.value,"onUpdate:modelValue":d[3]||(d[3]=m=>f.value=m),placeholder:"검색어",width:"w-72",onKeyup:re(h,["enter"])},null,8,["modelValue"]),u(U,{icon:"magnifying-glass",onClick:h})]),s("div",ze,[s("div",He,[u(ne,{"page-info":C.value,"row-data":g.value,"selected-row-index":I.value,mode:c.mode,onSelectedRows:q,onDoubleClickedRow:J,onOnChangePage:r},null,8,["page-info","row-data","selected-row-index","mode"])]),s("div",Fe,[u(Ge,{"coverage-plan-id":R.value,"is-loading":y.value,mode:"readOnly",class:"flex flex-col h-full overflow-auto bg-white dark:bg-dark border dark:border-dark-border rounded-md p-4"},null,8,["coverage-plan-id","is-loading"])])]),s("div",Ke,[s("div",qe,[u(U,{type:"secondary",class:"dark:bg-dark-secondary dark:text-white dark:hover:bg-gray-600",onClick:M},{default:E(()=>d[5]||(d[5]=[L("취소")])),_:1}),u(U,{disabled:!o.value,onClick:W},{default:E(()=>d[6]||(d[6]=[L(" 선택 ")])),_:1},8,["disabled"])])])]),d[7]||(d[7]=s("div",null,null,-1))]),_:1}))}}),We={class:"space-y-1"},Xe={class:"flex w-full space-x-1"},ba=T({__name:"CoveragePlanSearch",props:{disabled:{type:Boolean,default:!1},coveragePlanId:{default:0}},emits:["on-selected","on-canceled"],setup(N,{emit:V}){const n=N,k=V,{fetchCoveragePlan:x}=H(),b=p(!1),f=p(),i=p(""),e=async(y=0)=>{const o=await x(y||n.coveragePlanId);o.success&&(f.value=o.data,i.value=o.data.title,k("on-selected",f.value))},C=()=>{f.value=null,i.value=""},g=async y=>{await e(y.coveragePlanId),k("on-selected",f.value),b.value=!1},D=()=>{C(),k("on-canceled")};return z(()=>n.coveragePlanId,()=>{n.coveragePlanId?e():C()},{immediate:!0}),(y,o)=>(v(),Y("div",We,[o[3]||(o[3]=s("span",{class:"flex sm:text-xs text-xs font-medium text-gray-700 dark:text-white"},"취재계획",-1)),s("div",Xe,[u(a(S),{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=I=>i.value=I),placeholder:"취재계획",disabled:"",class:"flex-1"},null,8,["modelValue"]),!y.disabled&&!i.value?(v(),P(U,{key:0,icon:"magnifying-glass",onClick:o[1]||(o[1]=I=>b.value=!0)})):_("",!0),!y.disabled&&i.value?(v(),P(U,{key:1,type:"secondary",icon:"trash",onClick:D})):_("",!0)]),b.value===!0?(v(),P(Je,{key:0,mode:"read",onOnSelected:g,onClose:o[2]||(o[2]=I=>b.value=!1)})):_("",!0)]))}});export{Ge as _,je as a,ba as b};
