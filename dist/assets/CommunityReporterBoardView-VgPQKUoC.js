import{g as Y,M as de}from"./splitpanes.es-dEoJOrhT.js";import{d as S,a5 as B,bS as ce,a as i,c as _,G as c,al as ue,ai as me,Y as e,a0 as h,aj as V,j as u,bW as pe,l as P,Q as E,F as O,w as C,h as $,an as A,K as D,ao as fe,C as z,ab as he,k as g,o as G,aD as ye,ad as ge,V as _e,bY as H,t as ve,ez as we,bQ as xe,ae as be,ah as Ce,ap as De,R as W}from"./index-eLyz9_Ts.js";import{_ as ke}from"./PaginationSecondary.vue_vue_type_script_setup_true_lang-5bABwX9_.js";import{_ as $e,c as Se,a as Ie}from"./ReporterBoardComment.vue_vue_type_script_setup_true_lang-Gytzq9bJ.js";import{P as Re}from"./PublicIcon-IoLQp8uU.js";import{_ as Q}from"./VDCEditor.vue_vue_type_script_setup_true_lang-IhnNo6sk.js";import{_ as Be}from"./FileDropzone.vue_vue_type_script_setup_true_lang-SVeHifZw.js";import{u as Le}from"./file-Gx0JxWZZ.js";import{c as Ne}from"./comment-helper-7aBDqVRT.js";import{_ as Oe}from"./PostModal.vue_vue_type_script_setup_true_lang-ywCBp_X3.js";import{_ as Pe}from"./PrintModal.vue_vue_type_script_setup_true_lang-ZsBYknDF.js";import{u as Fe}from"./use-dynamic-height-sJY6bk6Z.js";import"./GSingleSelect-7u8H0FdH.js";import"./vue-multiselect-Yz8FsF-E.js";import"./use-model-wrapper-XtiLc3Xd.js";import"./ContentHeaderButtons.vue_vue_type_script_setup_true_lang-Db8CUXqr.js";import"./ConfirmModal.vue_vue_type_script_setup_true_lang-k_ZxaDhN.js";import"./ModalButton.vue_vue_type_script_setup_true_lang-WIw8hxFk.js";import"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";import"./use-date-GeeGTbYh.js";import"./Comment.vue_vue_type_script_setup_true_lang-4b5dYawy.js";import"./comment.helper-kn9hfxav.js";import"./vue.runtime.esm-bundler-3P3R-Xon.js";import"./XIcon-gk7lh7BZ.js";import"./file-division-code-x51qUgaH.js";import"./FileListView.vue_vue_type_script_setup_true_lang-A40KFqZZ.js";import"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";import"./GVideoPlayer-1SUF8s3O.js";import"./main-sHItgwS4.js";import"./vue-resizable.umd.min-blE9hPz6.js";const Me={class:"h-[95%]"},Ae=S({__name:"ReporterBoardList",props:{isLoading:{type:Boolean},pageInfo:{},selectedRowIndex:{},rowData:{}},emits:["selected-rows","on-change-page","select-size"],setup(v,{emit:p}){const n=p,{t:s}=B(),f=[{headerName:"",field:"duplicateUserCode",maxWidth:30,valueGetter:"node.rowIndex",cellRenderer:a=>`<div style="background-color: ${a.data.duplicateUserCode||""}" class="w-[30px] h-[35px]">
      </div>`,cellStyle:{textAlign:"center"}},{headerName:"NO",field:"NO",maxWidth:45,valueGetter:"node.rowIndex",cellRenderer:a=>{const y=a.api.getDisplayedRowCount();return ce(a,y)},cellStyle:{textAlign:"center"}},{headerName:s("Community.제목"),field:"title",cellStyle:{textAlign:"left"}},{headerName:s("Community.첨부파일"),field:"attachment",maxWidth:80,cellStyle:{textAlign:"center"}},{headerName:s("Community.조회"),field:"check",maxWidth:80,cellStyle:{textAlign:"center"}},{headerName:s("Community.전송일시"),field:"createdDate",maxWidth:100,cellStyle:{textAlign:"center"}}],l=a=>{n("selected-rows",a)},r=a=>{n("on-change-page",a)},d=a=>{n("select-size",a)};return(a,y)=>(i(),_("div",Me,[c(ue,{intent:"purple","column-defs":f,"row-data":a.rowData,"selected-row-index":a.selectedRowIndex,"is-loading":"","row-height":25,"page-info":a.pageInfo,"row-selection":"multiple",onSelectedRows:l},null,8,["row-data","selected-row-index","page-info"]),c(ke,{"current-page":a.pageInfo.page,"page-info":a.pageInfo,onOnChangePage:r,onSelectSize:d},null,8,["current-page","page-info"])]))}}),Ee={class:"h-full text-sm flex flex-col"},ze={class:"px-2 py-4 space-y-3"},Te={class:"min-h-[26px] dark:bg-dark bg-primary-gray-80 py-1 px-3 border border-primary-gray-30 text-primary-black-100 font-roboto font-medium text-xs dark:text-white"},Ue={class:"flex flex-wrap gap-x-10 text-xs gap-y-3 text-primary-gray-40 dark:text-white"},je={class:"flex items-center gap-2"},Ye={class:"flex items-center gap-2"},Ve={class:"dark:bg-dark-secondary bg-primary-gray-80 p-2 border border-primary-gray-20 rounded-[3px] flex-grow overflow-y-hidden"},He={class:"dark:bg-dark bg-white p-2 rounded-[3px] h-full"},We=S({__name:"ReporterBoardDetail",props:{dataDetail:{}},setup(v){const{t:p}=B();return(n,s)=>{var l,r,d;const f=me("tooltip");return i(),_("div",Ee,[e("div",ze,[e("div",Te,h(((l=n.dataDetail)==null?void 0:l.titl)||""),1),e("div",Ue,[e("div",je,[V(c(pe,null,null,512),[[f,u(p)("Community.작성시간")]]),e("p",null,h((r=n.dataDetail)==null?void 0:r.inputDtm),1)]),e("div",Ye,[V(c(Re,null,null,512),[[f,u(p)("Community.공개여부")]]),s[0]||(s[0]=e("p",null,"공개",-1))])])]),e("div",Ve,[e("div",He,[c(Q,{content:(d=n.dataDetail)==null?void 0:d.ctt,disabled:"","editor-class":"vdc-readonly"},null,8,["content"])])])])}}}),Ge={class:"w-2/4 flex justify-between text-xs pt-2 pb-1 w-full px-1"},Qe={class:"text-black dark:text-white"},Ke=S({__name:"ReporterBoardAttachedFile",props:{dataDetail:{}},setup(v){const p=v,{t:n}=B(),{fileDownload:s,downloadAllFiles:f}=Le(),l=P(()=>{var a;return(a=p.dataDetail)==null?void 0:a.attcFiles.map(y=>({...y,name:y.fileNm,fileId:y.id}))}),r=async a=>{await s(a.file)},d=async()=>{var a;(a=l.value)!=null&&a.length&&await f(l.value)};return(a,y)=>{var b;return i(),_(O,null,[e("div",Ge,[e("p",Qe,h(u(n)("Community.등록된 파일")),1),e("p",{class:"text-primary-blue-100 text-[10px] cursor-pointer hover:no-underline underline ml-auto",onClick:d},h(u(n)("Community.전체 다운로드")),1)]),e("div",{class:E(["h-full",{"flex items-center justify-center":!((b=l.value)!=null&&b.length)}])},[c(Be,{"file-data":l.value,mode:"read","file-list-custom-class":"!p-0 text-black","is-read-only":"","is-show-file":"",onOnDownloadFile:r},null,8,["file-data"])],2)],64)}}}),qe={class:"w-full h-full bg-white dark:bg-dark-grid"},Je=S({__name:"ReporterBoardTabPanel",props:{dataDetail:{},isLoadingComments:{type:Boolean},isShowDetail:{type:Boolean,default:!0},isShowAttachedFile:{type:Boolean,default:!0},isShowComment:{type:Boolean,default:!0},isShowVote:{type:Boolean,default:!0},commentList:{},currentDetailId:{}},emits:["on-refresh"],setup(v,{emit:p}){const n=p,s=v,{t:f}=B(),l=P(()=>[{id:1,name:f("Community.상세정보"),isShow:s.isShowDetail},{id:2,name:f("Community.첨부파일"),isShow:s.isShowAttachedFile},{id:3,name:f("Community.코멘트"),isShow:s.isShowComment}]);return(r,d)=>(i(),_("div",qe,[c(fe,{tabs:l.value,"is-plain-text-mode":!0,"is-compact-mode":!0,class:"!p-0"},{default:C(()=>[r.isShowDetail?(i(),$(u(A),{key:0,unmount:!1,class:"overflow-y-auto flex flex-col h-full"},{default:C(()=>[c(We,{"data-detail":r.dataDetail},null,8,["data-detail"])]),_:1})):D("",!0),r.isShowAttachedFile?(i(),$(u(A),{key:1,unmount:!1,class:"overflow-y-auto flex flex-col h-full"},{default:C(()=>[c(Ke,{"data-detail":r.dataDetail},null,8,["data-detail"])]),_:1})):D("",!0),r.isShowComment?(i(),$(u(A),{key:2,unmount:!1,class:"overflow-y-auto h-full pt-2"},{default:C(()=>{var a;return[c($e,{"comment-list":r.commentList,"current-id":r.currentDetailId,"is-loading-comments":r.isLoadingComments,"comment-count":(a=r.dataDetail)==null?void 0:a.cmntCnt,onOnRefresh:d[0]||(d[0]=y=>n("on-refresh"))},null,8,["comment-list","current-id","is-loading-comments","comment-count"])]}),_:1})):D("",!0)]),_:1},8,["tabs"])]))}}),Xe={class:"space-y-3"},Ze={class:"flex justify-between items-center gap-4"},et={class:"text-xs"},tt={key:0,class:"flex items-start gap-3 px-2"},at={class:"inline-block rounded-sm min-w-max px-1"},st=["innerHTML"],K=S({__name:"ReporterBoardChildComments",props:{child:{},userList:{},userMngId:{}},setup(v){const p=v,n=P(()=>p.child.childComments.length);return(s,f)=>(i(),_("div",Xe,[e("div",Ze,[e("span",null,h((s.child.inputUserName||"")+" / "+(s.child.inputUserDeptName||"")),1),e("span",et,h(s.child.inputDateTime),1)]),s.child.isEditing?D("",!0):(i(),_("div",tt,[e("b",at,"@"+h(s.child.inputUserName||""),1),e("div",{class:"mr-12",innerHTML:s.child.content},null,8,st)])),n.value?(i(!0),_(O,{key:1},z(s.child.childComments,l=>(i(),$(K,{key:l.id,"user-mng-id":s.userMngId,child:l,"user-list":s.userList},null,8,["user-mng-id","child","user-list"]))),128)):D("",!0)]))}}),ot={class:"space-y-4 text-sm p-4 dark:text-white"},nt={class:"space-y-1 p-3 border border-primary-gray-surface"},lt={class:"text-sm"},rt={class:"space-y-2"},it={class:"w-full text-xs"},dt={class:"w-[70px] border border-primary-gray-surface text-center p-2"},ct={class:"border border-primary-gray-surface p-2 px-4"},ut={class:"w-[70px] border border-primary-gray-surface text-center p-2"},mt={class:"border border-primary-gray-surface p-2 px-4"},pt={class:"space-y-1 p-3 border border-primary-gray-surface"},ft={class:"text-sm"},ht={class:"space-y-4"},yt={class:"space-y-2 p-3 border border-primary-gray-surface"},gt={class:"text-sm"},_t={class:"space-y-4"},vt={class:"flex justify-between items-center gap-4"},wt={class:"text-[11px]"},xt={class:"flex justify-between gap-5"},bt=["innerHTML"],Ct={key:0,class:"ml-10 space-y-3"},Dt=S({__name:"ReporterBoardPrintTemplate",props:{commentList:{},dataDetail:{}},setup(v){const p=v,{t:n}=B(),{userMngId:s}=he(),f=g(),l=g([]),r=P(()=>Ne(p.commentList)||0);return G(()=>{var d;l.value=Se(p.commentList??[],((d=p.dataDetail)==null?void 0:d.rptrBbId)??0)}),(d,a)=>{var y,b,m;return i(),_("div",ot,[e("div",nt,[e("p",lt,[e("b",null,h(u(n)("Community.기본정보")),1)]),e("div",rt,[e("table",it,[e("tbody",null,[e("tr",null,[e("td",dt,h(u(n)("Community.제목")),1),e("td",ct,h(((y=d.dataDetail)==null?void 0:y.titl)||""),1)]),e("tr",null,[e("td",ut,h(u(n)("Community.작성일시")),1),e("td",mt,h((b=d.dataDetail)==null?void 0:b.inputDtm),1)])])])])]),e("div",pt,[e("p",ft,[e("b",null,h(u(n)("Community.내용")),1)]),e("div",ht,[c(Q,{content:(m=d.dataDetail)==null?void 0:m.ctt,disabled:"","editor-class":"vdc-readonly","custom-class":"font-roboto"},null,8,["content"])])]),e("div",yt,[e("p",gt,[e("b",null,h(u(n)("Community.댓글")+" ("+r.value+")"),1)]),e("div",_t,[(i(!0),_(O,null,z(l.value,w=>(i(),_("div",{key:w.id,class:"space-y-4 text-xs"},[e("div",vt,[e("span",null,h((w.inputUserName||"")+" / "+(w.inputUserDeptName||"")),1),e("span",wt,h(w.inputDateTime),1)]),e("div",xt,[e("div",{innerHTML:w.content},null,8,bt)]),w.childComments.length?(i(),_("div",Ct,[(i(!0),_(O,null,z(w.childComments,R=>(i(),$(K,{key:R.id,"user-mng-id":u(s),child:R,"user-list":f.value},null,8,["user-mng-id","child","user-list"]))),128))])):D("",!0)]))),128))])])])}}}),kt={class:"dark:text-white"},$t={class:"flex flex-grow h-full overflow-y-hidden mr-[-8px]"},sa=S({__name:"CommunityReporterBoardView",setup(v){const{moveEditCommunityReporterBoard:p,moveCreateCommunityReporterBoard:n}=De(),s=ye(),{dynamicHeightVh:f}=Fe("h-[86.5vh]","h-[86.5vh]"),l=g([]),r=g(),d=g(!0),a=g(!1),y=g(!1),b=g(0),m=g(null),w=g(ge.md),R=g([]),I=g(),F=g(!1),M=g(!1),T=g({page:1,totalElements:0,totalPages:1,numberOfElements:0,size:w.value}),U=()=>({delYn:"N",startDate:we,endDate:xe,size:w.value,page:0,sort:"rptrBbId,desc"}),x=_e(U()),q=()=>{m.value=null,I.value=void 0,l.value=[]},k=async()=>{q(),a.value=!0;try{const t=await s.community.reporterBoard.findAll(x);t!=null&&t.success&&(R.value=t.data.content.map(o=>{const L=o.cmntCnt>0?`[${o.cmntCnt}]`:"",N=`${o.titl} ${L}`;return{id:o.rptrBbId,attachment:o.attcFileCnt?String(o.attcFileCnt):"-",check:o.hits,createdDate:o.inputDtm?be(o.inputDtm).format("YYYY-MM-DD"):"-",title:N,reporter:o.cryptInputrId?o.cryptInputrId:"-",duplicateUserCode:o.duplicateUserCode}}),T.value={page:x.page??0,totalPages:t.data.totalPages,totalElements:t.data.totalElements,numberOfElements:t.data.numberOfElements,size:t.data.size})}catch(t){console.log("getDataList error",t)}a.value=!1},J=async t=>{if(t)try{const o=await s.community.reporterBoard.findOne(t);o.success&&(I.value=o.data)}catch(o){console.log("getDataDetail error",o)}},X=async t=>{x.page=t,await k()},Z=async t=>{x.page=0,x.size=Number(t),await k()},ee=t=>{var o;t.length!==0&&(b.value=((o=t[0])==null?void 0:o.rowIndex)||0,m.value=t[0].data.id,d.value=!1)},te=()=>{n()},ae=()=>{m.value&&p(m.value)},se=()=>{m.value&&(M.value=!0)},oe=()=>{m.value&&(F.value=!0)},ne=async()=>{if(!m.value)return;const t=await s.community.reporterBoard.remove(m.value);t!=null&&t.success?(window.Notify.success({message:Ce.communityReporterBoard.delete}),await k()):window.Notify.error({message:t.msg})},le=async t=>{x.delYn=t.delYn,x.startDate=t.startDate,x.endDate=t.endDate,await k()},j=async()=>{if(m.value){y.value=!0;try{const t=await s.community.reporterBoard.getComments(m.value);t.success&&(l.value=t.data)}catch(t){console.log("Fail to get comment",t)}finally{y.value=!1}}},re=()=>{var t;Object.assign(x,U()),(t=r.value)==null||t.resetFields()};return H(`${W.CommunityReporterBoard}Create`,async()=>{re(),await k()}),H(`${W.CommunityReporterBoard}Edit`,async()=>{await k()}),G(async()=>{await k()}),ve(()=>m.value,async t=>{t&&(await J(t),await j())}),(t,o)=>{var L,N;return i(),_("div",kt,[c(Ie,{ref_key:"headerRef",ref:r,"current-id":m.value,onOnSearch:le,onOnCreate:te,onOnEdit:ae,onOnDelete:ne,onOnPrint:se,onOnPost:oe},null,8,["current-id"]),e("div",$t,[c(u(de),{class:"default-theme primary-theme"},{default:C(()=>[c(u(Y),{class:E([u(f),"overflow-auto dark:!bg-dark-secondary pt-2 pr-2"])},{default:C(()=>[c(Ae,{"is-deselected-all":d.value&&!m.value,"is-loading":a.value,"row-data":R.value,"page-info":T.value,"selected-row-index":b.value,onSelectedRows:ee,onOnChangePage:X,onSelectSize:Z},null,8,["is-deselected-all","is-loading","row-data","page-info","selected-row-index"])]),_:1},8,["class"]),c(u(Y),{class:E([u(f),"overflow-visible dark:!bg-dark-secondary p-2 border-t-0 border-primary-gray-999 rounded-[3px] ml-[-2px]"])},{default:C(()=>[c(Je,{"is-loading-comments":y.value,"current-detail-id":m.value,"comment-list":l.value,"data-detail":I.value,onOnRefresh:j},null,8,["is-loading-comments","current-detail-id","comment-list","data-detail"])]),_:1},8,["class"])]),_:1})]),F.value?(i(),$(Oe,{key:0,title:(L=I.value)==null?void 0:L.titl,content:(N=I.value)==null?void 0:N.ctt,onOnClose:o[0]||(o[0]=ie=>F.value=!1)},null,8,["title","content"])):D("",!0),M.value?(i(),$(Pe,{key:1,onOnClose:o[1]||(o[1]=ie=>M.value=!1)},{default:C(()=>[c(Dt,{"comment-list":l.value,"data-detail":I.value},null,8,["comment-list","data-detail"])]),_:1})):D("",!0)])}}});export{sa as default};
