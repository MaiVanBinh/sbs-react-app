import{d as W,a as G,h as D,al as oe,am as te,ew as re,aO as ae,aD as B,a5 as T,aa as le,ab as ne,k as m,o as P,ai as F,w as R,j as u,a0 as U,Y as t,G as p,F as J,ak as Q,aj as C,c as Y,C as X,a2 as I,a3 as Z,l as K,a1 as ee,K as O,ah as z,e as ce,ad as de,L as ue,aG as ie,eK as H}from"./index-eLyz9_Ts.js";import{u as pe}from"./group-jQnorhMh.js";import{r as me}from"./use-render-component-K20sHqiA.js";import{G as fe}from"./GSingleSelect-7u8H0FdH.js";import"./vue-multiselect-Yz8FsF-E.js";import"./use-model-wrapper-XtiLc3Xd.js";const he=W({__name:"GroupList",props:{isLoading:{type:Boolean},rowData:{},pageInfo:{}},emits:["selected-rows","double-clicked-row","on-change-page","on-toggle-use"],setup(k,{emit:c}){const l=c,x=a=>{const f=document.createElement("div");f.className="h-full";const o={onToggle:v=>{l("on-toggle-use",{group:a.data,useYn:v})},modelValue:a.data.useYn==="Y"};return me(re,o,f)},w=[{headerName:"순번",filter:!1,minWidth:60,maxWidth:120,valueGetter:"node.rowIndex",cellRenderer:a=>te(a)},{headerName:"그룹명",field:"groupName",filter:!1,minWidth:160},{headerName:"설명",field:"memo",filter:!1,minWidth:300},{headerName:"생성자",field:"inputUserName",filter:!1,minWidth:160,cellClass:""},{headerName:"사용여부",field:"useYn",filter:!1,maxWidth:150,cellRenderer:a=>x(a)}],N=a=>{l("selected-rows",a)},M=a=>{l("double-clicked-row",a)},S=a=>{l("on-change-page",a)};return(a,f)=>(G(),D(oe,{class:"w-full h-full flex flex-col","column-defs":w,"row-data":a.rowData,"is-loading":a.isLoading,filter:!1,sortable:!1,"page-info":a.pageInfo,"suppress-movable":!1,"row-selection":"single",onSelectedRows:N,onDoubleClickedRow:M,onOnChangePage:S},null,8,["row-data","is-loading","page-info"]))}}),se=ae("group-user",{actions:{async fetchGroupUsers(k,c){try{return await B().group.groupUser.findAll(k,c)}catch(l){console.error("store: deleteGroupUsers() Error",l)}},async createGroupUsers(k,c){try{return await B().group.groupUser.create(k,c)}catch(l){console.error("store: deleteGroupUsers() Error",l)}},async deleteGroupUsers(k,c){try{return await B().group.groupUser.delete(k,c)}catch(l){console.error("store: deleteGroupUsers() Error",l)}}}}),ge={class:""},ve={class:"flex flex-col h-full px-10 py-7 space-y-4"},_e={class:"space-x-2"},ke={class:"h-full space-y-2 border dark:border-dark-border dark:text-dark-gray-200 rounded-md shadow overflow-y-auto text-sm"},we={class:"space-x-3 flex justify-end pt-2"},ye=W({__name:"AddGroupUserModal",props:{groupId:{type:Number,default:0},groupUsers:{type:Array,default:()=>[]}},emits:["close"],setup(k,{emit:c}){const{t:l}=T(),x=se(),w=le(),{createGroupUsers:N}=x,{fetchUsers:M}=w,{companyId:S}=ne(),a=k,f=c,o=m([]),v=m(),h=m([]),A=async()=>{const d={userIdList:h.value.map(n=>n.id)};try{(await N(a.groupId,d)).success&&f("close",!0)}catch(n){console.log("error",n)}},b=d=>{const n=h.value.findIndex(_=>_.id===d.id);h.value.splice(n,1),o.value.push(d)},V=d=>{o.value=d.filter(n=>!a.groupUsers.some(_=>_.userId===n.id))},L=async()=>{const d=await M({chDivId:S,useYn:"Y",delYn:"N",size:1e4});d.success&&V(d.data.content)},E=d=>{h.value.push(d);const n=o.value.findIndex(_=>_.id===d.id);o.value.splice(n,1),v.value=null};return P(()=>{L()}),(d,n)=>{const _=F("tooltip");return G(),D(Z,{changed:!1,"dialog-overlay":!1,"modal-class":"w-3/12","content-class":"h-[40vh]",onClose:n[2]||(n[2]=e=>f("close"))},{title:R(()=>[t("span",ge,U(u(l)("Modal.Group.AddGroupUserModal.사용자_추가")),1)]),content:R(()=>[t("div",ve,[p(fe,{modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=e=>v.value=e),name:"userNm",options:o.value,"item-label":"label","track-by":"id","allow-empty":!0,searchable:!0,placeholder:"사용자를 검색하세요.","onSelect:value":E},{option:R(({option:e})=>[t("div",_e,U(`${e==null?void 0:e.userNm}(${e==null?void 0:e.userId})`),1)]),_:1},8,["modelValue","options"]),t("div",ke,[(G(!0),Y(J,null,X(h.value,e=>(G(),Y("div",{key:e.id,class:"grid grid-cols-3 gap-4 items-center border-b dark:border-dark-border px-4 py-2 flex justify-between items-center"},[t("div",null,U(e.userNm),1),t("div",null,U(e==null?void 0:e.userId),1),C(p(Q,{icon:"trash",onClick:g=>b(e)},null,8,["onClick"]),[[_,u(l)("Modal.Group.AddGroupUserModal.삭제")]])]))),128))]),t("div",we,[p(I,{type:"secondary","button-text":u(l)("Modal.Group.AddGroupUserModal.취소"),onClick:n[1]||(n[1]=e=>d.$emit("close"))},null,8,["button-text"]),p(I,{disabled:!h.value.length,"button-text":u(l)("Modal.Group.AddGroupUserModal.추가"),onClick:A},null,8,["disabled","button-text"])])])]),_:1})}}}),Ge={class:""},Ue={class:"flex flex-col h-full px-10 py-7 space-y-6"},xe={class:"flex items-center justify-between"},be={class:"h-full text-sm border dark:border-dark-border rounded-md"},Ce={class:"h-full rounded-t-md h-14 p-4 flex space-x-3 bg-gray-200 dark:bg-dark-secondary dark:text-dark-gray-200 items-center"},Ie={for:""},$e=["checked"],Ne={class:"flex flex-col h-full overflow-auto dark:text-dark-gray-200"},Me={class:"grid grid-cols-4 gap-4 items-center"},Se={class:"text-left"},Ae={for:""},Le=["value","checked","onClick"],De=W({__name:"GroupUserModal",props:{groupId:{}},emits:["close"],setup(k,{emit:c}){const l=k,x=c,{t:w}=T(),N=se(),{fetchGroupUsers:M,deleteGroupUsers:S}=N,a=m(""),f=m(!1),o=m([]),v=m([]),h=m(!1),A=async()=>{const r={size:1e4},s=await M(l.groupId,r);s.success&&(o.value=s.data.content,v.value=s.data.content)},b=K(()=>!!o.value.filter(s=>s.checked).length),V=K(()=>o.value.some(r=>r.checked)?"선택한 사용자":"전체 사용자"),L=K(()=>{let r=0;return o.value.some(s=>s.checked)?r=o.value.filter(i=>i.checked).length:o.value.every(s=>!s.checked)&&(r=o.value.length),r}),E=r=>{const s=r.target.value;v.value=o.value.filter(i=>{if(i.userLoginId.includes(s)||i.userName.includes(s))return i})},d=r=>{o.value.forEach(s=>{s.checked=r.target.checked}),h.value=r.target.checked},n=(r,s)=>{s.checked=r.target.checked,o.value.some(i=>!i.checked)?h.value=!1:o.value.every(i=>i.checked)&&(h.value=!0)},_=async r=>{const s={userIdList:r};try{(await S(l.groupId,s)).success&&(window.Notify.success({message:z.groupUser.delete}),await A(),h.value=!1)}catch(i){console.error("error",i)}},e=r=>{r.checked=!0,_([r.userId])},g=()=>{const r=o.value.filter(s=>s.checked).map(s=>s.userId);_(r)},$=()=>{x("close")},j=r=>{r&&(window.Notify.success({message:z.groupUser.create}),A()),f.value=!1};return P(()=>{A()}),(r,s)=>{const i=F("tooltip");return G(),D(Z,{changed:!1,"dialog-overlay":!1,"content-class":"h-[45vh]",onClose:$},{title:R(()=>[t("span",Ge,U(u(w)("Modal.Group.GroupUserModal.그룹_사용자_설정")),1)]),content:R(()=>[t("div",Ue,[t("div",xe,[p(ee,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=y=>a.value=y),name:"searchInput",width:"w-96",placeholder:u(w)("Modal.Group.GroupUserModal.사용자_이름_또는_아이디를_입력하세요"),onKeyup:E},null,8,["modelValue","placeholder"]),C(p(I,{icon:"plus",onClick:s[1]||(s[1]=y=>f.value=!0)},null,512),[[i,u(w)("Modal.Group.GroupUserModal.사용자_추가")]])]),t("div",be,[t("div",Ce,[t("label",Ie,[t("input",{type:"checkbox",class:"inline-block",name:"allCheck",checked:h.value,onClick:d},null,8,$e)]),t("div",null,U(V.value)+" "+U(L.value)+"명",1),b.value?C((G(),D(I,{key:0,icon:"trash",onClick:s[2]||(s[2]=y=>g())},null,512)),[[i,u(w)("Modal.Group.GroupUserModal.삭제")]]):O("",!0)]),t("div",Ne,[(G(!0),Y(J,null,X(v.value,y=>(G(),Y("div",{key:y.userId,class:"border-b dark:border-dark-border px-4 py-2 items-center"},[t("div",Me,[t("div",Se,[t("label",Ae,[t("input",{type:"checkbox",class:"inline-block",name:"userCheck",value:y.userId,checked:y.checked,onClick:q=>n(q,y)},null,8,Le)])]),t("div",null,U(y.userName),1),t("div",null,U(y.userLoginId),1),C(p(Q,{icon:"trash","icon-size":"w-5 h-5",onClick:q=>e(y)},null,8,["onClick"]),[[i,u(w)("Modal.Group.GroupUserModal.삭제")]])])]))),128))])])]),f.value?(G(),D(ye,{key:0,"group-id":l.groupId,"group-users":o.value,onClose:j},null,8,["group-id","group-users"])):O("",!0)]),_:1})}}}),Ve={class:"h-full"},Ee={class:"flex justify-between"},Re={class:"flex items-center space-x-2"},Ye={class:"space-x-2 w-[210px]"},je={class:"text-xl dark:text-dark-gray-200"},ze={class:"text-xl text-gray-500"},We={class:"space-x-1.5"},Be={class:"flex flex-col h-full"},He=W({__name:"AdminUserGroupView",setup(k){const{t:c}=T(),l=ce(),x=pe(),{fetchGroups:w,deleteGroup:N,updateGroup:M}=x,S=m(!1),a=m(!1),f=m(""),o=m(),v=m([]),h=m(de.sm),A=m({isShow:!1,page:1,totalElements:1,totalPages:1,numberOfElements:1,size:h.value}),b=async()=>{try{const e={groupName:f.value},g=await w(e);g.success&&(v.value=g.data.content)}catch(e){console.error("AdminUserGroupView: getGroups() Error",e)}},V=()=>{l.push({name:H.CreateGroup})},L=()=>{l.push({name:H.EditGroup,params:{id:o.value.groupId}})},E=async()=>{try{(await N(o.value.groupId)).success&&(window.Notify.success({message:z.group.delete}),await b())}catch(e){console.error("AdminUseGroupView onDelete() Error",e)}},d=e=>{o.value=e[0].data},n=e=>{o.value=e.data,L()},_=async e=>{const g={isUsed:e.useYn};(await M(e.group.groupId,g)).success&&(window.Notify.success({message:z.group.edit}),await b())};return P(()=>{b()}),(e,g)=>{var j,r;const $=F("tooltip");return G(),Y("div",Ve,[t("div",Ee,[t("div",Re,[t("div",Ye,[t("span",je,U(u(c)("Group.그룹")),1),t("span",ze,U(u(c)("Group.그룹수",{groups:v.value.length})),1)]),p(ee,{modelValue:f.value,"onUpdate:modelValue":g[0]||(g[0]=s=>f.value=s),width:"w-96",placeholder:u(c)("Group.그룹명으로_검색하세요"),onKeyup:ue(b,["enter"])},null,8,["modelValue","placeholder"]),p(I,{icon:"magnifying-glass",onClick:b})]),t("div",We,[C(p(I,{icon:"arrow-path",onClick:b},null,512),[[$,u(c)("Group.새로고침")]]),C(p(I,{icon:"plus",onClick:V},null,512),[[$,u(c)("Group.추가")]]),C(p(I,{icon:"pencil",disabled:!o.value,onClick:L},null,8,["disabled"]),[[$,u(c)("Group.수정")]]),C(p(I,{icon:"users",disabled:!o.value,onClick:g[1]||(g[1]=s=>a.value=!0)},null,8,["disabled"]),[[$,u(c)("Group.그룹_사용자_설정")]]),C(p(ie,{disabled:!o.value,title:(j=o.value)==null?void 0:j.groupName,onOnConfirm:E},null,8,["disabled","title"]),[[$,u(c)("Group.삭제")]])])]),t("div",Be,[p(he,{"is-loading":S.value,"row-data":v.value,"page-info":A.value,onSelectedRows:d,onDoubleClickedRow:n,onOnToggleUse:_},null,8,["is-loading","row-data","page-info"])]),a.value?(G(),D(De,{key:0,"group-id":(r=o.value)==null?void 0:r.groupId,onClose:g[2]||(g[2]=s=>a.value=!1)},null,8,["group-id"])):O("",!0)])}}});export{He as default};
