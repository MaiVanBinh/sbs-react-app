import{d as F,e as M,a5 as H,k,V as P,W,o as K,ai as Y,a as n,c as l,Y as d,a0 as C,j as a,G as p,a1 as N,aj as y,a2 as L,K as v,F as R,C as V,h as z,eL as J,ew as Q,ah as I}from"./index-eLyz9_Ts.js";import{u as X}from"./app-auth-7aW1ROCy.js";import{_ as Z}from"./PageLoader.vue_vue_type_script_setup_true_lang-ZvbvX14z.js";import{u as ee}from"./group-jQnorhMh.js";import{A as u}from"./app-authority-code-Q9MU7mjP.js";const se={class:"h-full"},oe={class:"space-x-10 flex justify-between items-center"},re={class:"flex-1 flex items-center space-x-10"},te={class:"text-xl text-gray-500 dark:text-dark-gray-200"},ae={class:"flex-1 flex space-x-5"},ie={class:"flex space-x-1.5"},ne={key:0},de={key:1,class:"overflow-auto grid grid-rows-2 grid-flow-col gap-4 dark:text-dark-gray-200"},ce={class:"border-b dark:border-dark-border p-3 text-center mb-2"},le={class:"space-x-1 flex items-center"},ge=F({__name:"AdminUserGroupCreate",setup(ue){const U=M(),{t:m}=H(),G=X(),D=ee(),{createGroup:S}=D,{fetchAppAuth:T}=G,f=k(!1),h=P({groupName:""}),B={groupName:{required:!0,message:"그룹명은 필수 입력 값입니다."}},{pass:A,errorFields:b}=W(h,B),_=k(),g=k([]),O=(s,r)=>{let e="";switch(s.groupId){case 2:e=u.ARTICLE_READ.code;break;case 3:e=u.CUESHEET_READ.code;break;case 5:e=u.CUESHEET_TEMPLATE_READ.code;break;case 6:e=u.REPORT_READ.code;break;case 7:e=u.MONITORING_READ.code;break;case 8:e=u.BOARD_READ.code;break;case 9:e=u.SCROLLNEWS_READ.code;break}if(e){if(s.authorityCode===e)s.isChecked||r.authList.map(o=>({...o,isChecked:!1}));else if(s.isChecked){const o=r.authList.find(t=>t.authorityCode===e);o.isChecked||(o.isChecked=!0)}}},$=async()=>{try{f.value=!0;const s=await T();s.success&&s.data.applicationAuthorityList.reduce((e,o)=>{const{groupId:t}=o;return e[t-1]?e[t-1].push(o):e[t-1]=[o],e},[]).forEach(e=>{g.value.push({name:e[0].groupName,groupId:e[0].groupId,authList:e.map(o=>({...o,isChecked:!1}))})})}catch(s){console.error("getAppAuth Error",s)}finally{f.value=!1}},x=()=>{U.go(-1)},j=async()=>{if(!A.value){window.Notify.error({message:I.common.required});return}try{const s=[];g.value.forEach(o=>{o.authList.forEach(t=>{t.isChecked&&s.push(t.authorityId)})});const r={groupName:h.groupName,description:_.value,appAuthorityList:s};(await S(r)).success&&(window.Notify.success({message:I.group.create}),x())}catch(s){console.error("onCreateGroup() Error",s)}},q=(s,r)=>{O(s,r)};return K(()=>{$()}),(s,r)=>{var o,t,E;const e=Y("tooltip");return n(),l("div",se,[d("div",oe,[d("div",re,[d("span",te,C(a(m)("UserGroupCreate.그룹_생성")),1),d("div",ae,[p(N,{modelValue:h.groupName,"onUpdate:modelValue":r[0]||(r[0]=i=>h.groupName=i),name:"groupName",required:"",width:"w-80","error-msg":(t=(o=a(b))==null?void 0:o.groupName)!=null&&t.length?(E=a(b))==null?void 0:E.groupName[0].message:"",label:a(m)("UserGroupCreate.그룹명")},null,8,["modelValue","error-msg","label"]),p(N,{modelValue:_.value,"onUpdate:modelValue":r[1]||(r[1]=i=>_.value=i),name:"groupInfo",width:"w-[26rem]",label:a(m)("UserGroupCreate.그룹_설명")},null,8,["modelValue","label"])])]),d("div",ie,[y(p(L,{icon:"arrow-down-tray","button-text":"저장",disabled:!a(A),onClick:j},null,8,["disabled"]),[[e,a(m)("UserGroupCreate.저장")]]),y(p(L,{icon:"x-mark",onClick:x},null,512),[[e,a(m)("UserGroupCreate.취소")]])])]),f.value?(n(),l("div",ne,[p(Z)])):v("",!0),f.value?v("",!0):(n(),l("div",de,[(n(!0),l(R,null,V(g.value,i=>(n(),l("div",{key:i.name,class:"bg-white dark:bg-dark border dark:border-dark-border rounded-lg shadow-md"},[d("div",ce,C(i.name),1),(n(!0),l(R,null,V(i.authList,c=>(n(),l("div",{key:c.authorityCode,class:"flex justify-between px-3 py-1"},[d("div",le,[d("div",null,C(c.authorityName),1),c.authorityExplain?y((n(),z(a(J),{key:0,class:"w-5 h-5 text-gray-400 cursor-pointer outline-none"},null,512)),[[e,c.authorityExplain]]):v("",!0)]),p(Q,{modelValue:c.isChecked,"onUpdate:modelValue":w=>c.isChecked=w,onClick:w=>q(c,i)},null,8,["modelValue","onUpdate:modelValue","onClick"])]))),128))]))),128))]))])}}});export{ge as default};
