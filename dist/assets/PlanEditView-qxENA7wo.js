import{k as s,ah as w,d as S,u as U,o as E,a as h,c as B,G as _,j as f,h as I,K as g}from"./index-eLyz9_Ts.js";import{u as L}from"./journalist-QNhBHHjf.js";import"./organization-qjYuRO6g.js";import{u as V,_ as A}from"./PlanForm.vue_vue_type_script_setup_true_lang-UnW1PizK.js";import{c as D}from"./use-plan-menu-omF6lTyZ.js";import{_ as N}from"./PlanHeader.vue_vue_type_script_setup_true_lang-kVPG60_7.js";import"./vue-multiselect-Yz8FsF-E.js";import"./GSingleSelect-7u8H0FdH.js";import"./sam-tw0uWIQ_.js";import"./purify.es-OZOo_0xz.js";import"./spell-check-OnBbfX8h.js";/* empty css                                                                  */import"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";import"./article-type.code-5cb8riL1.js";import"./program-omP_c4K3.js";import{_ as C}from"./ConfirmModal.vue_vue_type_script_setup_true_lang-k_ZxaDhN.js";import"./code-mapper-C6rl9hti.js";/* empty css                                                                    *//* empty css                                                                        */import"./tag-Q73uuSte.js";import"./category-zIRntbmZ.js";import"./department-wnuBQoCo.js";import"./GEditor.vue_vue_type_style_index_0_lang-FifEywK1.js";import"./file-Gx0JxWZZ.js";import"./GVideoPlayer-1SUF8s3O.js";import"./main-sHItgwS4.js";import"./vue-resizable.umd.min-blE9hPz6.js";import"./FormLabel.vue_vue_type_script_setup_true_lang-SB4ukE1P.js";import"./FormItem.vue_vue_type_script_setup_true_lang-ZXQ_7x89.js";import"./PermissionSettingModal.vue_vue_type_script_setup_true_lang-Cz5aOmSI.js";import"./OrganizationSelect.vue_vue_type_script_setup_true_lang-BNuugYEX.js";import"./UserSearchModal.vue_vue_type_script_setup_true_lang-iHw_FmsN.js";import"./make-grid-column-aeLSdEws.js";import"./BasisTypeSelect.vue_vue_type_script_setup_true_lang-7Pe-eM4w.js";import"./buttons-3hbXC8Cn.js";import"./index.esm-Hbr0u7mK.js";import"./ContentHeaderButtons.vue_vue_type_script_setup_true_lang-Db8CUXqr.js";import"./use-model-wrapper-XtiLc3Xd.js";import"./use-date-GeeGTbYh.js";import"./vue.runtime.esm-bundler-3P3R-Xon.js";function F(t){const u=L(),{fetchPlan:d,updatePlan:p}=u,m=s(),a=s();return{formRef:m,handleUpdatePlan:r=>{a.value=r,t==null||t.onBeforeUpdate()},handleUpdateButton:async()=>{var r;if(m.value)try{await((r=m.value)==null?void 0:r.onSubmitPlan())}catch(o){console.error("Failed onSubmitPlan",o)}},loadPlanDetail:async r=>{var o;try{const e=await d(r);e!=null&&e.success&&((o=t==null?void 0:t.onLoadSuccess)==null||o.call(t,e.data))}catch(e){console.error("usePlanEditActions loadPlanDetail Error",e)}},updatePlanItem:async r=>{var o;try{if(!a.value)return;(await p(a.value,r)).success&&((o=t==null?void 0:t.onUpdateSuccess)==null||o.call(t,!0),window.Notify.success({message:w.plan.success.edit}))}catch(e){console.error("usePlanEditActions updatePlanItem Error",e)}}}}const St=S({__name:"PlanEditView",setup(t){const u=U(),{formRef:d,closedTabAndMovePage:p,handleFormButton:m}=V(),a=s(null),l=s(),i=s({update:!1}),{handleUpdatePlan:c,loadPlanDetail:P,updatePlanItem:r}=F({onBeforeUpdate:()=>{i.value.update=!0},onLoadSuccess:n=>{l.value=n},onUpdateSuccess:n=>{n&&(i.value.update=!1,p())}}),o={data:{onUpdate:async()=>{try{await r(Number(a.value))}catch(n){console.error("PlanEditView onUpdate Error",n)}},onLoad:async()=>{a.value=Number(u.params.id);try{await P(a.value)}catch(n){console.error("PlanEditView onLoad Error",n)}}},print:{onPrint:async()=>{console.log("printl ogic...")}}},e=D({actionLabel:"저장",onAction:m,onClose:p,showPrint:!0,onPrint:o.print.onPrint}),y=n=>{i.value[n]=!i.value[n]};return E(()=>{o.data.onLoad()}),(n,v)=>(h(),B("div",null,[_(N,{"is-show-search":!1,"menu-items":f(e)},null,8,["menu-items"]),_(A,{ref_key:"formRef",ref:d,mode:"edit","form-data":l.value,onOnSubmitPlan:f(c)},null,8,["form-data","onOnSubmitPlan"]),i.value.update?(h(),I(f(C),{key:0,text:"기획서를 수정하시겠습니까?",onOnSubmit:o.data.onUpdate,onClose:v[0]||(v[0]=M=>y("update"))},null,8,["onOnSubmit"])):g("",!0)]))}});export{St as default};
