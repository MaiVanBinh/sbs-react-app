var ae=Object.defineProperty;var te=(p,r,s)=>r in p?ae(p,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[r]=s;var I=(p,r,s)=>(te(p,typeof r!="symbol"?r+"":r,s),s);import{d as z,a as h,h as A,al as ne,am as de,ew as H,V as ie,a5 as P,aD as Q,k as f,l as Y,t as re,o as X,c as $,Y as i,G as u,j as b,a1 as q,L as me,M as ce,Q as ue,a0 as N,w as k,X as W,a2 as V,K as L,F as be,b8 as ye,a3 as fe,aP as pe,eM as ge,ad as ve,ai as we,aj as F,aG as xe,ah as R}from"./index-eLyz9_Ts.js";import{g as K,M as _e}from"./splitpanes.es-dEoJOrhT.js";import{u as he}from"./use-date-GeeGTbYh.js";import{r as Ce}from"./use-render-component-K20sHqiA.js";import{_ as Se}from"./RequestItemImage.vue_vue_type_script_setup_true_lang-9Wg4vW2c.js";import{G as Ne}from"./GTextarea-5GIFD2Mo.js";import{G as ke}from"./GSingleSelect-7u8H0FdH.js";import{N as Me}from"./no-image-ERwb0SRC.js";/* empty css                                                                  */import"./vue-multiselect-Yz8FsF-E.js";import"./use-model-wrapper-XtiLc3Xd.js";const Ie=z({__name:"SymbolList",props:{isLoading:{type:Boolean},rowData:{},selectedRowIndex:{},pageInfo:{},suppressScrollOnNewData:{type:Boolean}},emits:["selected-rows","double-clicked-row","on-change-page","on-draggable","on-toggle-use","on-grid-ready"],setup(p,{emit:r}){const s=r,{formatDate:g}=he(),e=l=>{const y=document.createElement("div");y.className="h-full";const M={"onUpdate:modelValue":D=>{s("on-toggle-use",{symbol:l.data,useYn:D})},modelValue:l.data.useYn==="Y"};return Ce(H,M,y)},m=[{headerName:"",field:"drag",sortable:!1,maxWidth:40,rowDrag:!0},{headerName:"순번",filter:!1,maxWidth:60,valueGetter:"node.rowIndex",cellRenderer:l=>de(l)},{headerName:"이름",field:"symbolNm",filter:!1,maxWidth:160},{headerName:"설명",field:"expl",filter:!1},{headerName:"방송아이콘코드",field:"symbolTypCd",filter:!1,maxWidth:260},{headerName:"이미지",field:"",filter:!1,maxWidth:70,cellRenderer:Se,cellRendererParams:l=>({imageUrl:l.data.symbolUrl?`http://192.168.1.11:9000/api/files/${l.data.symbolUrl}`:null})},{headerName:"사용여부",field:"useYn",filter:!1,maxWidth:150,cellRenderer:l=>e(l)},{headerName:"등록일시",field:"inputDtm",filter:!1,maxWidth:260,valueGetter:l=>g(l.data.inputDtm,"YYYY-MM-DD HH:mm:ss")}],S=l=>{s("selected-rows",l)},w=l=>{s("double-clicked-row",l)},d=l=>{s("on-draggable",l)},v=(l,y)=>{s("on-change-page",l,y)},C=l=>{s("on-grid-ready",l)};return(l,y)=>(h(),A(ne,{class:"w-full h-full flex flex-col","column-defs":m,"row-data":l.rowData,"is-loading":l.isLoading,filter:!1,sortable:!1,"page-info":l.pageInfo,"row-drag-managed":!0,"selected-row-index":l.selectedRowIndex,"suppress-scroll-on-new-data":l.suppressScrollOnNewData,onSelectedRows:S,onOnRowDragEnd:d,onDoubleClickedRow:w,onOnChangePage:v,onOnGridReady:C},null,8,["row-data","is-loading","page-info","selected-row-index","suppress-scroll-on-new-data"]))}});class $e{constructor(){I(this,"video",{id:"video",name:"비디오",label:"비디오"});I(this,"audio",{id:"audio",name:"오디오",label:"오디오"});I(this,"camera",{id:"camera",name:"카메라",label:"카메라"});I(this,"DVE",{id:"dve",name:"DVE",label:"DVE"});I(this,"values",[this.camera,this.video,this.audio])}}const Ve=new $e,De={class:"space-y-2 text-sm"},Ue={class:"text-xs mb-2"},Ee={class:"text-xs mb-2"},Re={class:"relative flex flex-col space-y-1"},Ye={class:"flex space-x-2 w-full items-center"},Te={class:"w-[40px] h-[32px] bg-gray-100 rounded-md overflow-hidden"},Oe=["src"],Fe=["src"],Le=["disabled"],ze={key:0,class:"flex flex-col space-y-1 dark:text-white"},Ae={class:"flex text-xs font-medium text-gray-700 dark:text-white"},Ge={class:"flex space-x-2"},je={class:"text-xs"},Be={key:0,class:"space-x-3 flex items-center justify-end"},J=z({__name:"SymbolContent",props:{symbolId:{default:null},mode:{default:"create"}},emits:["on-create","on-edit","close"],setup(p,{emit:r}){const s=p,g=r,e=ie({expl:"",symbolFileNm:"",symbolName:"",symbolCode:"",symbolTypCd:"",symbolUrl:"symbol-file/1/d5446dc4-3593-4eeb-ab0d-0910f3e926a1.png",useYn:!0}),{t:m}=P(),S=Q(),w=f(),d=f(),v=f(!1),C=f(null),l=async()=>{if(s.symbolId)try{const o=await S.symbol.basic.findOne(s.symbolId);if(o.success){const t="http://192.168.1.11:9000/api/files";e.symbolName=o.data.symbolNm,e.symbolCode=o.data.symbolCd,e.expl=o.data.expl,e.symbolTypCd=o.data.symbolTypCd,e.symbolFileNm=o.data.symbolFileNm,e.useYn=o.data.useYn==="Y",C.value=o.data.symbolUrl?`${t}/${o.data.symbolUrl}`:"",console.log()}}catch(o){console.error("UserCreateModal: getUser() Error",o)}},y=Y(()=>s.mode==="read"),M=Y(()=>s.mode==="create"?m("Modal.Symbol.CreateModal.추가"):m("Modal.Symbol.CreateModal.수정")),D=Y(()=>!(!e.symbolName||!e.symbolCode||!e.symbolTypCd)),G=o=>{for(let n=0;n<o.length;n+=1)if(o[n].size>5242880)return window.Notify.error({message:"첨부파일 사이즈는 5MB 이내로 등록 가능합니다.",duration:3e3}),!1;return!0},x=o=>{const t=["jpg","jpeg","png"];for(let n=0;n<o.length;n+=1){const T=o[n].name.split(".").pop()??"";if(!t.includes(T))return window.Notify.error({message:"확장자를 확인해 주세요",duration:3e3}),!1}return!0},j=async o=>{const n=o.target.files;n&&G(n)&&x(n)&&(d.value=n[0],e.symbolFileNm=n[0].name,C.value=URL.createObjectURL(n[0]))},U=()=>{w.value.click()},B=async()=>{try{v.value=!0;let o=e.symbolTypCd;typeof o!="string"&&(o=o.id);const t={symbolName:e.symbolName,symbolCode:e.symbolCode,expl:e.expl,symbolTypCd:o,useYn:e.useYn?"Y":"N",...d.value?{file:d.value}:""};s.mode==="create"?g("on-create",t):(t.symbolId=s.symbolId,g("on-edit",t))}catch(o){console.error("UserCreateModal onSubmit() Error",o)}finally{v.value=!1}};return re(()=>s.symbolId,()=>{l()}),X(()=>{(s.mode==="edit"||s.mode==="read")&&l()}),(o,t)=>(h(),$(be,null,[i("div",De,[i("div",Ue,[u(q,{modelValue:e.symbolName,"onUpdate:modelValue":t[0]||(t[0]=n=>e.symbolName=n),name:"symbolNm",label:b(m)("Modal.Symbol.CreateModal.아이콘_명"),required:!y.value,disabled:y.value},null,8,["modelValue","label","required","disabled"])]),i("div",Ee,[u(q,{modelValue:e.symbolCode,"onUpdate:modelValue":t[1]||(t[1]=n=>e.symbolCode=n),onKeydown:t[2]||(t[2]=me(ce(()=>{},["prevent"]),["space"])),name:"symbolCode",label:b(m)("Modal.Symbol.CreateModal.아이콘_코드"),required:!y.value,disabled:y.value},null,8,["modelValue","label","required","disabled"])]),u(Ne,{modelValue:e.expl,"onUpdate:modelValue":t[3]||(t[3]=n=>e.expl=n),rows:3,label:b(m)("Modal.Symbol.CreateModal.설명"),disabled:y.value},null,8,["modelValue","label","disabled"]),u(ke,{modelValue:e.symbolTypCd,"onUpdate:modelValue":t[4]||(t[4]=n=>e.symbolTypCd=n),"track-by":"id",label:b(m)("Modal.Symbol.CreateModal.방송_아이콘_코드"),"item-label":"label",options:b(Ve).values,disabled:y.value,searchable:!1},null,8,["modelValue","label","options","disabled"]),i("div",Re,[t[8]||(t[8]=i("label",{for:"imageFileInput",class:"flex truncate sm:text-xs text-xs font-medium text-gray-700 dark:text-white"}," 이미지 ",-1)),i("div",Ye,[i("p",Te,[C.value?(h(),$("img",{key:0,class:"w-full h-full object-contain",src:C.value,alt:""},null,8,Oe)):(h(),$("img",{key:1,class:"w-full h-full object-cover",src:b(Me),alt:""},null,8,Fe))]),i("p",{class:ue(["truncate h-[34px] grow p-2 border text-xs shadow-sm rounded-md border-gray-300 dark:border-slate-600 dark:text-white",y.value?"bg-gray-200 dark:bg-dark-disabled":"dark:bg-dark-input"])},N(e.symbolFileNm),3),i("input",{id:"imageFileInput",ref_key:"imageFileInput",ref:w,type:"file",class:"hidden",accept:"image/png, image/gif, image/jpeg",disabled:y.value,readonly:"",onInput:j},null,40,Le),y.value?L("",!0):(h(),A(V,{key:0,class:"h-[2.15rem]",onClick:U},{default:k(()=>t[7]||(t[7]=[W(" 업로드 ")])),_:1}))])]),o.mode!=="read"?(h(),$("div",ze,[i("span",Ae,N(b(m)("Modal.Symbol.CreateModal.사용_여부")),1),i("div",Ge,[u(H,{modelValue:e.useYn,"onUpdate:modelValue":t[5]||(t[5]=n=>e.useYn=n)},null,8,["modelValue"]),i("p",je,N(b(m)("Modal.Symbol.CreateModal.사용_여부")),1)])])):L("",!0)]),o.mode!=="read"?(h(),$("div",Be,[u(V,{type:"secondary",onClick:t[6]||(t[6]=n=>o.$emit("close"))},{default:k(()=>[W(N(b(m)("Modal.Symbol.CreateModal.취소")),1)]),_:1}),u(V,{loading:v.value,disabled:!D.value,onClick:B},{default:k(()=>[W(N(M.value),1)]),_:1},8,["loading","disabled"])])):L("",!0)],64))}}),We={class:""},Pe={class:"px-2 py-4 space-y-6"},qe=z({__name:"SymbolModal",props:{symbolId:{default:0},mode:{default:"create"}},emits:["on-create","on-edit","close"],setup(p,{emit:r}){const s=p,g=r,{t:e}=P(),m=()=>{g("close")},S=Y(()=>s.mode==="create"?e("Modal.Symbol.CreateModal.방송_아이콘_추가"):e("Modal.Symbol.CreateModal.방송_아이콘_수정"));return(w,d)=>(h(),A(fe,{"modal-class":"sm:w-1/2 2xl:w-[25vw]",onClose:m},{title:k(()=>[i("span",We,N(S.value),1)]),content:k(()=>[u(ye,{text:"방송 아이콘 이미지는 40 x 28사이즈를 준수해 주세요.",type:"warning"}),i("div",Pe,[u(J,{"symbol-id":s.symbolId,mode:s.mode,onClose:m,onOnCreate:d[0]||(d[0]=v=>g("on-create",v)),onOnEdit:d[1]||(d[1]=v=>g("on-edit",v))},null,8,["symbol-id","mode"])])]),_:1}))}}),Ke={class:"h-full flex flex-col p-2 space-y-3"},He={class:"flex justify-between"},Qe={class:"flex items-center space-x-2"},Xe={class:"space-x-2 w-[210px]"},Je={class:"text-xl dark:text-dark-gray-200"},Ze={class:"text-xl text-gray-500"},es={class:"space-x-1.5"},ss={class:"h-full flex flex-col"},ls={class:"h-full w-full p-2 bg-white dark:bg-dark-grid rounded-md"},fs=z({__name:"AdminSymbolView",setup(p){const{t:r}=P(),s=Q(),{isLoadingSpinner:g}=pe(ge()),e=f(!1),m=f(!1),S=f("read"),w=f([]),d=f(),v=f(1),C=f(ve.max),l=f(0),y=f(),M=f(!1),D=f({isShow:!1,page:1,totalElements:1,totalPages:1,numberOfElements:1,size:C.value}),G=()=>{l.value=0,d.value=void 0},x=async()=>{try{g.value=!0;const a={useYn:null,page:v.value-1,size:C.value},c=await s.symbol.basic.findAll(a);c.success&&(w.value=c.data.content,w.value.length||G())}catch(a){console.log("AdminUserView: getUsers() Error",a)}finally{g.value=!1;const a=setTimeout(()=>{M.value=!1,clearTimeout(a)},0)}},j=()=>{x()},U=a=>{S.value=a,m.value=!0},B=a=>{d.value=a[0].data,l.value=a[0].rowIndex},o=a=>{d.value=a.data,U("edit")},t=async a=>{try{M.value=!0;const c={useYn:a.useYn?"Y":"N"};(await s.symbol.basic.update(a.symbol.symbolId,c)).success&&(window.Notify.success({message:R.symbol.edit}),await x())}catch(c){console.error("AdminUserView: onChangeYn() Error ",c)}},n=Y(()=>d.value?`${d.value.symbolNm}`:""),T=async()=>{try{(await s.symbol.basic.delete(d.value.symbolId)).success&&(window.Notify.success({message:R.symbol.delete}),await x())}catch(a){console.error("AdminUserView onDelete() Error ",a)}},Z=async a=>{try{(await s.symbol.basic.create(a)).success&&(window.Notify.success({message:R.symbol.create}),await x(),m.value=!1)}catch(c){console.error("AdminUserView onCreateSymbol() Error",c)}},ee=async a=>{try{if(a.file){const _=await s.symbol.basic.fileEdit(d.value.symbolId,{file:a.file});console.log(_)}(await s.symbol.basic.update(d.value.symbolId,a)).success&&(window.Notify.success({message:R.symbol.edit}),await x(),m.value=!1)}catch(c){console.error("AdminUserView onEditSymbol() Error",c)}},se=async a=>{var _;const c={symbolOrd:a.node.rowIndex};try{(await s.symbol.basic.updateOrder((_=a.overNode)==null?void 0:_.data.symbolId,c)).success&&(window.Notify.success({message:R.symbol.edit}),await x())}catch(E){console.log("Fail to update symbol order",E)}},le=a=>{a&&x(),m.value=!1},oe=a=>{y.value=a};return X(()=>{x()}),(a,c)=>{var E;const _=we("tooltip");return h(),$("div",Ke,[i("div",He,[i("div",Qe,[i("div",Xe,[i("span",Je,N(b(r)("Symbol.방송_아이콘")),1),i("span",Ze,N(b(r)("Symbol.방송_아이콘수",{symbol:w.value.length})),1)])]),i("div",es,[F(u(V,{icon:"arrow-path",onClick:j},null,512),[[_,b(r)("Symbol.새로고침")]]),F(u(V,{icon:"plus",disabled:e.value,onClick:c[0]||(c[0]=O=>U("create"))},null,8,["disabled"]),[[_,b(r)("Symbol.추가")]]),F(u(V,{icon:"pencil",disabled:e.value||!d.value,onClick:c[1]||(c[1]=O=>U("edit"))},null,8,["disabled"]),[[_,b(r)("Symbol.수정")]]),F(u(xe,{disabled:e.value||!d.value,title:n.value,onOnConfirm:T},null,8,["disabled","title"]),[[_,b(r)("Symbol.삭제")]])])]),i("div",ss,[u(b(_e),{class:"default-theme"},{default:k(()=>[u(b(K),{class:"flex flex-col h-full",size:"60"},{default:k(()=>[u(Ie,{"is-loading":e.value,"row-data":w.value,"page-info":D.value,"selected-row-index":l.value,"suppress-scroll-on-new-data":M.value,onOnGridReady:oe,onSelectedRows:B,onDoubleClickedRow:o,onOnToggleUse:t,onOnDraggable:se},null,8,["is-loading","row-data","page-info","selected-row-index","suppress-scroll-on-new-data"])]),_:1}),u(b(K),{"min-size":"20",size:"30",class:"flex flex-col h-full gap-1.5"},{default:k(()=>{var O;return[i("div",ls,[u(J,{"symbol-id":(O=d.value)==null?void 0:O.symbolId,mode:"read"},null,8,["symbol-id"])])]}),_:1})]),_:1})]),m.value?(h(),A(qe,{key:0,"symbol-id":(E=d.value)==null?void 0:E.symbolId,mode:S.value,onOnCreate:Z,onOnEdit:ee,onClose:le},null,8,["symbol-id","mode"])):L("",!0)])}}});export{fs as default};
