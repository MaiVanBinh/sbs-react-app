import{aO as C,aD as k,d as D,k as g,t as E,o as O,ai as j,a as m,c as v,Y as o,G as A,ew as b,aj as B,a2 as W,F as M,C as V,a0 as S,ag as n,ah as F}from"./index-eLyz9_Ts.js";const $=C("manager-popup-setting",{actions:{async fetchManagerPopupSetting(){try{return await k().managerPopup.basic.findAll()}catch(p){console.error("store: fetchManagerPopupSetting() Error",p)}},async updateManagerPopupSetting(p){try{return await k().managerPopup.basic.update(p)}catch(u){console.error("store: updateManagerPopupSetting() Error",u)}}}}),q={class:"text-gray-500 dark:text-dark-gray-200"},Y={class:"flex justify-between items-center"},z={class:"flex space-x-2"},H={class:"flex items-center space-x-1 text-sm"},J={class:"flex items-center space-x-1 text-sm"},K={class:"flex flex-col h-full overflow-auto"},Q={class:"grid xl:grid-cols-4 md:grid-cols-3 sm:grid-cols-2 xs:grid-cols-1 grid-flow-row gap-4 overflow-auto"},R={class:"border-b dark:border-dark-border p-3 text-center"},X={class:"truncate"},Z={class:"grid grid-cols-2 gap-2"},te=D({__name:"AdminAlertView",setup(p){const{fetchManagerPopupSetting:u,updateManagerPopupSetting:w}=$(),P=g([]),a=g([]),d=g(!1),i=g(!1),x=g(!1),c=()=>{x.value=!n.isEqual(P.value,a.value)},h=()=>n.every(a.value,t=>n.every(t.children,e=>e.webPopupAlertUse)),_=()=>n.every(a.value,t=>n.every(t.children,e=>e.mobilePopupAlertUse)),y=async()=>{const t=await u();t.success&&(a.value=t.data.reduce((e,s)=>{let r=e.find(l=>l.popupAlertGroupId===s.popupAlertGroupId);return r||(r={popupAlertGroupId:s.popupAlertGroupId,popupAlertGroupName:s.popupAlertGroupName,children:[]},e.push(r)),r.children.push(s),e},[]),P.value=n.cloneDeep(a.value),d.value=h(),i.value=_())},U=async t=>{(await w(t)).success&&(await y(),window.Notify.success({message:F.adminPopup.update}))},G=()=>{d.value=h(),c()},I=()=>{i.value=_(),c()},N=()=>{a.value=a.value.map(t=>({...t,children:t.children.map(e=>({...e,webPopupAlertUse:d.value}))})),c()},T=()=>{a.value=a.value.map(t=>({...t,children:t.children.map(e=>({...e,mobilePopupAlertUse:i.value}))})),c()},L=()=>{const t={managerPopupAlertManagementInfoList:n.flatMap(a.value,e=>e.children.map(s=>n.pick(s,["managerPopupAlertManagementId","webPopupAlertUse","mobilePopupAlertUse"])))};console.log("params",t),U(t)};return E(()=>a.value,()=>{c()}),O(()=>{y()}),(t,e)=>{const s=j("tooltip");return m(),v("div",q,[o("div",Y,[o("div",z,[e[4]||(e[4]=o("div",{class:"text-xl font-D2CodingBold truncate pr-2"},"알림 설정",-1)),o("div",H,[e[2]||(e[2]=o("div",{class:"truncate"},"웹 전체 허용",-1)),A(b,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=r=>d.value=r),onOnToggle:N},null,8,["modelValue"])]),o("div",J,[e[3]||(e[3]=o("div",{class:"truncate"},"모바일 전체 허용",-1)),A(b,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=r=>i.value=r),onOnToggle:T},null,8,["modelValue"])])]),B(A(W,{icon:"arrow-down-tray","button-text":"저장",disabled:!x.value,onClick:L},null,8,["disabled"]),[[s,"저장"]])]),o("div",K,[o("div",Q,[(m(!0),v(M,null,V(a.value,r=>(m(),v("div",{key:r.popupAlertGroupId,class:"bg-white dark:bg-dark border dark:border-dark-border rounded-lg shadow-md"},[o("div",R,S(r.popupAlertGroupName),1),e[5]||(e[5]=o("div",{class:"flex justify-end items-center p-1 px-2 border-b dark:border-dark-border"},[o("div",{class:"grid grid-cols-2 gap-2"},[o("div",{class:"text-center"},"웹"),o("div",null,"모바일")])],-1)),(m(!0),v(M,null,V(r.children,l=>(m(),v("div",{key:l.managerPopupAlertManagementId,class:"flex justify-between p-2"},[o("div",X,S(l.managerPopupAlertManagementName),1),o("div",Z,[A(b,{modelValue:l.webPopupAlertUse,"onUpdate:modelValue":f=>l.webPopupAlertUse=f,onOnToggle:G},null,8,["modelValue","onUpdate:modelValue"]),A(b,{modelValue:l.mobilePopupAlertUse,"onUpdate:modelValue":f=>l.mobilePopupAlertUse=f,onOnToggle:I},null,8,["modelValue","onUpdate:modelValue"])])]))),128))]))),128))])])])}}});export{te as default};
