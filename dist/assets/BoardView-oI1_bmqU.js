import{d as q,k as m,aq as ue,o as me,t as oe,b3 as se,ai as ee,a as s,c as b,G as t,w as Y,j as F,Y as e,a1 as H,aj as E,a2 as S,F as J,C as Z,Q as te,a0 as O,K as $,h as A,b8 as fe,b as ne,c6 as pe,aD as de,al as ye,am as ke,a6 as X,ab as xe,ap as he,ae as ce,V as _e,af as ge,aG as we}from"./index-eLyz9_Ts.js";import{g as K,M as le}from"./splitpanes.es-dEoJOrhT.js";import{_ as Ce}from"./SearchForm.vue_vue_type_script_setup_true_lang-iGmgdrLf.js";import{_ as ae}from"./GEditor.vue_vue_type_script_setup_true_lang-a2qGOvtc.js";import"./GEditor.vue_vue_type_style_index_0_lang-FifEywK1.js";import{G as Q}from"./GTextarea-5GIFD2Mo.js";import{_ as ie}from"./FileDropzone.vue_vue_type_script_setup_true_lang-SVeHifZw.js";import{F as ve}from"./file-division-code-x51qUgaH.js";import{u as re}from"./file-Gx0JxWZZ.js";import{r as Te}from"./use-render-component-K20sHqiA.js";import{A as $e}from"./app-authority-code-Q9MU7mjP.js";/* empty css                                                                  */import"./use-model-wrapper-XtiLc3Xd.js";import"./FileListView.vue_vue_type_script_setup_true_lang-A40KFqZZ.js";import"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";import"./GVideoPlayer-1SUF8s3O.js";import"./main-sHItgwS4.js";import"./vue.runtime.esm-bundler-3P3R-Xon.js";const Ie={class:"space-y-3 text-xs h-full"},Ve={class:"p-2 bg-white dark:bg-dark border dark:border-dark-border rounded-md flex space-x-2"},De={class:"flex flex-1 space-x-2 items-center"},Fe={class:"flex space-x-2 items-center"},Ne={key:0,class:"flex flex-col h-full min-h-64"},Be=["for"],Le={class:"h-full"},Ue={class:"p-2 h-full bg-white dark:bg-dark border dark:border-dark-border rounded-md"},Se=q({__name:"BoardPostCreate",props:{selectedBoardTemplateList:{}},emits:["close","onSave"],setup(R,{emit:I}){const d=m(""),v=I,f=R,w=m(!1),r=m(),p=m(),k=m(!0),a=m([]),{fileUpload:C}=re(),{swalConfirm:T}=ne(),{changeTabCanClosed:M}=ue(),N=async()=>{var y;if(!a.value)return[];const L=(y=a==null?void 0:a.value)==null?void 0:y.map(async l=>{const g={fileName:l.name,fileDivisionCode:ve.Board.id,publicYn:"Y",file:l},V=await C(g);if(V.success)return V.data.id});return await Promise.all(L)},z=async()=>{if(!d.value){window.Notify.error({message:"제목을 입력해주세요."});return}const L=await N(),h={bbmTitl:d.value,boardMemoFieldList:p.value,attcFileIds:L};v("onSave",h),v("close")},j=()=>{w.value?T({html:"변경된 데이터가 있습니다.<br> 저장하시겠습니까?",confirmButtonText:"저장"}).then(L=>{L.isConfirmed?z():v("close"),M(!0)}):v("close")},B=()=>{const L=f.selectedBoardTemplateList;L.sort((h,y)=>h.fieldOrder-y.fieldOrder),r.value=L.filter(h=>h.useYn==="Y"),p.value=r.value.map(h=>({boardMemoFieldTemplateId:h.id,fieldContent:""}))},G=L=>{L.key==="Escape"&&j()};return me(()=>{B(),window.addEventListener("keyup",G)}),oe(()=>[d.value,p.value,a.value],([L,h,y])=>{(L!==""||y.length||h.some(l=>l.fieldContent!==""))&&(w.value=!0),M(!w.value)},{deep:!0}),se(()=>{window.removeEventListener("keyup",G)}),(L,h)=>{const y=ee("tooltip");return s(),b("div",Ie,[t(F(le),{class:"default-theme pt-1"},{default:Y(()=>[t(F(K),{class:"flex flex-col gap-2 h-full overflow-auto"},{default:Y(()=>[e("div",Ve,[e("div",De,[h[2]||(h[2]=e("div",{class:"text-xs dark:text-white"},"제목",-1)),t(H,{modelValue:d.value,"onUpdate:modelValue":h[0]||(h[0]=l=>d.value=l),title:d.value,name:"Title",focus:!0,placeholder:"제목을 입력하세요.",class:"flex-1"},null,8,["modelValue","title"])]),e("div",Fe,[E(t(S,{"button-text":"저장",icon:"arrow-down-tray",onClick:z},null,512),[[y,"저장"]]),E(t(S,{icon:"x-mark",onClick:j},null,512),[[y,"취소"]])])]),(s(!0),b(J,null,Z(r.value,(l,g)=>(s(),b("div",{key:`${g}_${l.fieldType}`,class:te(["p-2 bg-white dark:bg-dark border dark:border-dark-border rounded-md",l.fieldType==="single"?"h-20":l.fieldType==="multi"?"h-28":"h-full"])},[l.fieldType==="editor"?(s(),b("div",Ne,[e("label",{for:l.fieldType,class:"block text-xs font-medium text-gray-700 dark:text-dark-gray-200 mb-2"},O(l.fieldName),9,Be),e("div",Le,[t(ae,{modelValue:p.value[g].fieldContent,"onUpdate:modelValue":V=>p.value[g].fieldContent=V},null,8,["modelValue","onUpdate:modelValue"])])])):$("",!0),l.fieldType==="single"?(s(),A(H,{key:1,modelValue:p.value[g].fieldContent,"onUpdate:modelValue":V=>p.value[g].fieldContent=V,name:l.fieldName,class:"flex-1",label:l.fieldType},null,8,["modelValue","onUpdate:modelValue","name","label"])):$("",!0),l.fieldType==="multi"?(s(),A(Q,{key:2,modelValue:p.value[g].fieldContent,"onUpdate:modelValue":V=>p.value[g].fieldContent=V,label:l.fieldType,rows:3},null,8,["modelValue","onUpdate:modelValue","label"])):$("",!0)],2))),128))]),_:1}),k.value?(s(),A(F(K),{key:0,"min-size":"30",size:"30"},{default:Y(()=>[e("div",Ue,[e("div",null,[h[3]||(h[3]=e("p",{class:"mb-2 text-xs"},"첨부파일",-1)),t(fe,{text:"게시글 저장시 파일 첨부가 완료됩니다.",type:"warning"}),t(ie,{"file-data":a.value,"onUpdate:fileData":h[1]||(h[1]=l=>a.value=l),mode:"create","is-read-only":!1},null,8,["file-data"]),h[4]||(h[4]=e("div",{class:"text-error text-xs"},[e("p",null,"* 파일하나 당 최대 200MB까지 업로드 할 수 있습니다."),e("p",null,"* 등록 개수는 최대 5개 입니다.")],-1))])])]),_:1})):$("",!0)]),_:1})])}}}),Oe={class:"space-y-3 text-xs h-full"},Re={class:"p-2 bg-white dark:bg-dark border dark:border-dark-border rounded-md flex space-x-2"},Me={class:"flex flex-1 space-x-2 items-center"},Ee={class:"flex space-x-2 items-center"},Pe={key:0,class:"flex flex-col h-full min-h-64"},Ye=["for"],ze={class:"h-full"},Ae=["for"],je=["for"],Ge={class:"p-2 h-full bg-white dark:bg-dark border dark:border-dark-border rounded-md"},Je=q({__name:"BoardPostUpdate",props:{bbmId:{},bbId:{},selectedBoardTemplateList:{}},emits:["close","on-save"],setup(R,{emit:I}){const d=R,v=m(),f=m(!0),w=I,r=m(),p=m(),{swalConfirm:k}=ne(),{changeTabCanClosed:a}=ue(),C=m(!1),T=m({title:"",contents:[],files:[]}),M=m(!0),N=m([]),{fileUpload:z,fileDownload:j}=re(),B=[],G=async()=>{const i=await de().board.basic.findOne(d.bbId,d.bbmId);try{if(i.success){const{bbmTitl:u,attcFiles:c,boardMemoFieldList:D}=i.data;v.value=u,N.value=c.map(U=>({...U,name:U.fileNm,fileId:U.id})),B.value=c.map(U=>U.id),p.value=D.map(U=>{var x;return{boardMemoFieldTemplateId:U.boardMemoFieldTemplate.id,fieldContent:((x=U.boardMemoField)==null?void 0:x.fieldContent)??""}}),T.value.title=JSON.parse(JSON.stringify(v.value)),T.value.files=JSON.parse(JSON.stringify(N.value)),T.value.contents=JSON.parse(JSON.stringify(p.value))}}catch(u){console.log(u)}finally{f.value=!1}},L=async n=>{n.map(async i=>{const u={fileName:i.name,publicYn:"Y",fileDivisionCode:ve.Board.id,file:i};try{const c=await z(u);c.success&&B.value.push(c.data.id)}catch(c){console.log("Fail to add file",c)}})},h=n=>{j(n.file)},y=async(n,i)=>{B.value.splice(i,1),N.value.splice(i,1)},l=async()=>{if(!v.value){window.Notify.error({message:"입력하신 정보를 확인해주세요."});return}const n={bbmTitl:v.value,attcFileIds:B.value,boardMemoFieldList:p.value};w("on-save",n),w("close")},g=()=>{C.value?k({html:"변경된 데이터가 있습니다.<br> 저장하시겠습니까?",confirmButtonText:"저장"}).then(n=>{n.isConfirmed?l():w("close"),a(!0)}):w("close")},V=n=>{n.key==="Escape"&&g()},o=()=>{const n=d.selectedBoardTemplateList;n.sort((i,u)=>i.fieldOrder-u.fieldOrder),r.value=n.filter(i=>i.useYn==="Y")};return pe(async()=>{await G(),o(),window.addEventListener("keyup",V)}),se(()=>{window.removeEventListener("keyup",V)}),oe(()=>[v.value,p.value,N.value],([n,i,u])=>{const{title:c,contents:D,files:U}=T.value;(n!==c||JSON.stringify(D)!==JSON.stringify(i)||JSON.stringify(u)!==JSON.stringify(U))&&(C.value=!0),a(!C.value)},{deep:!0}),(n,i)=>{const u=ee("tooltip");return s(),b("div",Oe,[f.value?$("",!0):(s(),A(F(le),{key:0,class:"default-theme"},{default:Y(()=>[t(F(K),{class:"flex flex-col gap-2 overflow-auto"},{default:Y(()=>[e("div",Re,[e("div",Me,[i[2]||(i[2]=e("div",{class:"text-xs dark:text-white"},"제목",-1)),t(H,{modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=c=>v.value=c),title:v.value,name:"Title",focus:!0,placeholder:"제목을 입력하세요.",class:"flex-1"},null,8,["modelValue","title"])]),e("div",Ee,[E(t(S,{"button-text":"저장",icon:"arrow-down-tray",onClick:l},null,512),[[u,"저장"]]),E(t(S,{icon:"x-mark",onClick:g},null,512),[[u,"취소"]])])]),(s(!0),b(J,null,Z(r.value,(c,D)=>(s(),b("div",{key:`${D}_${c.fieldType}`,class:te(["p-2 bg-white dark:bg-dark border dark:border-dark-border rounded-md",c.fieldType==="single"?"h-20":c.fieldType==="multi"?"h-28":"h-full"])},[c.fieldType==="editor"?(s(),b("div",Pe,[e("label",{for:c.fieldType,class:"block text-xs font-medium text-gray-700 dark:text-dark-gray-200 mb-2"},O(c.fieldName),9,Ye),e("div",ze,[t(ae,{modelValue:p.value[D].fieldContent,"onUpdate:modelValue":U=>p.value[D].fieldContent=U},null,8,["modelValue","onUpdate:modelValue"])])])):$("",!0),c.fieldType==="single"?(s(),b(J,{key:1},[e("label",{for:c.fieldType,class:"block text-xs font-medium text-gray-700 dark:text-dark-gray-200 mb-2"},O(c.fieldName),9,Ae),t(H,{modelValue:p.value[D].fieldContent,"onUpdate:modelValue":U=>p.value[D].fieldContent=U,name:c.fieldName,class:"flex-1"},null,8,["modelValue","onUpdate:modelValue","name"])],64)):$("",!0),c.fieldType==="multi"?(s(),b(J,{key:2},[e("label",{for:c.fieldType,class:"block text-xs font-medium text-gray-700 dark:text-dark-gray-200 mb-2"},O(c.fieldName),9,je),t(Q,{modelValue:p.value[D].fieldContent,"onUpdate:modelValue":U=>p.value[D].fieldContent=U,rows:3},null,8,["modelValue","onUpdate:modelValue"])],64)):$("",!0)],2))),128))]),_:1}),M.value?(s(),A(F(K),{key:0,"min-size":"25",size:"25"},{default:Y(()=>[e("div",Ge,[e("div",null,[i[3]||(i[3]=e("p",{class:"mb-2 text-xs"},"첨부파일",-1)),t(fe,{text:"게시글 저장시 파일 첨부가 완료됩니다.",type:"warning"}),t(ie,{"file-data":N.value,"onUpdate:fileData":i[1]||(i[1]=c=>N.value=c),mode:"edit",onOnDownloadFile:h,onOnDeleteFile:y,onOnUploadFile:L},null,8,["file-data"]),i[4]||(i[4]=e("div",{class:"text-error text-xs"},[e("p",null,"* 파일하나 당 최대 200MB까지 업로드 할 수 있습니다."),e("p",null,"* 등록 개수는 최대 5개 입니다.")],-1))])])]),_:1})):$("",!0)]),_:1}))])}}}),We=q({__name:"BoardItemList",props:{height:{default:""},isLoading:{type:Boolean,default:!1},rowData:{},pageInfo:{},selectedRowIndex:{default:0}},emits:["selected-rows","double-clicked-row","on-update","on-change-page"],setup(R,{emit:I}){const d=R,v=I,f=a=>{const C=a[0].data;v("selected-rows",C)},w=[{headerName:"NO",filter:!1,maxWidth:80,valueGetter:"node.rowIndex",cellRenderer:a=>ke(a)},{headerName:"분류",field:"boardType"},{headerName:"제목",field:"bbmTitl",filter:!1,valueFormatter:a=>a.data.isChildren?`✅ ${a.data.bbmTitl}`:a.data.bbmTitl},{headerName:"첨부파일",maxWidth:150,field:"attcFiles",filter:!1,cellRenderer:a=>a.value.length===0?"":Te(X,{icon:"paper-clip",size:"w-4 h-4"},document.createElement("div"))},{headerName:"등록자",field:"inputrNm",maxWidth:150,filter:!1},{headerName:"등록일시",minWidth:130,maxWidth:180,field:"inputDtm",filter:!1},{headerName:"수정자",maxWidth:150,field:"updtrNm",filter:!1},{headerName:"수정일시",minWidth:130,maxWidth:180,field:"updtDtm",filter:!1}],r={rowData:d.rowData,columnDefs:w},p=a=>{v("double-clicked-row",a)},k=a=>{v("on-change-page",a)};return(a,C)=>(s(),A(ye,{class:"w-full h-full flex flex-col","column-defs":w,"row-data":a.rowData,"grid-options":r,"is-loading":a.isLoading,"row-selection":"single","page-info":a.pageInfo,onSelectedRows:f,onDoubleClickedRow:p,onOnChangePage:k},null,8,["row-data","is-loading","page-info"]))}}),qe={class:"h-full dark:bg-dark-grid dark:text-dark-gray-200 bg-white flex flex-col border border-gray-300 dark:border-dark rounded-lg"},Ke=["onClick"],Qe=q({__name:"BoardList",props:{boardGroup:{}},emits:["click-board"],setup(R,{emit:I}){const d=R,v=I,f=m(),w=async r=>{f.value=r,v("click-board",r)};return oe(()=>d.boardGroup,r=>{f.value=r[0]}),(r,p)=>(s(),b("div",qe,[(s(!0),b(J,null,Z(r.boardGroup,k=>(s(),b("div",{key:k.bbId,class:te(["dark:hover:bg-[#1e3b54] hover:bg-blue-100 border-b dark:border-dark-border p-2",[{"bg-blue-50 dark:bg-[#1e3b54]":f.value&&k.bbId===f.value.bbId}]]),onClick:a=>w(k)},[e("div",null,O(k==null?void 0:k.bbNm),1)],10,Ke))),128))]))}}),He={class:"space-y-3 text-xs h-full"},Xe={class:"flex space-x-2 items-center p-2 bg-white dark:bg-dark -m-2"},Ze={class:"flex flex-1 space-x-2 items-center"},et={class:"flex space-x-2 items-center"},tt=q({__name:"BoardPostReply",emits:["close","onSave"],setup(R,{emit:I}){const d=m("답글: "),v=m(""),f=I,w=()=>{f("close")},r=async()=>{if(!d.value||!v.value){window.Notify.error({message:"입력하신 정보를 확인해주세요."});return}const p={bbmTitl:d.value,bbmCtt:v.value};f("onSave",p),f("close")};return(p,k)=>{const a=ee("tooltip");return s(),b("div",He,[e("div",Xe,[e("div",Ze,[k[2]||(k[2]=e("div",{class:"text-sm dark:text-white"},"제목",-1)),t(H,{modelValue:d.value,"onUpdate:modelValue":k[0]||(k[0]=C=>d.value=C),title:d.value,name:"Title",focus:!0,placeholder:"제목을 입력하세요.",class:"flex-1"},null,8,["modelValue","title"])]),e("div",et,[E(t(S,{"button-text":"저장",icon:"arrow-down-tray",onClick:r},null,512),[[a,"저장"]]),E(t(S,{icon:"x-mark",onClick:w},null,512),[[a,"취소"]])])]),t(ae,{modelValue:v.value,"onUpdate:modelValue":k[1]||(k[1]=C=>v.value=C)},null,8,["modelValue"])])}}}),lt={class:"p-2 space-y-3"},at={class:"flex space-x-2"},ot=q({__name:"CommentForm",emits:["on-save-comment"],setup(R,{emit:I}){const d=I,v=m(""),f=async()=>{d("on-save-comment",v.value),v.value=""};return(w,r)=>(s(),b("div",lt,[r[1]||(r[1]=e("label",{for:"comment",class:"text-xs text-gray-800 dark:text-dark-gray-200"},"댓글",-1)),e("form",null,[e("div",at,[t(Q,{id:"comment",modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=p=>v.value=p),rows:5,class:"flex-1 justify-center items-center"},null,8,["modelValue"]),t(S,{icon:"check",onClick:f})])])]))}}),st={class:"space-y-3 p-2"},nt={class:"mb-3"},dt={class:"flex justify-between mb-2"},it={class:"text-xs text-gray-800 dark:text-gray-200"},rt={class:"flex space-x-2 dark:text-white"},ct={class:"text-xs text-gray-400 dark:text-slate-400 min-w-fit"},ut={key:0},mt={key:1},ft={key:0,class:"flex flex-col space-y-2"},pt={key:1,class:"text-base text-gray-800 mb-2 dark:text-white"},vt=["onClick"],bt={key:1,class:"flex flex-col space-y-2 mb-3"},yt={class:"flex justify-end space-x-1"},kt={class:"flex justify-between"},xt={class:"flex space-x-1"},ht={class:"text-gray-400 dark:text-slate-400"},_t={key:0},gt={key:1},wt={key:0,class:"flex flex-col"},Ct={class:"flex justify-end"},Tt={key:1,class:"text-sm p-1"},$t=q({__name:"CommentList",props:{comments:{}},emits:["on-save","on-delete","on-edit"],setup(R,{emit:I}){const d=I,{can:v,userMngId:f}=xe(),{swalConfirm:w}=ne(),r=m(),p=m(),k=m(),a=m(""),C=m(""),T=m(""),M=(y,l)=>{if(k.value===l){k.value=null;return}C.value=y.cmntCtt,k.value=l},N=(y,l)=>{if(p.value===l){p.value=null;return}p.value=l,T.value=y.cmntCtt},z=y=>{if(r.value===y){r.value=null;return}r.value=y},j=y=>{d("on-save",a.value,y),a.value=""},B=y=>{w({title:y.cmntCtt,html:"<div>을(를) 삭제하시겠습니까?</div>",confirmButtonText:"삭제"}).then(l=>{l.isConfirmed&&d("on-delete",y)})},G=y=>{w({title:y.cmntCtt,html:"<div>을(를) 삭제하시겠습니까?</div>",confirmButtonText:"삭제"}).then(l=>{l.isConfirmed&&d("on-delete",y)})},L=async(y,l)=>{d("on-edit",y,l),k.value=null},h=async(y,l)=>{d("on-edit",y,l),p.value=null};return(y,l)=>(s(),b("div",st,[(s(!0),b(J,null,Z(y.comments,(g,V)=>(s(),b("div",{key:g.cmntId,class:"border px-3 py-4 rounded-lg bg-white dark:bg-dark border dark:border-dark-border rounded-md"},[e("div",nt,[e("div",dt,[e("div",it,O(g.updtrNm),1),e("div",rt,[e("div",ct,O(g.updtDtm),1),F(f)===g.updtrId?(s(),b("div",ut,[t(X,{icon:"pencil-square",size:"w-4",onClick:o=>M(g,V)},null,8,["onClick"])])):$("",!0),F(f)===g.updtrId?(s(),b("div",mt,[t(X,{icon:"x-mark",size:"w-4",onClick:o=>B(g)},null,8,["onClick"])])):$("",!0)])]),k.value===V?(s(),b("div",ft,[l[3]||(l[3]=e("label",{for:"comment-edit"},null,-1)),t(Q,{id:"comment-edit",modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=o=>C.value=o),class:"mb-2",rows:5},null,8,["modelValue"]),t(S,{icon:"check",onClick:o=>L(g.cmntId,C.value)},null,8,["onClick"])])):(s(),b("div",pt,O(g.cmntCtt),1))]),e("section",null,[F(v)(F($e).BOARD_REPLY_WRITE.code)?(s(),b("div",{key:0,class:"flex items-center dark:text-white text-gray-700 text-x cursor-pointer space-x-2",onClick:o=>z(V)},[t(X,{size:"w-5 h-5",icon:"chat-bubble-left-right"}),l[4]||(l[4]=e("span",null,"답글 달기",-1))],8,vt)):$("",!0),r.value===V?(s(),b("div",bt,[l[5]||(l[5]=e("label",{for:"reply"},null,-1)),t(Q,{modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value=o),rows:3},null,8,["modelValue"]),e("div",yt,[t(S,{icon:"check",onClick:o=>j(g.cmntId)},null,8,["onClick"]),t(S,{icon:"x-mark",onClick:o=>z(V)},null,8,["onClick"])])])):$("",!0),(s(!0),b(J,null,Z(g.children,(o,n)=>(s(),b("div",{key:o.cmntId,class:"pl-4 mt-2 text-xs border-l-2 border-gray-300 dark:border-slate-600 dark:text-white"},[e("div",kt,[e("div",null,[e("div",null,O(o.updtrNm),1)]),e("div",xt,[e("div",ht,O(o.updtDtm),1),F(f)===o.updtrId?(s(),b("div",_t,[t(X,{icon:"pencil-square",size:"w-3",onClick:i=>N(o,n)},null,8,["onClick"])])):$("",!0),F(f)===o.updtrId?(s(),b("div",gt,[t(X,{icon:"x-mark",size:"w-3",onClick:i=>G(o)},null,8,["onClick"])])):$("",!0)])]),p.value===n?(s(),b("div",wt,[l[6]||(l[6]=e("label",{for:"reply-edit"},null,-1)),t(Q,{id:"reply-edit",modelValue:T.value,"onUpdate:modelValue":l[2]||(l[2]=i=>T.value=i),class:"p-2",rows:5},null,8,["modelValue"]),e("div",Ct,[t(S,{icon:"check",onClick:i=>h(o.cmntId,T.value)},null,8,["onClick"])])])):(s(),b("div",Tt,O(o.cmntCtt),1))]))),128))])]))),128))]))}}),It={class:"space-y-3 text-xs h-full"},Vt={class:"p-2 bg-white dark:bg-dark border dark:border-dark-border rounded-md flex space-x-2"},Dt={class:"flex flex-1 space-x-2 items-center"},Ft={class:"flex space-x-2 items-center"},Nt={key:0,class:"flex flex-col h-full min-h-64"},Bt=["for"],Lt={class:"h-full"},Ut=["for"],St=["for"],Ot={class:"p-2 h-full overflow-auto grow bg-white dark:bg-dark border dark:border-dark-border rounded-md"},Rt={class:"p-2 h-48 bg-white dark:bg-dark border dark:border-dark-border rounded-md"},Mt=q({__name:"BoardDetail",props:{bbmId:{},bbId:{},selectedBoardTemplateList:{}},emits:["close","onSave"],setup(R,{emit:I}){const d=R,v=m(!0),f=m(""),w=m(),r=de(),{moveNewMyArticle:p}=he(),k=I,a=m([]),C=m(),T=m(),M=async()=>{const o=await r.board.basic.findOne(d.bbId,d.bbmId);try{if(o.success){const{bbmTitl:n,attcFiles:i,boardMemoFieldList:u}=o.data;f.value=n,a.value=i.map(c=>({...c,name:c.fileNm,fileId:c.id})),T.value=u.map(c=>{var D;return{boardMemoFieldTemplateId:c.boardMemoFieldTemplate.id,fieldContent:((D=c.boardMemoField)==null?void 0:D.fieldContent)??""}})}}catch(n){console.log(n)}finally{v.value=!1}},N=async()=>{try{const o=await r.board.comment.findAll(d.bbId,d.bbmId);w.value=o.data}catch(o){console.log("Fail to get comment list",o)}},z=async o=>{const n={cmntCtt:o};try{(await r.board.comment.createComment(d.bbId,d.bbmId,n)).success&&N()}catch(i){console.log("Fail to save comment",i)}},j=async(o,n)=>{const i={cmntCtt:n};try{(await r.board.comment.updateComment(d.bbId,d.bbmId,o,i)).success&&N()}catch(u){console.log("Fail to edit comment",u)}},B=async(o,n)=>{const i={cmntCtt:o,hrnkCmntId:n};try{(await r.board.comment.createComment(d.bbId,d.bbmId,i)).success&&N()}catch(u){console.log("Fail to save reply to comment",u)}},G=async o=>{try{(await r.board.comment.deleteComment(o.bbId,o.bbmId,o.cmntId)).success&&N()}catch(n){console.log("Fail to delete comment",n)}},{fileDownload:L}=re(),h=o=>{L(o.file)},y=()=>{const o={boardId:d.bbId,postId:d.bbmId};p(o)},l=()=>{k("close")},g=()=>{const o=d.selectedBoardTemplateList;o.sort((n,i)=>n.fieldOrder-i.fieldOrder),C.value=o.filter(n=>n.useYn==="Y")},V=o=>{o.key==="Escape"&&l()};return pe(async()=>{g(),await M(),await N(),window.addEventListener("keyup",V)}),se(()=>{window.removeEventListener("keyup",V)}),(o,n)=>{const i=ee("tooltip");return s(),b("div",It,[v.value?$("",!0):(s(),A(F(le),{key:0,class:"default-theme"},{default:Y(()=>[t(F(K),{class:"flex flex-col align-stretch gap-2 overflow-auto"},{default:Y(()=>[e("div",Vt,[e("div",Dt,[n[2]||(n[2]=e("div",{class:"text-xs dark:text-white"},"제목",-1)),t(H,{modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=u=>f.value=u),title:f.value,name:"Title",focus:!0,placeholder:"제목을 입력하세요.",class:"flex-1",disabled:""},null,8,["modelValue","title"])]),e("div",Ft,[E(t(S,{icon:"pen","button-text":"기사화",onClick:y},null,512),[[i,"기사화"]]),E(t(S,{icon:"x-mark",onClick:l},null,512),[[i,"취소"]])])]),(s(!0),b(J,null,Z(C.value,(u,c)=>(s(),b("div",{key:`${c}_${u.fieldType}`,class:te(["p-2 bg-white dark:bg-dark border dark:border-dark-border rounded-md",u.fieldType==="single"?"h-20":u.fieldType==="multi"?"h-28":"h-full"])},[u.fieldType==="editor"?(s(),b("div",Nt,[e("label",{for:u.fieldType,class:"block text-xs font-medium text-gray-700 dark:text-dark-gray-200 mb-2"},O(u.fieldName),9,Bt),e("div",Lt,[t(ae,{modelValue:T.value[c].fieldContent,"onUpdate:modelValue":D=>T.value[c].fieldContent=D,readonly:""},null,8,["modelValue","onUpdate:modelValue"])])])):$("",!0),u.fieldType==="single"?(s(),b(J,{key:1},[e("label",{for:u.fieldType,class:"block text-xs font-medium text-gray-700 dark:text-dark-gray-200 mb-2"},O(u.fieldName),9,Ut),t(H,{modelValue:T.value[c].fieldContent,"onUpdate:modelValue":D=>T.value[c].fieldContent=D,name:u.fieldName,class:"flex-1",disabled:""},null,8,["modelValue","onUpdate:modelValue","name"])],64)):$("",!0),u.fieldType==="multi"?(s(),b(J,{key:2},[e("label",{for:u.fieldType,class:"block text-xs font-medium text-gray-700 dark:text-dark-gray-200 mb-2"},O(u.fieldName),9,St),t(Q,{modelValue:T.value[c].fieldContent,"onUpdate:modelValue":D=>T.value[c].fieldContent=D,rows:3,disabled:""},null,8,["modelValue","onUpdate:modelValue"])],64)):$("",!0)],2))),128))]),_:1}),t(F(K),{class:"flex flex-col space-y-2 justify-between","min-size":"30",size:"30"},{default:Y(()=>[e("div",Ot,[t(ot,{onOnSaveComment:z}),t($t,{comments:w.value,class:"overflow-y-auto",onOnSave:B,onOnDelete:G,onOnEdit:j},null,8,["comments"])]),e("div",Rt,[e("div",null,[n[3]||(n[3]=e("p",{class:"mb-2 dark:text-white text-xs"},"첨부파일",-1)),t(ie,{"file-data":a.value,"onUpdate:fileData":n[1]||(n[1]=u=>a.value=u),mode:"read","is-read-only":"",onOnDownloadFile:h},null,8,["file-data"])])])]),_:1})]),_:1}))])}}}),Et={key:0,class:"flex flex-col h-full gap-y-3"},Pt={class:"flex justify-between w-full"},Yt={class:"flex justify-between items-center gap-1.5"},zt={class:"flex justify-center items-center gap-x-1.5"},At={class:"flex flex-col h-full"},il=q({__name:"BoardView",setup(R){const I=de(),d=m(),v=m([]),f=m(),w={searchRangeDate:[ce().subtract(1,"day").format("YYYY-MM-DD"),ce().format("YYYY-MM-DD")],searchText:""},r=_e({...w}),p=m(),k=m(1),a=m(),C=m(!1),T=m(!1),M=m(!1),N=m(!1),z=async()=>{const x={adminYn:!0,useYn:!0},_=await I.board.basic.findAll(x);_.success&&(d.value=[..._.data])},j=async()=>{const x=await I.board.basic.findDetailBoard(a.value.bbId,!0);x.success&&(a.value=x.data)},B=async()=>{const x={bbId:a.value.bbId,param:{searchValue:r.searchText,startDate:r.searchRangeDate[0],endDate:r.searchRangeDate[1],page:k.value-1,size:20}},_=await I.board.basic.findAllPost(x.bbId,x.param);if(_.success){v.value=_.data.content,p.value={isShow:!0,page:k.value,totalPages:_.data.totalPages,totalElements:_.data.totalElements,numberOfElements:_.data.numberOfElements,size:_.data.size};const P=[];_.data.content.forEach(W=>{P.push({...W,isChildren:!1}),W.children.length&&P.push(...W.children.map(be=>({...be,isChildren:!0})))}),v.value=P}},G=async x=>{r.searchRangeDate=x,await B()},L=async x=>{r.searchText=x,await B()},h=async x=>{a.value=x,await B()},y=async x=>{try{const _={bbmTitl:x.bbmTitl,attcFileIds:x.attcFileIds,boardMemoFieldList:x.boardMemoFieldList};(await I.board.basic.createPost(a.value.bbId,_)).success&&(window.Notify.success({message:"작성 완료되었습니다."}),await B())}catch(_){window.Notify.error({message:"서버 연결이 불안정합니다."}),console.log("Fail to create to board post",_)}},l=async x=>{const _={bbmTitl:x.bbmTitl,attcFileIds:x.attcFileIds,boardMemoFieldList:x.boardMemoFieldList};(await I.board.basic.updatePost(f.value.bbId,f.value.bbmId,_)).success&&await B()},g=async()=>{(await I.board.basic.deletePost(f.value.bbId,f.value.bbmId)).success&&await B()},V=async()=>{k.value=1,await j(),Object.assign(r,{...w}),await B()},o=async x=>{const _={...x,hrnkBbmId:f.value.bbmId};(await I.board.basic.createPost(f.value.bbId,_)).success&&(console.log("sss"),await B())},n=()=>{C.value=!0},i=()=>{T.value=!0},u=()=>{M.value=!0},c=()=>{N.value=!0},D=x=>{f.value=x},U=x=>{k.value=x,B()};return me(async()=>{await z(),a.value=d.value[0],await B()}),(x,_)=>{const P=ee("tooltip");return s(),b("div",null,[!C.value&&!T.value&&!M.value&&!N.value?(s(),b("div",Et,[e("div",Pt,[e("div",Yt,[t(ge,{modelValue:r.searchRangeDate,"onUpdate:modelValue":_[0]||(_[0]=W=>r.searchRangeDate=W),onChange:G},null,8,["modelValue"]),t(Ce,{"search-value":r.searchText,class:"gap-1.5","onClick:search":L},null,8,["search-value"])]),e("div",zt,[E(t(F(S),{icon:"arrow-path",onClick:V},null,512),[[P,"새로고침"]]),E(t(F(S),{icon:"plus",onClick:n},null,512),[[P,"추가"]]),E(t(F(S),{icon:"pencil",onClick:i},null,512),[[P,"수정"]]),E(t(F(S),{icon:"chat-bubble-oval-left-ellipsis",onClick:u},null,512),[[P,"댓글"]]),E(t(we,{icon:"trash","delete-count":1,onOnConfirm:g},null,512),[[P,"삭제"]])])]),e("div",At,[t(F(le),{class:"default-theme"},{default:Y(()=>[t(F(K),{class:"flex flex-col h-full","min-size":"20",size:"20"},{default:Y(()=>[t(Qe,{"board-group":d.value,onClickBoard:h},null,8,["board-group"])]),_:1}),t(F(K),{size:"80",class:"flex flex-col h-full gap-1.5"},{default:Y(()=>[t(We,{"row-data":v.value,"page-info":p.value,onSelectedRows:D,onDoubleClickedRow:c,onOnChangePage:U},null,8,["row-data","page-info"])]),_:1})]),_:1})])])):$("",!0),N.value?(s(),A(Mt,{key:1,"selected-board-template-list":a.value.boardMemoFieldTemplateList,"bb-id":f.value.bbId,"bbm-id":f.value.bbmId,class:"flex flex-col h-full",onClose:_[1]||(_[1]=W=>N.value=!1)},null,8,["selected-board-template-list","bb-id","bbm-id"])):$("",!0),C.value?(s(),A(Se,{key:2,class:"flex flex-col h-full","selected-board-template-list":a.value.boardMemoFieldTemplateList,onClose:_[2]||(_[2]=W=>C.value=!1),onOnSave:y},null,8,["selected-board-template-list"])):$("",!0),T.value?(s(),A(Je,{key:3,class:"flex flex-col h-full","selected-board-template-list":a.value.boardMemoFieldTemplateList,"bb-id":f.value.bbId,"bbm-id":f.value.bbmId,onClose:_[3]||(_[3]=W=>T.value=!1),onOnSave:l},null,8,["selected-board-template-list","bb-id","bbm-id"])):$("",!0),M.value?(s(),A(tt,{key:4,class:"flex flex-col h-full",onOnSave:o,onClose:_[4]||(_[4]=W=>M.value=!1)})):$("",!0)])}}});export{il as default};
