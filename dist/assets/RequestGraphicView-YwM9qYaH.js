var xt=Object.defineProperty;var kt=(_,s,e)=>s in _?xt(_,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):_[s]=e;var Y=(_,s,e)=>(kt(_,typeof s!="symbol"?s+"":s,e),e);import{d as H,a as m,c as F,aj as ne,j as a,aN as Qe,G as l,ak as at,V as be,a5 as me,aD as se,k as u,l as he,o as Le,t as oe,ai as Be,Y as r,Q as $e,aM as Ye,a2 as B,K as P,a0 as z,a1 as E,F as Se,C as Ue,h as S,al as lt,am as st,aO as ze,w as K,an as _e,ao as ot,ah as ve,ad as it,eE as qt,az as Ke,c6 as nt,as as Fe,X as Me,a3 as Ae,aG as rt,b8 as Gt,bf as wt,ab as dt,ae as Pe,W as ut,ag as ct,$ as Ne,a6 as Xe,af as Ct,L as Rt,r as Vt,R as Tt}from"./index-eLyz9_Ts.js";import{g as et,M as Nt}from"./splitpanes.es-dEoJOrhT.js";import{G as Oe}from"./GSingleSelect-7u8H0FdH.js";import"./tag-Q73uuSte.js";import"./program-omP_c4K3.js";import"./article-type.code-5cb8riL1.js";import{_ as Ie}from"./UserSelect.vue_vue_type_script_setup_true_lang-Hk5THi0e.js";import"./category-zIRntbmZ.js";import"./vue-multiselect-Yz8FsF-E.js";import"./department-wnuBQoCo.js";import{_ as pt,R as tt}from"./request-state-code-yOgGt4ZJ.js";import{_ as $t}from"./GraphicList.vue_vue_type_script_setup_true_lang-x5cvglMw.js";import{N as xe}from"./no-image-ERwb0SRC.js";import{G as ke}from"./GTextarea-5GIFD2Mo.js";import{_ as Je}from"./GDatePicker.vue_vue_type_style_index_0_lang-aP5TJiAZ.js";import{_ as De}from"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";import{_ as Mt}from"./TotalWorkflow.vue_vue_type_script_setup_true_lang-RSVNUNvR.js";import{r as mt}from"./use-render-component-K20sHqiA.js";import{_ as Dt}from"./ConfirmButton.vue_vue_type_script_setup_true_lang-onM9evN8.js";import{u as Lt,_ as St}from"./MediaList.vue_vue_type_script_setup_true_lang-dRAm6bIZ.js";import{u as ht}from"./request-video-E7HyVAPm.js";import{_ as Ee}from"./FileListView.vue_vue_type_script_setup_true_lang-A40KFqZZ.js";import{_ as Ut}from"./RequestItemImage.vue_vue_type_script_setup_true_lang-9Wg4vW2c.js";import{a as At}from"./use-request-graphic-XV-ZVIJE.js";import{u as Ot}from"./use-model-wrapper-XtiLc3Xd.js";import{R as ft}from"./async-validator.util-IJrtpoc1.js";import{_ as Et}from"./FileDropzone.vue_vue_type_script_setup_true_lang-SVeHifZw.js";import{F as vt}from"./file-division-code-x51qUgaH.js";import{u as bt}from"./file-Gx0JxWZZ.js";import{u as It}from"./request-graphic-xqdmz7er.js";import"./ArticleTypeSelect.vue_vue_type_script_setup_true_lang-Kp5wzGNr.js";import"./ArticleSearchTabPanel.vue_vue_type_script_setup_true_lang-t50ochUl.js";import"./format.util-TjqX3dGB.js";import"./time-formatter-ySAnBDjB.js";import"./journalist-QNhBHHjf.js";import"./organization-qjYuRO6g.js";import"./html-dompurify.util-O5obI-gX.js";import"./purify.es-OZOo_0xz.js";import"./IconLabel.vue_vue_type_script_setup_true_lang-1rGRsbjZ.js";import"./VDCEditor.vue_vue_type_script_setup_true_lang-IhnNo6sk.js";import"./edtior.helper-P5juSeN5.js";import"./ArticleHeader.vue_vue_type_script_setup_true_lang-yXyrXb9T.js";import"./use-pagination-JgK9yJDA.js";import"./ContentHeaderButtons.vue_vue_type_script_setup_true_lang-Db8CUXqr.js";import"./FormItem.vue_vue_type_script_setup_true_lang-ZXQ_7x89.js";import"./OrganizationSelect.vue_vue_type_script_setup_true_lang-BNuugYEX.js";import"./ProgramSelect.vue_vue_type_script_setup_true_lang-UHoCrnxw.js";import"./InjestDefaultForm.vue_vue_type_script_setup_true_lang-5k6d6I19.js";import"./FormLabel.vue_vue_type_script_setup_true_lang-SB4ukE1P.js";import"./VideoCoverageDetailModal.vue_vue_type_script_setup_true_lang-kK6MFMJO.js";import"./GEditor.vue_vue_type_script_setup_true_lang-a2qGOvtc.js";import"./GEditor.vue_vue_type_style_index_0_lang-FifEywK1.js";import"./make-grid-column-aeLSdEws.js";import"./GRadioGroup-cHw1G1ew.js";/* empty css                                                                    */import"./CommentV2.vue_vue_type_script_setup_true_lang-bRF2pab6.js";/* empty css                                                                  */import"./use-date-GeeGTbYh.js";import"./PageLoader.vue_vue_type_script_setup_true_lang-ZvbvX14z.js";import"./coverage-plan-nI7mLZOB.js";import"./GVideoPlayer-1SUF8s3O.js";import"./main-sHItgwS4.js";import"./vue.runtime.esm-bundler-3P3R-Xon.js";const Ft=["data-field"],Pt=H({__name:"AttachActionMenu",props:{rowIndex:{},params:{}},emits:["on-click-mam-link","on-click-delete"],setup(_,{emit:s}){const e=_,c=s,n=()=>{c("on-click-mam-link",e.params.data)},G=()=>{c("on-click-delete",e.params.data)};return(t,h)=>(m(),F("div",{"data-field":`${t.rowIndex}`,class:"flex items-center space-x-2"},[ne(l(at,{icon:"arrow-top-right-on-square",onClick:n},null,512),[[a(Qe),"MAM"]]),ne(l(Dt,{icon:"trash","button-type":"icon",title:`${e.params.data.mediaTitle}`,html:"<div>을(를) 삭제하시겠습니까?</div>",onOnConfirm:G},null,8,["title"]),[[a(Qe),"휴지통"]])],8,Ft))}});class Wt{constructor(){Y(this,"INSERT",{id:"req_grph_div_001",name:"기사 인서트 CG",label:"기사 인서트 CG"});Y(this,"TALK",{id:"req_grph_div_002",name:"대담 CG",label:"대담 CG"});Y(this,"DVE",{id:"req_grph_div_003",name:"DVE",label:"DVE"});Y(this,"PANO",{id:"req_grph_div_004",name:"PANO",label:"PANO"});Y(this,"PRODUCT",{id:"req_grph_div_005",name:"제작 CG",label:"제작 CG"});Y(this,"ETC",{id:"req_grph_div_006",name:"기타",label:"기타"});Y(this,"values",[this.INSERT,this.TALK,this.DVE,this.PANO,this.PRODUCT,this.ETC])}}const Ze=new Wt;class jt{constructor(){Y(this,"allOption",{id:"",name:"상태 전체",label:"상태 전체"});Y(this,"PENDING",{id:"pending",name:"준비",label:"준비"});Y(this,"WORKING",{id:"working",name:"작업중",label:"작업중"});Y(this,"REJECT",{id:"reject",name:"반려",label:"반려"});Y(this,"COMPLETE",{id:"complete",name:"완료",label:"완료"});Y(this,"values",[this.allOption,this.PENDING,this.WORKING,this.REJECT,this.COMPLETE])}}const We=new jt,Bt={class:"h-full"},Yt={key:0,class:"flex flex-col h-full space-y-3 p-1 relative"},zt={class:"flex space-x-2"},Kt={key:0},Jt={class:"font-bold text-gray-800 dark:text-dark-gray-200"},Zt={class:"flex flex-col space-y-2 pb-2 border-b dark:border-dark-border"},Ht={key:0,class:"flex items-center space-x-2"},Qt={class:"flex flex-col space-y-2"},Xt={key:0},ea={class:"sm:text-xs text-xs font-medium text-gray-700 dark:text-white"},ta={class:"pb-2 border-b dark:border-dark-border"},aa={class:"flex items-center space-x-2"},la={key:1,class:"flex flex-col space-y-3"},sa={class:"font-bold text-gray-800 dark:text-dark-gray-200"},oa={class:"flex flex-col space-y-2 pb-2 border-b dark:border-dark-border"},ia=["src"],na=["src"],ra={class:"flex flex-col space-y-2"},da={class:"flex items-center space-x-2"},ua={class:"flex items-center space-x-2"},ca={class:"flex items-center space-x-2 pb-2 border-b dark:border-dark-border"},pa=H({__name:"GraphicMetaData",props:{requestId:{},requestItem:{default:void 0},isLoading:{type:Boolean}},setup(_){const s=_,e=be({code:"",codeName:""}),c=be({code:"",codeName:""}),{t:n}=me(),G=se(),t="http://192.168.1.11:9000/api/files",h=u(),$=u(),g=u(),w=u(),I=u({explain:"",templateItemName:"",remark:"",thumbnailUrl:"",workerName:"",workerUserId:"",workerPhoneNumber:"",updaterUserId:"",updaterName:"",updateDateTime:"",inputerUserId:"",inputerName:"",inputDateTime:""}),N=async()=>{try{const k=await G.request.graphic.findOne(s==null?void 0:s.requestId);k.success&&(h.value=k.data,e.code=k.data.divisionCode,e.codeName=k.data.divisionCodeName,c.code=k.data.statusCode,c.codeName=k.data.statusCodeName,$.value=`${k.data.confirmerName}(${k.data.confirmerId})`,g.value=`${k.data.inputerName}(${k.data.inputerUserId})`,w.value=k.data.referrerList)}catch(k){console.log("Fail to get detail request graphic",k)}},b=he(()=>{let k;switch(c.code){case We.REJECT.id:k="red";break;case We.WORKING.id:k="blue";break;case We.COMPLETE.id:k="primary";break;default:k="gray"}return k});return Le(()=>{N()}),oe(()=>[s.requestId,s.isLoading],()=>{s.requestId&&!s.isLoading&&N()}),oe(()=>s.requestItem,()=>{var k,v;s.requestItem&&(console.log(s.requestItem),I.value={explain:s.requestItem.graphicTemplateItem.explain,templateItemName:s.requestItem.graphicTemplateItem.templateItemName,remark:s.requestItem.remark,thumbnailUrl:((k=s.requestItem.graphicTemplateItem.file)==null?void 0:k.thumbnailUrl)||((v=s.requestItem.graphicTemplateItem.file)==null?void 0:v.fileUrl),workerName:s.requestItem.workerName,workerUserId:s.requestItem.workerUserId,workerPhoneNumber:s.requestItem.workerPhoneNumber,updaterUserId:s.requestItem.graphicTemplateItem.updaterUserId,updaterName:s.requestItem.graphicTemplateItem.updaterName,updateDateTime:s.requestItem.graphicTemplateItem.updateDateTime,inputerUserId:s.requestItem.graphicTemplateItem.inputerUserId,inputerName:s.requestItem.graphicTemplateItem.inputerName,inputDateTime:s.requestItem.graphicTemplateItem.inputDateTime})},{immediate:!0}),(k,v)=>{var i;const C=Be("tooltip");return m(),F("div",Bt,[h.value?(m(),F("div",Yt,[v[19]||(v[19]=r("div",{class:"space-y-1 sm:text-xs text-xs font-medium text-gray-700 dark:text-white"},"상태",-1)),r("div",zt,[l(Ye,{class:$e("h-8"),color:b.value,text:c.codeName},null,8,["color","text"]),e.code===a(Ze).INSERT.id?(m(),F("div",Kt,[ne(l(B,{icon:"film","button-text":a(n)("RequestMetaData.검수요청")},null,8,["button-text"]),[[C,a(n)("RequestMetaData.영상팀_검수")]])])):P("",!0)]),r("h4",Jt,z(a(n)("GraphicMetaData.의뢰_정보")),1),r("section",Zt,[l(E,{modelValue:h.value.title,"onUpdate:modelValue":v[0]||(v[0]=p=>h.value.title=p),label:"기사 제목/프로그램명",disabled:""},null,8,["modelValue"]),l(E,{modelValue:e.codeName,"onUpdate:modelValue":v[1]||(v[1]=p=>e.codeName=p),label:a(n)("GraphicMetaData.의뢰항목"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:h.value.content,"onUpdate:modelValue":v[2]||(v[2]=p=>h.value.content=p),label:"비고",disabled:""},null,8,["modelValue"]),l(Je,{modelValue:h.value.broadcastDate,"onUpdate:modelValue":v[3]||(v[3]=p=>h.value.broadcastDate=p),class:"flex-1",label:"방송일",disabled:""},null,8,["modelValue"])]),h.value.confirmerId?(m(),F("div",Ht,[l(E,{modelValue:$.value,"onUpdate:modelValue":v[4]||(v[4]=p=>$.value=p),label:a(n)("GraphicMetaData.검수자"),class:"flex-1",disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:h.value.confirmerPhoneNumber,"onUpdate:modelValue":v[5]||(v[5]=p=>h.value.confirmerPhoneNumber=p),class:"flex-1",label:a(n)("GraphicMetaData.연락처"),disabled:""},null,8,["modelValue","label"])])):P("",!0),r("section",Qt,[(i=w.value)!=null&&i.length?(m(),F("div",Xt,[r("span",ea,z(a(n)("GraphicMetaData.참조자")),1),(m(!0),F(Se,null,Ue(w.value,p=>(m(),F("div",{key:p.id,class:"flex items-center space-x-2 space-y-1"},[l(E,{modelValue:p.userName,"onUpdate:modelValue":y=>p.userName=y,class:"flex-1",label:a(n)("GraphicMetaData.이름"),disabled:""},null,8,["modelValue","onUpdate:modelValue","label"]),l(E,{modelValue:p.phoneNumber,"onUpdate:modelValue":y=>p.phoneNumber=y,class:"flex-1",label:a(n)("GraphicMetaData.연락처"),disabled:""},null,8,["modelValue","onUpdate:modelValue","label"])]))),128))])):P("",!0)]),r("section",ta,[r("div",aa,[l(E,{modelValue:g.value,"onUpdate:modelValue":v[6]||(v[6]=p=>g.value=p),class:"flex-1",label:a(n)("GraphicMetaData.의뢰자"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:h.value.inputerDepartmentName,"onUpdate:modelValue":v[7]||(v[7]=p=>h.value.inputerDepartmentName=p),class:"flex-1",label:a(n)("GraphicMetaData.부서"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:h.value.inputerPhoneNumber,"onUpdate:modelValue":v[8]||(v[8]=p=>h.value.inputerPhoneNumber=p),class:"flex-1",label:a(n)("GraphicMetaData.연락처"),disabled:""},null,8,["modelValue","label"])])]),k.requestItem?(m(),F("div",la,[r("h4",sa,z(a(n)("GraphicMetaData.의뢰_템플릿")),1),r("section",oa,[I.value.thumbnailUrl?(m(),F("img",{key:0,src:`${t}/${I.value.thumbnailUrl}`,alt:"image",class:"h-40 aspect-video rounded-md flex-1"},null,8,ia)):P("",!0),I.value.thumbnailUrl?P("",!0):(m(),F("img",{key:1,src:a(xe),alt:"no-image",class:"h-40 aspect-video rounded-md flex-1"},null,8,na)),l(E,{modelValue:I.value.templateItemName,"onUpdate:modelValue":v[9]||(v[9]=p=>I.value.templateItemName=p),label:a(n)("GraphicMetaData.템플릿_이름"),disabled:""},null,8,["modelValue","label"]),l(ke,{modelValue:I.value.explain,"onUpdate:modelValue":v[10]||(v[10]=p=>I.value.explain=p),rows:3,label:a(n)("GraphicMetaData.템플릿_설명"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:I.value.remark,"onUpdate:modelValue":v[11]||(v[11]=p=>I.value.remark=p),label:a(n)("GraphicMetaData.비고"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:h.value.content,"onUpdate:modelValue":v[12]||(v[12]=p=>h.value.content=p),label:a(n)("GraphicMetaData.내용"),disabled:""},null,8,["modelValue","label"])]),r("div",ra,[r("div",da,[l(E,{modelValue:I.value.workerName,"onUpdate:modelValue":v[13]||(v[13]=p=>I.value.workerName=p),class:"flex-1",label:a(n)("GraphicMetaData.작업자"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:I.value.workerPhoneNumber,"onUpdate:modelValue":v[14]||(v[14]=p=>I.value.workerPhoneNumber=p),class:"flex-1",label:a(n)("GraphicMetaData.연락처"),disabled:""},null,8,["modelValue","label"])]),r("div",ua,[l(E,{modelValue:I.value.inputerName,"onUpdate:modelValue":v[15]||(v[15]=p=>I.value.inputerName=p),class:"flex-1",label:a(n)("GraphicMetaData.작성자"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:I.value.inputDateTime,"onUpdate:modelValue":v[16]||(v[16]=p=>I.value.inputDateTime=p),class:"flex-1",label:a(n)("GraphicMetaData.작성일시"),disabled:""},null,8,["modelValue","label"])]),r("div",ca,[l(E,{modelValue:I.value.updaterName,"onUpdate:modelValue":v[17]||(v[17]=p=>I.value.updaterName=p),class:"flex-1",label:a(n)("GraphicMetaData.수정자"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:I.value.updateDateTime,"onUpdate:modelValue":v[18]||(v[18]=p=>I.value.updateDateTime=p),class:"flex-1",label:a(n)("GraphicMetaData.수정일시"),disabled:""},null,8,["modelValue","label"])])])])):P("",!0)])):P("",!0)])}}}),je=H({__name:"RequestAttachList",props:{rowData:{default:()=>[]}},emits:["selected-row","on-delete-file"],setup(_,{emit:s}){const e=s,c=t=>{const h=document.createElement("div"),$={params:t,rowIndex:t.rowIndex,onOnClickMamLink:g=>{console.log("mam link :: ",g)},onOnClickDelete:g=>{e("on-delete-file",g)}};return mt(Pt,$,h)},n=[{headerName:"순번",maxWidth:60,valueGetter:"node.rowIndex",cellClass:"flex items-center",cellRenderer:t=>st(t)},{headerName:"파일명",field:"mediaTitle",cellClass:"flex items-center",sortable:!1,minWidth:160},{headerName:"상태",field:"statusCode",minWidth:100,cellClass:"flex items-center",cellRenderer:Ye,cellRendererParams:t=>({text:t.data.mediaStatusName,color:Lt(t.data.mediaStatusCode)})},{headerName:"용량",field:"proxy.filesize",cellClass:"flex items-center"},{headerName:"ACTION",sortable:!1,cellClass:"flex items-center",cellRenderer:t=>c(t)}],G=t=>{const h=t[0];e("selected-row",h)};return(t,h)=>(m(),S(lt,{"row-data":t.rowData,"column-defs":n,onSelectedRows:G},null,8,["row-data"]))}}),He=ze("graphic-item",{actions:{async fetchRequestedGraphicItems(_){try{return await(await se()).request.graphicItem.findAll(_)}catch(s){console.error(s)}},async fetchRequestedGraphicItem(_){try{return await(await se()).request.graphicItem.findOne(_)}catch(s){console.error(s)}}}}),ma={class:"flex flex-col h-full"},ha={key:1,class:"flex flex-col h-full"},fa=H({__name:"RequestAttachPreview",props:{requestType:{},requestId:{default:0},isLoading:{type:Boolean},isShowRecode:{type:Boolean,default:!0},isShowFiles:{type:Boolean,default:!0}},setup(_){const s=_,e=u(),c=u(),n=be({url:"",thumbnail:"",fileType:"video"}),G=be({url:"",thumbnail:"",fileType:"video"}),{fetchRequestVideo:t,deleteRequestVideoFile:h}=ht(),{fetchRequestedGraphicItem:$}=He(),g=u([]),w=u([]),I=he(()=>[{id:1,name:"더빙",isShow:s.isShowRecode},{id:2,name:"첨부파일",isShow:s.isShowFiles}].filter(i=>i.isShow)),N=async()=>{try{const i=await t(s==null?void 0:s.requestId);i.success&&(g.value=i.data.attachmentFileList||[],w.value=i.data.reporterAudioFileList||[])}catch(i){console.log("Fail to get detail request video",i)}},b=async()=>{try{const i=await $(s.requestId);i.success&&(g.value=i.data.attachmentFileList||[])}catch(i){console.error(i)}},k=i=>{var p,y,U;e.value=i==null?void 0:i.data,n.thumbnail=(p=i==null?void 0:i.data)==null?void 0:p.thumbnail,n.url=(y=i==null?void 0:i.data)==null?void 0:y.proxy,n.fileType=(U=i==null?void 0:i.data)==null?void 0:U.mediaTypeCode},v=i=>{var p,y,U;c.value=i==null?void 0:i.data,n.thumbnail=(p=i==null?void 0:i.data)==null?void 0:p.thumbnail,G.url=(y=i==null?void 0:i.data)==null?void 0:y.proxy,G.fileType=(U=i==null?void 0:i.data)==null?void 0:U.mediaTypeCode},C=async i=>{(await h(i.requestVideoId,i.contentId)).success&&(window.Notify.success({message:ve.requestVideo.deleteFile}),await N())};return oe(()=>[s.requestId,s.isLoading],()=>{s.requestId&&!s.isLoading&&(s.requestType==="video"?N():b())},{immediate:!0}),(i,p)=>(m(),F("div",ma,[i.requestType==="video"?(m(),S(ot,{key:0,tabs:I.value},{default:K(()=>[i.isShowRecode?(m(),S(a(_e),{key:0,unmount:!1,class:"flex flex-col h-full"},{default:K(()=>[l(Ee,{url:G.url,type:G.fileType,thumbnail:n.thumbnail},null,8,["url","type","thumbnail"]),l(je,{"row-data":w.value,onSelectedRow:v,onOnDeleteFile:C},null,8,["row-data"])]),_:1})):P("",!0),i.isShowFiles?(m(),S(a(_e),{key:1,unmount:!1,class:"flex flex-col h-full"},{default:K(()=>[l(Ee,{url:n.url,type:n.fileType,thumbnail:n.thumbnail},null,8,["url","type","thumbnail"]),l(je,{"row-data":g.value,onSelectedRow:k,onOnDeleteFile:C},null,8,["row-data"])]),_:1})):P("",!0)]),_:1},8,["tabs"])):(m(),F("div",ha,[l(Ee,{url:n.url,type:n.fileType,thumbnail:n.thumbnail},null,8,["url","type","thumbnail"]),l(je,{"row-data":g.value,onSelectedRow:k,onOnDeleteFile:C},null,8,["row-data"])]))]))}}),va={class:"flex flex-col h-full space-y-2 p-1"},ba={class:"flex justify-end"},Ia={class:"flex flex-col space-y-2 h-full"},ga={class:"flex justify-end"},ya=H({__name:"RequestMediaPreview",props:{requestStatusCode:{default:""},requestId:{default:0},requestType:{default:"video"}},emits:["selected-rows","double-clicked-row","on-click-complete","on-click-approve","on-click-reject","on-click-link","on-click-delete"],setup(_,{emit:s}){const e=_,c=s,{fetchRequestVideo:n}=ht(),{fetchRequestedGraphicItem:G}=He(),t=u(),h=u(!1),$=u(),g=u(),w=u(),I=u(),N=be({url:"",thumbnail:"",fileType:"video"}),b=u([]),k=he(()=>b.value.length>0&&b.value.every(x=>x.statusCode==="uploaded")),v=x=>{var J,Q,te;t.value=x,N.thumbnail=(J=x==null?void 0:x.data)==null?void 0:J.thumbnail,N.url=(Q=x==null?void 0:x.data)==null?void 0:Q.proxy,N.fileType=(te=x==null?void 0:x.data)==null?void 0:te.mediaTypeCode},C=async()=>{try{h.value=!0;const x=await n(e.requestId);x.success&&(I.value=x.data,b.value=x.data.requestMediaList||[],$.value=x.data.title,g.value=`${x.data.reporterName}(${x.data.reporterUserId})`,w.value=x.data.editorUserId?`${x.data.editorName}(${x.data.editorUserId})`:"")}catch(x){console.log("Fail to get detail request video item",x)}finally{h.value=!1}},i=async()=>{try{h.value=!0;const x=await G(e.requestId);x.success&&(b.value=x.data.mediaList||[])}catch(x){console.error(x)}finally{h.value=!1}},p=()=>{c("on-click-complete",e.requestId)},y=async x=>{c("on-click-approve",{requestVideoId:e.requestId,...x})},U=x=>{c("on-click-reject",{requestVideoId:e.requestId,...x})},q=x=>{c("on-click-delete",{requestVideoId:e.requestId,...x})},W=()=>{e.requestType==="video"?C():i()},O=()=>{W()};return oe(()=>e.requestId,x=>{x&&W()},{immediate:!0}),(x,J)=>(m(),F("div",va,[r("div",ba,[l(B,{icon:"arrow-path",onClick:O})]),r("div",Ia,[l(Ee,{url:N.url,type:N.fileType,thumbnail:N.thumbnail},null,8,["url","type","thumbnail"]),r("div",ga,[l(B,{"button-text":"완료",disabled:!k.value,onClick:p},null,8,["disabled"])]),l(St,{"row-data":b.value,onSelectedRow:v,onOnClickApprove:y,onOnClickReject:U,onOnClickDelete:q},null,8,["row-data"])])]))}}),_a={class:"flex flex-col h-full bg-white p-0.5 dark:bg-dark rounded-md"},xa={class:"flex flex-col h-full"},ka=H({__name:"GraphicTabPanel",props:{requestId:{default:void 0},requestItem:{default:void 0},statusCode:{default:""},isLoading:{type:Boolean,default:!1},isShowMetaData:{type:Boolean,default:!0},isShowDropZone:{type:Boolean,default:!0},isShowMAM:{type:Boolean,default:!0},isShowWorkflow:{type:Boolean,default:!0}},emits:["on-click-complete","on-click-approve","on-click-reject","on-click-delete"],setup(_,{emit:s}){const e=_,c=s,n=he(()=>[{id:1,name:"메타데이터",isShow:e.isShowMetaData},{id:2,name:"첨부파일",isShow:e.isShowDropZone},{id:4,name:"미디어",isShow:e.isShowMAM},{id:5,name:"통합이력",isShow:e.isShowWorkflow}].filter(g=>g.isShow)),G=g=>{c("on-click-complete",g)},t=async g=>{c("on-click-approve",g)},h=g=>{c("on-click-reject",g)},$=g=>{c("on-click-delete",g)};return(g,w)=>(m(),F("div",_a,[l(ot,{tabs:n.value},{default:K(()=>[g.isShowMetaData?(m(),S(a(_e),{key:0,unmount:!0,class:"flex flex-col h-full"},{default:K(()=>[g.requestId?(m(),S(pa,{key:1,"request-id":g.requestId,"request-item":g.requestItem,"is-loading":g.isLoading},null,8,["request-id","request-item","is-loading"])):(m(),S(De,{key:0}))]),_:1})):P("",!0),g.isShowDropZone?(m(),S(a(_e),{key:1,unmount:!0,class:"flex flex-col h-full"},{default:K(()=>{var I;return[l(fa,{"request-id":(I=g.requestItem)==null?void 0:I.id,"request-type":"graphic","is-loading":g.isLoading},null,8,["request-id","is-loading"])]}),_:1})):P("",!0),g.isShowMAM?(m(),S(a(_e),{key:2,unmount:!0,class:"flex flex-col h-full"},{default:K(()=>{var I;return[l(ya,{"request-id":(I=g.requestItem)==null?void 0:I.id,"request-type":"graphic","request-status-code":g.statusCode,onOnClickComplete:G,onOnClickApprove:t,onOnClickReject:h,onOnClickDelete:$},null,8,["request-id","request-status-code"])]}),_:1})):P("",!0),g.isShowWorkflow?(m(),S(a(_e),{key:3,class:"flex flex-col h-full"},{default:K(()=>[r("div",xa,[l(Mt,{id:g.requestId,type:"requestGraphic"},null,8,["id"])])]),_:1})):P("",!0)]),_:1},8,["tabs"])]))}}),qa=H({__name:"GraphicItemList",props:{rowData:{}},emits:["selected-row","double-clicked-row","on-click-worker-assign"],setup(_,{emit:s}){const e=s,c=h=>{const $=document.createElement("div");return $.className="h-full flex flex-col justify-center",mt(B,{onClick:()=>{e("selected-row",[h]),e("on-click-worker-assign")},icon:"user-plus",buttonText:"배정"},$)},n=[{headerName:"",minWidth:65,maxWidth:80,valueGetter:"node.rowIndex",cellRenderer:h=>`의뢰${st(h)}`},{headerName:"진행상태",field:"statusCodeName",minWidth:100,cellRenderer:Ye,cellRendererParams:h=>({text:h.data.statusCodeName,color:At(h.data.statusCode)})},{headerName:"템플릿 이미지",field:"graphicTemplateItem.file.fileUrl",resizable:!1,minWidth:110,maxWidth:116,cellClass:"flex items-center justify-center flex-none",cellRenderer:Ut,cellRendererParams:h=>{var $,g;return{imageUrl:(g=($=h.data.graphicTemplateItem)==null?void 0:$.file)==null?void 0:g.fileUrl}}},{headerName:"작업자",field:"workerName",minWidth:70,maxWidth:100,cellRenderer:h=>h.data.workerId?h.value:c(h)},{headerName:"비고",field:"remark",minWidth:260},{headerName:"완료일시",field:"remark",minWidth:260},{headerName:"첨부파일",field:"fileCount",minWidth:84,valueFormatter:h=>h.data.fileCount?`${h.data.fileCount}개`:""}],G=()=>"bg-white border border-gray-200",t=h=>{e("selected-row",h)};return(h,$)=>(m(),S(lt,{"row-data":h.rowData,"column-defs":n,"get-row-class":G,"row-height":60,onSelectedRows:t},null,8,["row-data"]))}}),Ga={class:"flex flex-col h-full"},wa={key:0,class:"h-full overflow-y-auto grid grid-cols-2 md:grid-cols-3 xl:grid-cols-5 gap-2"},Ca=["onClick"],Ra=["src"],Va=["src"],Ta={class:"space-y-1 text-sm"},Na={class:"dark:text-dark-gray-200 text-gray-800 font-bold"},$a={class:"eclipseExplain dark:text-dark-gray-200 text-gray-500"},Ma=H({__name:"GraphicTemplateItemList",props:{selectedTemplate:{}},emits:["on-select"],setup(_,{emit:s}){const e=_,c=s,n=se(),G=u(1),t=u(it.sm),h=u("asc"),$=u(""),g=u(),w=u([]),I=u({isShow:!1,page:1,totalElements:0,totalPages:1,numberOfElements:0,size:t.value}),N=u(!1),b=u(),k=async()=>{const y={page:G.value-1,size:t.value,sort:h.value,searchValue:$.value,graphicTemplateId:g.value};try{N.value=!0;const U=await n.graphicTemplate.item.findAll(y);U.success&&(b.value=U.data.content,I.value={isShow:!0,page:G.value,totalElements:U.data.totalElements,totalPages:U.data.totalPages,numberOfElements:U.data.numberOfElements,size:U.data.size}),console.log(b.value)}catch(U){console.log("Fail to get graphic template list",U)}finally{N.value=!1}};oe(()=>e.selectedTemplate,async()=>{var y;g.value=(y=e.selectedTemplate)==null?void 0:y.id,await k()},{deep:!0}),Le(()=>{k()});const v=y=>{G.value=y,k()},C=y=>w.value.some(U=>U.id===y),i=y=>{C(y.id)?w.value=w.value.filter(U=>U.id!==y.id):w.value.push(y)},p="http://192.168.1.11:9000/api/files";return oe(()=>w.value,()=>{c("on-select",w.value)},{deep:!0}),(y,U)=>(m(),F("div",Ga,[!N.value&&b.value?(m(),F("div",wa,[(m(!0),F(Se,null,Ue(b.value,q=>{var W,O;return m(),F("div",{key:q.id,class:$e(["h-auto max-w-full rounded-lg cursor-pointer",{"border-2 p-1 border-primary":C(q.id)}]),onClick:x=>i(q)},[(W=q==null?void 0:q.file)!=null&&W.fileUrl?(m(),F("img",{key:0,src:`${p}/${(O=q==null?void 0:q.file)==null?void 0:O.fileUrl}`,alt:"image",class:"w-full aspect-video rounded-md"},null,8,Ra)):(m(),F("img",{key:1,src:a(xe),alt:"no-image",class:"w-full aspect-video rounded-md"},null,8,Va)),r("div",Ta,[r("p",Na,z(q==null?void 0:q.templateItemName),1),r("div",$a,z(q==null?void 0:q.explain),1)])],10,Ca)}),128))])):P("",!0),l(qt,{"page-info":I.value,onOnChangePage:v},null,8,["page-info"])]))}}),Da=Ke(Ma,[["__scopeId","data-v-a5b01d0b"]]),La=ze("graphic-template",{state:()=>({isLoading:!1,graphicTemplateList:[]}),getters:{getGraphicTemplate(_){return _.graphicTemplateList},getAllOptions(){return _=>({id:"",label:_,name:_})}},actions:{async fetchGraphicTemplate(){try{this.isLoading=!0;const s=await se().graphicTemplate.template.findAll();if(s.success)return this.graphicTemplateList=s.data,s}catch(_){console.log("e",_)}finally{this.isLoading=!1}}}}),Sa=H({__name:"GraphicTemplateSelect",props:{modelValue:{default:""},isAllOption:{type:Boolean,default:!1},name:{default:"grph_tmpit_nm"},label:{default:""},labelName:{default:"템플릿 전체"},isItemLabel:{type:Boolean,default:!0},preselectFirst:{type:Boolean,default:!1},required:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},placeholder:{default:"템플릿 전체"},allowEmpty:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","on-selected","on-remove"],setup(_,{emit:s}){const e=_,c=s,n=u(!1),G=Ot(e,c,"modelValue"),t=u([]),h=La(),{fetchGraphicTemplate:$,getAllOptions:g}=h,w=b=>{c("update:modelValue",b),c("on-selected",b)},I=b=>{c("update:modelValue",b),c("on-remove",b)},N=async()=>{try{n.value=!0;const b=await $();b.success&&(t.value=b.data.map(k=>({...k,name:k.templateName,label:k.templateName})),e.isAllOption&&(t.value.unshift(g(e.labelName)),G.value=t.value[0]))}catch(b){console.log("Fail to get graphic template select",b)}finally{n.value=!1}};return nt(async()=>{await N()}),(b,k)=>(m(),F("div",null,[l(Oe,{modelValue:a(G),"onUpdate:modelValue":k[0]||(k[0]=v=>Fe(G)?G.value=v:null),name:b.name,"is-loading":n.value,label:b.label?b.label:"",options:t.value,"item-label":"label","track-by":"id","allow-empty":b.allowEmpty,searchable:b.searchable,required:b.required,disabled:b.disabled,"preselect-first":b.preselectFirst,placeholder:b.placeholder,"onSelect:value":w,"onRemove:value":I},null,8,["modelValue","name","is-loading","label","options","allow-empty","searchable","required","disabled","preselect-first","placeholder"])]))}}),Ua={class:"flex flex-col h-full space-y-2"},Aa={class:"flex items-center space-x-2"},Oa={class:"flex-1 overflow-y-hidden"},Ea={class:"flex space-x-2 justify-end"},gt=H({__name:"GraphicTemplateModal",emits:["close","on-select-template-item"],setup(_,{emit:s}){const e=s,{t:c}=me(),n=u(),G=u(),t=u(),h=()=>{e("close")},$=w=>{t.value=w},g=()=>{e("on-select-template-item",t.value),h()};return(w,I)=>(m(),S(Ae,{"modal-class":"w-[90vw]","content-class":"h-[80vh]",onClose:h},{title:K(()=>[Me(z(a(c)("RequestGraphic.GraphicTemplateModal.템플릿_조회")),1)]),content:K(()=>[r("div",Ua,[r("div",Aa,[l(Sa,{modelValue:G.value,"onUpdate:modelValue":I[0]||(I[0]=N=>G.value=N),"is-all-option":"",label:a(c)("RequestGraphic.GraphicTemplateModal.템플릿_목록")},null,8,["modelValue","label"]),l(E,{modelValue:n.value,"onUpdate:modelValue":I[1]||(I[1]=N=>n.value=N),class:"self-end",placeholder:a(c)("RequestGraphic.GraphicTemplateModal.검색어"),width:"w-72"},null,8,["modelValue","placeholder"]),l(B,{class:"self-end",icon:"magnifying-glass"})]),r("div",Oa,[l(Da,{"selected-template":G.value,onOnSelect:$},null,8,["selected-template"])]),r("div",Ea,[l(B,{type:"secondary","button-text":a(c)("RequestGraphic.GraphicTemplateModal.취소"),onClick:h},null,8,["button-text"]),l(B,{"button-text":a(c)("RequestGraphic.GraphicTemplateModal.확인"),onClick:g},null,8,["button-text"])])])]),_:1}))}}),Fa={class:"flex flex-col"},Pa={class:"flex flex-col flex-wrap space-y-2 rounded-md border p-2 text-xs"},Wa={class:"flex items-center"},ja={class:"flex-1"},Ba={class:"flex-1"},yt=H({__name:"ReferrerContainer",props:{referrerList:{}},emits:["on-cancel"],setup(_,{emit:s}){const e=s,c=n=>{e("on-cancel",n)};return(n,G)=>(m(),F("div",Fa,[G[0]||(G[0]=r("span",{class:"sm:text-xs text-xs font-medium text-gray-700 dark:text-white"},"참조자 연락처",-1)),r("div",Pa,[(m(!0),F(Se,null,Ue(n.referrerList,t=>(m(),F("div",{key:t.id},[r("div",Wa,[r("div",ja,z(`${t.userName}(${t.userId})`),1),r("div",Ba,z(t.phoneNumber),1),l(at,{icon:"trash",type:"secondary",onClick:h=>c(t)},null,8,["onClick"])])]))),128))])]))}}),Ya={class:"flex flex-col space-y-2"},za={class:"self-end"},Ka={class:"sm:text-xs text-xs font-medium text-gray-700 dark:text-white"},Ja={class:"flex items-start space-x-2"},Za=["src"],Ha=["src"],Qa={class:"flex-1 space-y-2"},Xa={class:"sm:text-xs text-xs font-medium text-gray-700 dark:text-white"},_t=H({__name:"GraphicTemplateSetting",props:{templateItem:{},mode:{}},emits:["on-upload-file","on-change-remark","on-delete-file","on-delete-template-item","on-assign-worker"],setup(_,{emit:s}){const e=_,c=s,{t:n}=me(),G=se(),t=u({graphicTemplateItemId:0,graphicTemplateId:0,templateItemName:"",explain:"",thumbnailUrl:"",remark:"",fileData:[],worker:[],requestGraphicItemId:0}),h=u([]),$=u([]),g=async C=>{const i=await G.request.graphicItem.findOne(C);i.success&&(t.value.requestGraphicItemId=i.data.id,t.value.worker=i.data.workerId,t.value.graphicTemplateId=i.data.graphicTemplateItem.graphicTemplateId,t.value.graphicTemplateItemId=i.data.graphicTemplateItem.id,t.value.remark=i.data.remark,t.value.templateItemName=i.data.graphicTemplateItem.templateItemName,t.value.explain=i.data.graphicTemplateItem.explain,h.value=i.data.attachmentFileList?i.data.attachmentFileList.map(p=>({...p,name:p.mediaTitle})):[])},w=()=>{e.mode==="edit"?c("on-delete-template-item",t.value.requestGraphicItemId):c("on-delete-template-item",t.value.graphicTemplateItemId)},I=C=>{e.mode==="create"&&c("on-upload-file",C),e.mode==="edit"&&c("on-upload-file",C,h.value)},N=C=>{c("on-change-remark",C)},b=C=>{$.value=$.value.filter(i=>i.fileId!==C.fileId),c("on-delete-file",C,$.value)},k=C=>{c("on-assign-worker",t.value.requestGraphicItemId,C.id)},v=C=>{C&&(t.value.worker=[]),c("on-assign-worker",t.value.requestGraphicItemId,null)};return nt(async()=>{var C,i,p,y,U,q,W,O;if(e.mode==="edit"&&e.templateItem){await g((C=e.templateItem)==null?void 0:C.id),t.value.fileData=h.value,$.value=h.value;return}e.mode==="create"&&(t.value.graphicTemplateItemId=(i=e.templateItem)==null?void 0:i.id,t.value.graphicTemplateId=(p=e.templateItem)==null?void 0:p.graphicTemplateId,t.value.templateItemName=(y=e.templateItem)==null?void 0:y.templateItemName,t.value.explain=(U=e.templateItem)==null?void 0:U.explain,t.value.thumbnailUrl=((W=(q=e.templateItem)==null?void 0:q.file)==null?void 0:W.thumbnailUrl)||"",t.value.remark=((O=e.templateItem)==null?void 0:O.remark)||"")}),oe(()=>[$.value],()=>{t.value.fileData=$.value},{deep:!0}),oe(()=>[e.templateItem],async()=>{var C,i,p,y,U,q,W,O,x,J,Q,te,ae;e.mode==="edit"&&(await g(e.templateItem.id),t.value.graphicTemplateId=e.templateItem.graphicTemplateItem.graphicTemplateId,t.value.graphicTemplateItemId=e.templateItem.graphicTemplateItem.id,t.value.templateItemName=e.templateItem.graphicTemplateItem.templateItemName,t.value.explain=(C=e.templateItem.graphicTemplateItem)==null?void 0:C.explain,t.value.thumbnailUrl=(i=e.templateItem)==null?void 0:i.graphicTemplateItem.file,t.value.remark=((p=e.templateItem)==null?void 0:p.remark)||"",t.value.fileData=(y=e.templateItem)!=null&&y.attachmentFileList?(q=(U=e.templateItem)==null?void 0:U.attachmentFileList)==null?void 0:q.map(X=>({...X,name:X==null?void 0:X.fileNm})):h.value),e.mode==="create"&&(t.value.graphicTemplateId=e.templateItem.graphicTemplateId,t.value.graphicTemplateItemId=e.templateItem.id,t.value.templateItemName=(W=e.templateItem)==null?void 0:W.templateItemName,t.value.explain=(O=e.templateItem)==null?void 0:O.explain,t.value.thumbnailUrl=(x=e.templateItem)==null?void 0:x.thumbnailFile,t.value.remark=((J=e.templateItem)==null?void 0:J.remark)||"",t.value.fileData=(Q=e.templateItem)!=null&&Q.attachmentFileList?(ae=(te=e.templateItem)==null?void 0:te.attachmentFileList)==null?void 0:ae.map(X=>({...X,name:X.fileNm})):[])},{deep:!0}),(C,i)=>{const p=Be("tooltip");return m(),F("div",Ya,[r("div",za,[ne(l(rt,{icon:"trash",onOnConfirm:w},null,512),[[p,a(n)("RequestGraphic.GraphicTemplateSetting.삭제")]])]),r("div",null,[r("span",Ka,z(a(n)("RequestGraphic.GraphicTemplateSetting.선택_템플릿")),1),r("div",Ja,[t.value.thumbnailUrl?(m(),F("img",{key:0,src:t.value.thumbnailUrl,alt:"image",class:"h-40 aspect-video rounded-md"},null,8,Za)):P("",!0),t.value.thumbnailUrl?P("",!0):(m(),F("img",{key:1,src:a(xe),alt:"no-image",class:"h-40 aspect-video rounded-md"},null,8,Ha)),r("div",Qa,[l(E,{modelValue:t.value.templateItemName,"onUpdate:modelValue":i[0]||(i[0]=y=>t.value.templateItemName=y),label:a(n)("RequestGraphic.GraphicTemplateSetting.템플릿_이름"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:t.value.explain,"onUpdate:modelValue":i[1]||(i[1]=y=>t.value.explain=y),label:a(n)("RequestGraphic.GraphicTemplateSetting.템플릿_설명"),disabled:""},null,8,["modelValue","label"])])])]),l(ke,{modelValue:t.value.remark,"onUpdate:modelValue":[i[2]||(i[2]=y=>t.value.remark=y),N],rows:5,label:"의뢰 내용"},null,8,["modelValue"]),r("span",Xa,z(a(n)("RequestGraphic.GraphicTemplateSetting.첨부파일")),1),l(Et,{"file-data":t.value.fileData,"onUpdate:fileData":i[3]||(i[3]=y=>t.value.fileData=y),mode:C.mode,onOnUploadFile:I,onOnDeleteFile:b},null,8,["file-data","mode"]),r("div",null,[C.mode==="create"?(m(),S(Gt,{key:0,text:"등록 후 작업자 배정이 가능합니다.",type:"info"})):(m(),S(Ie,{key:1,modelValue:t.value.worker,"onUpdate:modelValue":i[4]||(i[4]=y=>t.value.worker=y),placeholder:"작업자 전체","allow-empty":"",label:a(n)("RequestGraphic.GraphicTemplateSetting.작업자"),onOnSelected:k,onOnRemove:v},null,8,["modelValue","label"]))])])}}}),el={class:"flex flex-col h-full space-y-2"},tl={class:"flex flex-1 space-x-1 overflow-y-hidden"},al={class:"flex-1 space-y-3 p-2 overflow-y-auto"},ll={class:"flex items-center space-x-2"},sl={class:"flex items-center space-x-2"},ol={class:"basis-1/4 p-2 overflow-y-auto space-y-2"},il={class:"flex items-center justify-between space-x-2"},nl={class:"dark:text-dark-gray-200 text-gray-800"},rl={key:1,class:"space-y-1"},dl=["onClick"],ul=["src"],cl={class:"space-y-1 flex-1"},pl={class:"dark:text-dark-gray-200 text-gray-800 font-bold"},ml={class:"eclipseExplain dark:text-dark-gray-200 text-gray-500"},hl={class:"flex-1 border border-gray-200 rounded-md p-2 overflow-y-auto space-y-2"},fl={class:"flex flex-col h-full"},vl={class:"flex self-end space-x-2 justify-end"},bl=H({__name:"GraphicCreateModal",props:{requestArticleTitle:{default:""},articleId:{default:0}},emits:["close","on-create"],setup(_,{emit:s}){const e=_,c=s,{requestArticleTitle:n,articleId:G}=wt(e,c),{departmentName:t,userName:h,userId:$}=dt(),{tusFileUpload:g}=bt(),{t:w}=me(),I=u(!1),N=u(),b=u(Ze.values),k=u(),v=u(),C=u(Pe().format("YYYY-MM-DD")),i=u(),p=he(()=>`${h}(${$})`),y=u(),U=u(),q=u([]),W=u([]),O=be({title:""}),{pass:x,errorFields:J}=ut(O,ft),Q=u(!1),te=()=>{Q.value=!0},ae=L=>{G.value=L.id,n.value=L.artclTitl},X=()=>{G.value=null,n.value=""},ue=()=>{c("close")},re=()=>{var Z,le;const L={title:O.title,content:i.value,articleId:G.value,divisionCode:(Z=N.value)==null?void 0:Z.id,confirmer:(le=k.value)==null?void 0:le.id,broadcastDate:C.value,referrer:W.value.map(ee=>ee==null?void 0:ee.id)},R={requestGraphicItemList:q.value};c("on-create",L,R),ue()},ie=()=>{I.value=!0},fe=L=>{W.value=W.value.filter(R=>R.id!==L.id),v.value=null},qe=L=>q.value.some(R=>R.id===L),Ge=L=>{L.forEach(R=>{qe(R.id)||q.value.push(R)})},ge=(L,R)=>{y.value=L,U.value=R},we=async L=>{var ee;const R=(ee=y.value)==null?void 0:ee.id,Z=[],le=[];if(!L)return[];for await(const de of L){const V={fileDivisionCode:vt.Graphic.id,publicYn:"Y",file:de,fileName:de.name},o=await g(V);o.success&&(q.value=q.value.map(M=>M.id===R?(le.push(o.data),Z.push(o.data.contentId),{...M,attachmentContentIdList:Z}):{...M}))}},Ce=async L=>{q.value=q.value.map(R=>{var Z;return R.id===((Z=y.value)==null?void 0:Z.id)?{...R,remark:L}:{...R}})},Re=L=>{Object.values(y.value).includes(L)&&(q.value=q.value.filter(Z=>Z.id!==L),y.value=q.value[q.value.length-1])},Ve=L=>W.value.some(R=>R.id===L),Te=L=>{Ve(L.id)||W.value.push({id:L==null?void 0:L.id,userName:L==null?void 0:L.userNm,userId:L==null?void 0:L.userId,phoneNumber:L==null?void 0:L.phoneNumber})};return oe(()=>v.value,()=>{v.value&&Te(v.value)}),oe(()=>n.value,()=>{O.title=n.value||""},{immediate:!0}),(L,R)=>(m(),S(Ae,{"modal-class":"w-[90vw] relative","content-class":"h-[80vh]",banner:!0,"alert-type":"warning","alert-text":"그래픽 의뢰 시 먼저 담당자와 논의 후 의뢰를 진행해 주시기 바랍니다. 그래픽 담당 데스커 연락처는 02-1234-5678 입니다.",onClose:ue},{title:K(()=>[Me(z(a(w)("RequestGraphic.GraphicCreateModal.그래픽의뢰_등록")),1)]),content:K(()=>{var Z,le,ee,de,V;return[r("div",el,[r("div",tl,[r("div",al,[r("div",ll,[l(E,{modelValue:a(n),"onUpdate:modelValue":R[0]||(R[0]=o=>Fe(n)?n.value=o:null),class:"flex-1","auto-complete":!1,label:a(w)("RequestGraphic.GraphicCreateModal.의뢰_정보.기사_선택"),placeholder:a(w)("RequestGraphic.GraphicCreateModal.의뢰_정보.기사를_선택해주세요"),disabled:!0},null,8,["modelValue","label","placeholder"]),(Z=a(n))!=null&&Z.length?(m(),S(B,{key:1,class:"self-end",icon:"trash",type:"secondary",onClick:X})):(m(),S(B,{key:0,class:"self-end",icon:"magnifying-glass",onClick:te}))]),l(Oe,{modelValue:N.value,"onUpdate:modelValue":R[1]||(R[1]=o=>N.value=o),"track-by":"id",label:a(w)("RequestGraphic.GraphicCreateModal.의뢰_정보.의뢰_항목"),"item-label":"name",placeholder:"선택 안함","allow-empty":"",searchable:!1,options:b.value},null,8,["modelValue","label","options"]),l(E,{modelValue:O.title,"onUpdate:modelValue":R[2]||(R[2]=o=>O.title=o),"error-placeholder":!0,"error-msg":(ee=(le=a(J))==null?void 0:le.title)!=null&&ee.length?(de=a(J))==null?void 0:de.title[0].message:"",label:"기사 제목/프로그램명",required:""},null,8,["modelValue","error-msg"]),l(ke,{modelValue:i.value,"onUpdate:modelValue":R[3]||(R[3]=o=>i.value=o),rows:5,label:"비고"},null,8,["modelValue"]),l(Je,{modelValue:C.value,"onUpdate:modelValue":R[4]||(R[4]=o=>C.value=o),class:"flex-1",label:"방송일"},null,8,["modelValue"]),l(Ie,{modelValue:k.value,"onUpdate:modelValue":R[5]||(R[5]=o=>k.value=o),label:a(w)("RequestGraphic.GraphicCreateModal.의뢰_정보.검수자")},null,8,["modelValue","label"]),l(Ie,{modelValue:v.value,"onUpdate:modelValue":R[6]||(R[6]=o=>v.value=o),label:a(w)("RequestGraphic.GraphicCreateModal.의뢰_정보.참조자_추가")},null,8,["modelValue","label"]),(V=W.value)!=null&&V.length?(m(),S(yt,{key:0,"referrer-list":W.value,onOnCancel:fe},null,8,["referrer-list"])):P("",!0),r("div",sl,[l(E,{modelValue:a(t),"onUpdate:modelValue":R[7]||(R[7]=o=>Fe(t)?t.value=o:null),class:"flex-1",label:a(w)("RequestGraphic.GraphicCreateModal.의뢰_정보.부서"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:p.value,"onUpdate:modelValue":R[8]||(R[8]=o=>p.value=o),class:"flex-1",label:a(w)("RequestGraphic.GraphicCreateModal.의뢰_정보.의뢰자"),disabled:""},null,8,["modelValue","label"])])]),r("div",ol,[r("div",il,[r("div",nl," 의뢰 목록"+z(`(${q.value.length})건`),1),l(B,{"button-text":"의뢰 추가",onClick:ie})]),q.value?(m(),F("div",rl,[(m(!0),F(Se,null,Ue(q.value,(o,M)=>{var d,f;return m(),F("div",{key:o.id,class:$e(["flex text-sm relative items-center space-x-2 pr-2 h-16 max-w-full rounded-lg cursor-pointer",((d=y.value)==null?void 0:d.id)===o.id?"border border-primary-accent":"border border-gray-200"]),onClick:A=>ge(o,M)},[r("div",{class:$e(["flex px-1 h-full items-center",((f=y.value)==null?void 0:f.id)===o.id?"bg-primary-accent text-white":"bg-gray-200"])},z(M+1),3),r("div",null,[r("img",{src:a(xe),alt:"no-image",class:"h-12 w-full aspect-video rounded-md"},null,8,ul)]),r("div",cl,[r("p",pl,z(o==null?void 0:o.templateItemName),1),r("div",ml,z(o==null?void 0:o.explain),1)])],10,dl)}),128))])):(m(),S(De,{key:0}))]),r("div",hl,[r("div",fl,[R[11]||(R[11]=r("div",{class:"dark:text-dark-gray-200 text-gray-800"},"의뢰 상세",-1)),y.value?P("",!0):(m(),S(De,{key:0})),y.value?(m(),S(_t,{key:1,"template-item":y.value,mode:"create",onOnUploadFile:we,onOnChangeRemark:Ce,onOnDeleteTemplateItem:Re},null,8,["template-item"])):P("",!0)])])]),r("div",vl,[l(B,{type:"secondary","button-text":a(w)("RequestGraphic.GraphicCreateModal.취소"),onClick:ue},null,8,["button-text"]),l(B,{"button-text":a(w)("RequestGraphic.GraphicCreateModal.확인"),disabled:!a(x),onClick:re},null,8,["button-text","disabled"])]),I.value?(m(),S(gt,{key:0,onClose:R[9]||(R[9]=o=>I.value=!1),onOnSelectTemplateItem:Ge})):P("",!0)]),Q.value?(m(),S(pt,{key:0,onSelectedRequestArticle:ae,onClose:R[10]||(R[10]=o=>Q.value=!1)})):P("",!0)]}),_:1}))}}),Il=Ke(bl,[["__scopeId","data-v-8fa0fe77"]]),gl={class:"flex flex-col h-full space-y-2"},yl={class:"flex flex-1 space-x-1 overflow-y-hidden"},_l={class:"flex-1 space-y-3 p-2 overflow-y-auto"},xl={class:"flex items-center space-x-2"},kl={class:"flex items-center space-x-2"},ql={class:"basis-1/4 p-2 overflow-y-auto space-y-2"},Gl={class:"flex items-center justify-between space-x-2"},wl={class:"dark:text-dark-gray-200 text-gray-800"},Cl={key:1,class:"space-y-1"},Rl=["onClick"],Vl=["src"],Tl={class:"space-y-1 text-sm flex-1"},Nl={class:"dark:text-dark-gray-200 text-gray-800 font-bold"},$l={class:"eclipseExplain dark:text-dark-gray-200 text-gray-500"},Ml={class:"flex-1 border border-gray-200 rounded-md p-2 overflow-y-auto space-y-2"},Dl={class:"flex flex-col h-full"},Ll={class:"flex self-end space-x-2 justify-end"},Sl=H({__name:"GraphicEditModal",props:{requestGraphicId:{}},emits:["close","on-update-item","on-update"],setup(_,{emit:s}){const e=_,c=s,{fetchRequestGraphic:n}=It(),{fetchRequestedGraphicItems:G}=He(),{departmentName:t,userName:h,userId:$}=dt(),{tusFileUpload:g}=bt(),{t:w}=me(),I=se(),N=u(!1),b=u(),k=u(Ze.values),v=u(),C=u(),i=u(Pe().format("YYYY-MM-DD")),p=u(),y=he(()=>`${h}(${$})`),U=u(),q=u(),W=u(),O=u([]),x=u([]),J=be({title:""}),{pass:Q,errorFields:te}=ut(J,ft),ae=u(!1),X=()=>{ae.value=!0},ue=async V=>{var o,M;try{const d=await n(V);d.success&&(J.title=d.data.title,p.value=d.data.content||"",b.value=d.data.divisionCode,v.value=d.data.confirmerId,x.value=d.data.referrerList,i.value=d.data.broadcastDate,U.value=(o=d.data.articleDto)==null?void 0:o.id,q.value=(M=d.data.articleDto)==null?void 0:M.artclTitl)}catch(d){console.log("Fail to get detail request graphic",d)}},re=async V=>{const o={requestGraphicId:V};try{const M=await G(o);M.success&&(O.value=M.data.requestGraphicItemList)}catch(M){console.log("Fail to get request graphic item list",M)}},ie=async(V,o)=>{if(ct.isEmpty(V.requestGraphicItemList))return;const M={requestGraphicId:o};M.requestGraphicItemList=V.requestGraphicItemList.map(d=>({remark:(d==null?void 0:d.remark)||null,graphicTemplateItemId:d.id,attachmentContentIdList:(d==null?void 0:d.attachmentContentIdList)||[]}));try{(await I.request.graphicItem.create(M)).success&&(window.Notify.success({message:"[그래픽의뢰 아이템] 등록되었습니다."}),await re(e.requestGraphicId))}catch(d){console.log("Fail to add request graphic item",d)}},fe=async V=>{try{(await I.request.graphicItem.delete(V)).success&&(window.Notify.success({message:"[그래픽의뢰 아이템] 삭제되었습니다"}),await re(e.requestGraphicId),W.value=O.value[O.value.length-1])}catch(o){console.log("Fail to delete request graphic item",o)}},qe=V=>O.value.some(o=>o.graphicTemplateItem.id===V),Ge=V=>{for(const o of V)if(!qe(o.id)){const M={requestGraphicItemList:[{id:o==null?void 0:o.id}]};ie(M,e.requestGraphicId)}},ge=async V=>{W.value=V},we=async(V,o)=>{var j;if(!V)return[];let M=[];const d=[],f=[],A=(j=W.value)==null?void 0:j.id;M=o.filter(D=>"fileId"in D).map(D=>{const{fileName:ye,...ce}=D;return{fileNm:ye,...ce}});const T=M==null?void 0:M.map(D=>D.fileId);for await(const D of V){const ye={fileDivisionCode:vt.Graphic.id,publicYn:"Y",file:D,fileName:D.name},ce=await g(ye);ce.success&&(f.push(ce.data.contentId),d.push(ce.data)),O.value=O.value.map(pe=>(pe==null?void 0:pe.id)===A?{...pe,file:[...d,...M],attachmentContentIdList:[...T,...f]}:{...pe})}},Ce=async(V,o)=>{var A;console.log(V);const M=o.map(T=>{const{fileName:j,...D}=T;return{fileNm:j,...D}}),d=M.map(T=>T.fileId),f=(A=W.value)==null?void 0:A.id;O.value=O.value.map(T=>(T==null?void 0:T.id)===f?{...T,file:M,attachmentFileList:d}:{...T})},Re=async V=>{O.value=O.value.map(o=>{var M;return(o==null?void 0:o.id)===((M=W.value)==null?void 0:M.id)?{...o,remark:V}:{...o}})},Ve=async(V,o)=>{const M={workerId:o};try{(await I.request.graphicItem.assign(V,M)).success&&(window.Notify.success({message:"[그래픽의뢰 작업자 배정] 완료되었습니다"}),await re(e.requestGraphicId))}catch(d){console.log("Fail to assign worker request graphic item",d)}},Te=V=>{U.value=V.id,q.value=V.artclTitl,q.value&&(J.title=q.value)},L=()=>{U.value=null,q.value=null},R=()=>{c("close")},Z=()=>{var o,M;const V={title:J.title,content:p.value,articleId:U.value,divisionCode:(o=b.value)==null?void 0:o.id,confirmer:(M=v.value)==null?void 0:M.id,broadcastDate:i.value,referrer:x.value.map(d=>d==null?void 0:d.id)};c("on-update-item",O.value),c("on-update",V),R()},le=()=>{N.value=!0},ee=V=>{x.value=x.value.filter(o=>o.id!==V.id),C.value=null},de=async V=>{await fe(V)};return oe(()=>C.value,()=>{var V,o,M,d;C.value&&x.value.push({id:(V=C.value)==null?void 0:V.id,userName:(o=C.value)==null?void 0:o.userNm,userId:(M=C.value)==null?void 0:M.userId,phoneNumber:(d=C.value)==null?void 0:d.phoneNumber})}),Le(async()=>{var V;await ue(e.requestGraphicId),await re(e.requestGraphicId),((V=O.value)==null?void 0:V.length)>0&&await ge(O.value[0])}),(V,o)=>(m(),S(Ae,{"modal-class":"w-[90vw]","content-class":"h-[80vh]",banner:!0,onClose:R},{title:K(()=>[Me(z(a(w)("RequestGraphic.GraphicEditModal.그래픽의뢰_수정")),1)]),content:K(()=>{var M,d,f,A,T,j;return[r("div",gl,[r("div",yl,[r("div",_l,[r("div",xl,[l(E,{modelValue:q.value,"onUpdate:modelValue":o[0]||(o[0]=D=>q.value=D),class:"flex-1","auto-complete":!1,label:a(w)("RequestGraphic.GraphicEditModal.의뢰_정보.기사_선택"),placeholder:a(w)("RequestGraphic.GraphicEditModal.의뢰_정보.기사를_선택해주세요"),disabled:!!((M=q.value)!=null&&M.length)},null,8,["modelValue","label","placeholder","disabled"]),(d=q.value)!=null&&d.length?(m(),S(B,{key:1,class:"self-end",icon:"trash",type:"secondary",onClick:L})):(m(),S(B,{key:0,class:"self-end",icon:"magnifying-glass",onClick:X}))]),l(Oe,{modelValue:b.value,"onUpdate:modelValue":o[1]||(o[1]=D=>b.value=D),"track-by":"id",label:a(w)("RequestGraphic.GraphicEditModal.의뢰_정보.의뢰_항목"),"item-label":"name",placeholder:"선택 안함","allow-empty":"",searchable:!1,options:k.value},null,8,["modelValue","label","options"]),l(E,{modelValue:J.title,"onUpdate:modelValue":o[2]||(o[2]=D=>J.title=D),"error-placeholder":!0,"error-msg":(A=(f=a(te))==null?void 0:f.title)!=null&&A.length?(T=a(te))==null?void 0:T.title[0].message:"",label:"기사 제목/프로그램명",required:""},null,8,["modelValue","error-msg"]),l(ke,{modelValue:p.value,"onUpdate:modelValue":o[3]||(o[3]=D=>p.value=D),rows:5,label:"비고"},null,8,["modelValue"]),l(Je,{modelValue:i.value,"onUpdate:modelValue":o[4]||(o[4]=D=>i.value=D),class:"flex-1",label:"방송일"},null,8,["modelValue"]),l(Ie,{modelValue:v.value,"onUpdate:modelValue":o[5]||(o[5]=D=>v.value=D),label:a(w)("RequestGraphic.GraphicEditModal.의뢰_정보.검수자")},null,8,["modelValue","label"]),l(Ie,{modelValue:C.value,"onUpdate:modelValue":o[6]||(o[6]=D=>C.value=D),label:a(w)("RequestGraphic.GraphicEditModal.의뢰_정보.참조자_추가")},null,8,["modelValue","label"]),(j=x.value)!=null&&j.length?(m(),S(yt,{key:0,"referrer-list":x.value,onOnCancel:ee},null,8,["referrer-list"])):P("",!0),r("div",kl,[l(E,{modelValue:a(t),"onUpdate:modelValue":o[7]||(o[7]=D=>Fe(t)?t.value=D:null),class:"flex-1",label:a(w)("RequestGraphic.GraphicEditModal.의뢰_정보.부서"),disabled:""},null,8,["modelValue","label"]),l(E,{modelValue:y.value,"onUpdate:modelValue":o[8]||(o[8]=D=>y.value=D),class:"flex-1",label:a(w)("RequestGraphic.GraphicEditModal.의뢰_정보.의뢰자"),disabled:""},null,8,["modelValue","label"])])]),r("div",ql,[r("div",Gl,[r("div",wl," 의뢰 목록"+z(`(${O.value.length})건`),1),l(B,{"button-text":"의뢰 추가",onClick:le})]),O.value?(m(),F("div",Cl,[(m(!0),F(Se,null,Ue(O.value,D=>{var ye,ce,pe;return m(),F("div",{key:D.id,class:$e(["flex relative items-center space-x-2 p-2 h-auto max-w-full rounded-lg cursor-pointer",((ye=W.value)==null?void 0:ye.id)===(D==null?void 0:D.id)?"border border-primary-accent":"border border-gray-200"]),onClick:as=>ge(D)},[r("div",null,[r("img",{src:a(xe),alt:"no-image",class:"h-12 w-full aspect-video rounded-md"},null,8,Vl)]),r("div",Tl,[r("p",Nl,z((ce=D==null?void 0:D.graphicTemplateItem)==null?void 0:ce.templateItemName),1),r("div",$l,z((pe=D==null?void 0:D.graphicTemplateItem)==null?void 0:pe.explain),1)])],10,Rl)}),128))])):(m(),S(De,{key:0}))]),r("div",Ml,[r("div",Dl,[o[11]||(o[11]=r("div",{class:"dark:text-dark-gray-200 text-gray-800"},"의뢰 상세",-1)),O.value.length?(m(),S(_t,{key:1,"template-item":W.value,mode:"edit",onOnUploadFile:we,onOnChangeRemark:Re,onOnDeleteFile:Ce,onOnDeleteTemplateItem:de,onOnAssignWorker:Ve},null,8,["template-item"])):(m(),S(De,{key:0}))])])]),r("div",Ll,[l(B,{type:"secondary","button-text":a(w)("RequestGraphic.GraphicEditModal.취소"),onClick:R},null,8,["button-text"]),l(B,{"button-text":a(w)("RequestGraphic.GraphicEditModal.확인"),disabled:!a(Q),onClick:Z},null,8,["button-text","disabled"])]),N.value?(m(),S(gt,{key:0,onOnSelectTemplateItem:Ge,onClose:o[9]||(o[9]=D=>N.value=!1)})):P("",!0)]),ae.value?(m(),S(pt,{key:0,onSelectedRequestArticle:Te,onClose:o[10]||(o[10]=D=>ae.value=!1)})):P("",!0)]}),_:1}))}}),Ul=Ke(Sl,[["__scopeId","data-v-0b0148e0"]]),Al={class:"flex flex-col h-full"},Ol={key:0},El=H({__name:"GraphicMediaCreateModal",emits:["close"],setup(_,{emit:s}){const e=s,{t:c}=me(),n=u(!1),G=()=>{e("close")},t=()=>{n.value=!n.value};return(h,$)=>(m(),S(Ae,{"modal-class":"sm:w-[80vw]","content-class":"h-[90vh]",onClose:G},{title:K(()=>[Me(z(a(c)("RequestGraphic.GraphicMediaCreateModal.그래픽_제작본_등록")),1)]),content:K(()=>[r("div",Al,[l(E,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.폴더"),placeholder:a(c)("RequestGraphic.GraphicMediaCreateModal.폴더를_선택해주세요")},null,8,["label","placeholder"]),l(E,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.제목")},null,8,["label"]),$[1]||($[1]=r("div",null,"주의 및 처리요청 사항",-1)),l(Oe,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.보관기간")},null,8,["label"]),l(E,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.필독_주의사항")},null,8,["label"]),l(E,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.출처_및_제공")},null,8,["label"]),l(Ne,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.엠바고_여부")},null,8,["label"]),l(Ne,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.모자이크_처리_필요")},null,8,["label"]),l(Ne,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.음성변조_처리_필요")},null,8,["label"]),l(Ne,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.SBS뉴스_사용_불가")},null,8,["label"]),l(Ne,{label:a(c)("RequestGraphic.GraphicMediaCreateModal.아카이브_금지")},null,8,["label"]),l(ke,{rows:5,label:a(c)("RequestGraphic.GraphicMediaCreateModal.기타(또는_특이사항)")},null,8,["label"]),n.value?(m(),F("div",Ol,[$[0]||($[0]=r("div",null,"취재정보",-1)),l(E)])):P("",!0),r("div",{class:"cursor-default self-end flex space-x-2",onClick:t},[Me(z(n.value?a(c)("RequestGraphic.GraphicMediaCreateModal.최소화"):a(c)("RequestGraphic.GraphicMediaCreateModal.촬영정보_입력"))+" ",1),n.value?P("",!0):(m(),S(Xe,{key:0,icon:"chevron-up"})),n.value?(m(),S(Xe,{key:1,icon:"chevron-down"})):P("",!0)])])]),_:1}))}}),Fl=ze("graphic-template-item",{state:()=>({isLoading:!1,graphicTemplateItemList:[]}),getters:{getGraphicTemplate(_){return _.graphicTemplateItemList}},actions:{async fetchGraphicItems(_){try{this.isLoading=!0;const e=await se().request.graphicItem.findAll(_);if(e.success)return this.graphicTemplateItemList=e.data,e}catch(s){console.log("e",s)}finally{this.isLoading=!1}},async createGraphicItem(_){try{return await se().request.graphicItem.create(_)}catch(s){console.error(s)}},async updateGraphicItem(_,s){try{return await se().request.graphicItem.update(_,s)}catch(e){console.error(e)}},async assignGraphicItem(_,s){try{return await se().request.graphicItem.assign(_,s)}catch(e){console.error(e)}}}}),Pl={class:"space-y-3"},Wl={class:"space-y-3"},jl={class:"flex justify-center items-center"},Bl=["src"],Yl={class:"flex space-x-2"},zl={class:"flex self-end space-x-2 justify-end"},Kl=H({__name:"WorkerAssignModal",props:{requestItem:{}},emits:["close","on-assign-worker"],setup(_,{emit:s}){const e=_,c=s,n=()=>{c("close")},{t:G}=me(),t=u({worker:[],workerPhoneNumber:"",templateItemName:"",explain:""}),h=u(),$=he(()=>{var I;return((I=h.value)==null?void 0:I.phoneNumber)||""}),g=I=>{I&&(t.value.worker=null)},w=()=>{var I;console.log("worker.value",t.value.worker),c("on-assign-worker",(I=t.value.worker)==null?void 0:I.id),n()};return Le(()=>{var I;t.value={workerPhoneNumber:e.requestItem.workerPhoneNumber,templateItemName:e.requestItem.graphicTemplateItem.templateItemName,explain:((I=e.requestItem.graphicTemplateItem)==null?void 0:I.explain)||"",worker:e.requestItem.workerId}}),(I,N)=>(m(),S(Ae,{"modal-class":"sm:w-1/3",onClose:n},{title:K(()=>N[4]||(N[4]=[r("div",null,"작업자 배정",-1)])),content:K(()=>[r("div",Pl,[r("div",Wl,[r("div",jl,[r("img",{src:a(xe),alt:"no-image",class:"h-40 aspect-video rounded-md"},null,8,Bl)]),l(E,{modelValue:t.value.templateItemName,"onUpdate:modelValue":N[0]||(N[0]=b=>t.value.templateItemName=b),label:a(G)("GraphicMetaData.템플릿_이름"),disabled:""},null,8,["modelValue","label"]),l(ke,{modelValue:t.value.explain,"onUpdate:modelValue":N[1]||(N[1]=b=>t.value.explain=b),rows:3,label:a(G)("GraphicMetaData.템플릿_설명"),disabled:""},null,8,["modelValue","label"]),r("div",Yl,[l(Ie,{modelValue:t.value.worker,"onUpdate:modelValue":N[2]||(N[2]=b=>t.value.worker=b),placeholder:"작업자","allow-empty":"",class:"flex-1",label:a(G)("RequestGraphic.GraphicTemplateSetting.작업자"),onOnRemove:g},null,8,["modelValue","label"]),l(E,{modelValue:$.value,"onUpdate:modelValue":N[3]||(N[3]=b=>$.value=b),label:a(G)("Modal.RequestMovie.EditorAssignModal.연락처"),placeholder:"- 없이 숫자로 입력",class:"flex-1",disabled:""},null,8,["modelValue","label"])])]),r("div",zl,[l(B,{type:"secondary","button-text":a(G)("Modal.RequestGraphic.WorkerAssignModal.취소"),onClick:n},null,8,["button-text"]),l(B,{"button-text":a(G)("Modal.RequestGraphic.WorkerAssignModal.확인"),disabled:!t.value.worker,onClick:w},null,8,["button-text","disabled"])])])]),_:1}))}});class Jl{constructor(){Y(this,"allOption",{id:"",name:"상태 전체",label:"상태 전체"});Y(this,"PENDING",{id:"pending",name:"준비",label:"준비"});Y(this,"WORKING",{id:"working",name:"편집중",label:"편집중"});Y(this,"CHECKING",{id:"checking",name:"내부 확인중",label:"내부 확인중"});Y(this,"REVIEWING",{id:"reviewing",name:"기자 확인중",label:"기자 확인중"});Y(this,"REJECT",{id:"reject",name:"반려",label:"반려"});Y(this,"APPROVE",{id:"approve",name:"완료",label:"완료"});Y(this,"values",[this.PENDING,this.APPROVE,this.WORKING,this.REJECT]);Y(this,"allValues",[this.allOption,this.PENDING,this.WORKING,this.CHECKING,this.REVIEWING,this.REJECT,this.APPROVE])}}const Zl=new Jl,Hl={class:"flex flex-col h-full"},Ql={class:"flex justify-between flex-wrap gap-1 mb-3"},Xl={class:"flex items-center flex-wrap gap-1.5"},es={class:"space-x-1.5"},ts={class:"flex flex-col h-full space-y-2"},ho=H({__name:"RequestGraphicView",setup(_){const{t:s}=me(),{fetchRequestGraphics:e,createRequestGraphic:c,updateRequestGraphic:n,deleteRequestGraphic:G}=It(),{fetchGraphicItems:t,createGraphicItem:h,updateGraphicItem:$,assignGraphicItem:g}=Fl(),w=u(),I=u(!1),N=u([]),b=u(),k=u(),v=u(!1),C=u(!1),i=u(!1),p=u(!1),y=u(!1),U=u(),q=u(),W=u(tt.values),O=u([Pe().subtract(1,"week").format("YYYY-MM-DD"),Pe().format("YYYY-MM-DD")]),x=u(""),J=u(1),Q=u(it.sm),te=u("asc"),ae=u({isShow:!1,page:1,totalElements:0,totalPages:1,numberOfElements:0,size:Q.value}),X=u(0),ue=u(""),re=u(),ie=async()=>{var f,A;const d={page:J.value-1,size:Q.value,sort:[te.value],inputerId:((f=U.value)==null?void 0:f.id)||"",statusCode:((A=q.value)==null?void 0:A.id)||"",searchValue:x.value,startDate:O.value[0],endDate:O.value[1]};try{v.value=!0;const T=await e(d);T.success&&(N.value=T.data.content,ae.value={isShow:!0,page:J.value,totalElements:T.data.totalElements,totalPages:T.data.totalPages,numberOfElements:T.data.numberOfElements,size:T.data.size})}catch(T){console.log("Fail to get request graphic",T)}finally{v.value=!1}},fe=async d=>{if(!d)return;const A=await t({requestGraphicId:d});A.success&&(w.value=A.data.requestGraphicItemList)},qe=async d=>{var f,A;b.value=(f=d[0])==null?void 0:f.data,I.value=!0,await fe((A=b.value)==null?void 0:A.id)},Ge=d=>{b.value=d.data,i.value=!0},ge=async d=>{var f;k.value=(f=d[0])==null?void 0:f.data},we=()=>{C.value=!0},Ce=async(d,f)=>{if(ct.isEmpty(d.requestGraphicItemList))return;const A={requestGraphicId:f};A.requestGraphicItemList=d.requestGraphicItemList.map(T=>({remark:(T==null?void 0:T.remark)||null,graphicTemplateItemId:T.id,attachmentContentIdList:(T==null?void 0:T.attachmentContentIdList)||[]}));try{(await h(A)).success&&window.Notify.success({message:ve.requestGraphic.success.create})}catch(T){console.log("Fail to add request graphic item",T)}},Re=async(d,f)=>{const A={title:d.title,content:d.content,articleId:d.articleId,divisionCode:d.divisionCode,confirmerId:d.confirmer,broadcastDate:d.broadcastDate,referrerIdList:d.referrer||null};try{const T=await c(A);T.success&&(re.value=T.data.id,f&&await Ce(f,re.value),window.Notify.success({message:ve.requestGraphic.success.create}),await ie())}catch(T){console.log("Fail to add request graphic",T)}},Ve=async d=>{for await(const f of d)if(f!=null&&f.attachmentContentIdList){const{id:A}=f,T={graphicTemplateItemId:f.graphicTemplateItem.id,remark:(f==null?void 0:f.remark)||null,attachmentContentIdList:f!=null&&f.attachmentContentIdList?f==null?void 0:f.attachmentContentIdList:[]};(await $(A,T)).success&&(window.Notify.success({message:ve.requestGraphic.success.edit}),await fe(b.value.id))}},Te=async d=>{const f={title:d.title,content:d.content,articleId:d.articleId,divisionCode:d.divisionCode,confirmerId:d.confirmer,broadcastDate:d.broadcastDate,referrerIdList:d.referrer||null};try{(await n(b.value.id,f)).success&&(window.Notify.success({message:ve.requestGraphic.success.edit}),await ie())}catch(A){console.log("Fail to update request graphic",A)}},L=async()=>{b.value=null,x.value="",q.value=tt.values[0],U.value.id="",U.value.label="기획자 전체",await ie()},R=async()=>{var d;try{v.value=!0,(await G((d=b.value)==null?void 0:d.id)).success&&(window.Notify.success({message:ve.requestGraphic.success.delete}),await ie())}catch(f){console.log("Fail to delete request graphic",f)}finally{v.value=!1}},Z=()=>{i.value=!0},le=he(()=>!b.value||!k.value||k.value.statusCode===Zl.PENDING.id),ee=()=>{var f,A;const d=`https://dev-cms.sbs.co.kr/v2/file-upload?graphic_id=${(f=b.value)==null?void 0:f.id}&graphic_item_id=${(A=k.value)==null?void 0:A.id}`;window.open(d,"_blank")},de=d=>{const{articleId:f}=d.data;Vt.replace({name:Tt.ReadArticle,params:{id:f}})},V=()=>{ie()},o=()=>{y.value=!0},M=async d=>{var A;const f={workerId:d};try{(await g((A=k.value)==null?void 0:A.id,f)).success&&(window.Notify.success({message:ve.requestGraphic.success.assign}),await fe(b.value.id))}catch(T){console.log("Fail to assign worker request graphic item",T)}};return Le(()=>{ie()}),(d,f)=>{var T;const A=Be("tooltip");return m(),F("div",Hl,[r("div",Ql,[r("div",Xl,[l(Ct,{modelValue:O.value,"onUpdate:modelValue":[f[0]||(f[0]=j=>O.value=j),V]},null,8,["modelValue"]),l(a(Ie),{modelValue:U.value,"onUpdate:modelValue":f[1]||(f[1]=j=>U.value=j),class:"w-32","is-all-option":!0,"label-name":"기획자 전체","preselect-first":!0,onOnSelected:V},null,8,["modelValue"]),l(Oe,{modelValue:q.value,"onUpdate:modelValue":f[2]||(f[2]=j=>q.value=j),"track-by":"id","preselect-first":!0,"item-label":"label",searchable:!1,"allow-empty":!1,options:W.value,"onSelect:value":V},null,8,["modelValue","options"]),l(E,{modelValue:x.value,"onUpdate:modelValue":f[3]||(f[3]=j=>x.value=j),placeholder:a(s)("RequestGraphic.검색어"),width:"w-72",onKeyup:Rt(V,["enter"])},null,8,["modelValue","placeholder"]),l(B,{icon:"magnifying-glass",onClick:V})]),r("div",es,[ne(l(B,{icon:"computer-desktop","button-text":a(s)("RequestGraphic.그래픽_제작본_등록"),disabled:le.value,onClick:ee},null,8,["button-text","disabled"]),[[A,a(s)("RequestGraphic.그래픽_제작본_등록")]]),ne(l(B,{icon:"plus","button-text":a(s)("RequestGraphic.의뢰_등록"),onClick:we},null,8,["button-text"]),[[A,a(s)("RequestGraphic.의뢰_등록")]]),ne(l(B,{icon:"arrow-path",onClick:L},null,512),[[A,a(s)("RequestGraphic.새로고침")]]),ne(l(B,{icon:"pencil",disabled:!b.value,onClick:Z},null,8,["disabled"]),[[A,a(s)("RequestGraphic.의뢰_수정")]]),ne(l(B,{disabled:!b.value,icon:"document-duplicate"},null,8,["disabled"]),[[A,a(s)("RequestGraphic.의뢰_복사")]]),ne(l(rt,{icon:"trash",disabled:!b.value,onOnConfirm:R},null,8,["disabled"]),[[A,a(s)("RequestGraphic.의뢰_삭제")]])])]),l(a(Nt),{class:"default-theme"},{default:K(()=>[l(a(et),null,{default:K(()=>[r("div",ts,[l($t,{class:"w-full flex flex-1","row-data":N.value,"page-info":ae.value,onSelectedRow:qe,onOnClickRequestArticle:de,onDoubleClickedRow:Ge},null,8,["row-data","page-info"]),I.value&&w.value?(m(),S(qa,{key:0,"row-data":w.value,onSelectedRow:ge,onOnClickWorkerAssign:o},null,8,["row-data"])):P("",!0)])]),_:1}),l(a(et),{id:"preview-panel",size:"30","max-size":"50","min-size":"20"},{default:K(()=>{var j;return[l(ka,{"request-id":(j=b.value)==null?void 0:j.id,"request-item":k.value,"is-show-drop-zone":!0,"is-show-m-a-m":!0},null,8,["request-id","request-item"])]}),_:1})]),_:1}),C.value?(m(),S(Il,{key:0,"article-id":X.value,"onUpdate:articleId":f[4]||(f[4]=j=>X.value=j),"request-article-title":ue.value,"onUpdate:requestArticleTitle":f[5]||(f[5]=j=>ue.value=j),onClose:f[6]||(f[6]=j=>C.value=!1),onOnCreate:Re},null,8,["article-id","request-article-title"])):P("",!0),i.value?(m(),S(Ul,{key:1,"request-graphic-id":(T=b.value)==null?void 0:T.id,onClose:f[7]||(f[7]=j=>i.value=!1),onOnUpdateItem:Ve,onOnUpdate:Te},null,8,["request-graphic-id"])):P("",!0),p.value?(m(),S(El,{key:2,onClose:f[8]||(f[8]=j=>p.value=!1)})):P("",!0),y.value?(m(),S(Kl,{key:3,"request-item":k.value,onOnAssignWorker:M,onClose:f[9]||(f[9]=j=>y.value=!1)},null,8,["request-item"])):P("",!0)])}}});export{ho as default};
