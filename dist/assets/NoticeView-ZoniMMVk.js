import{d as P,a as O,h as Y,al as ue,am as pe,a6 as fe,ew as me,aD as K,aO as ve,k as r,o as H,b3 as Q,ai as G,c as A,G as l,w as F,j as I,Y as a,a1 as L,aj as S,a2 as R,K as B,aq as ne,c6 as we,t as ie,b8 as de,b as re,aP as xe,aG as ge}from"./index-eLyz9_Ts.js";import{r as se}from"./use-render-component-K20sHqiA.js";import{_ as he}from"./SearchForm.vue_vue_type_script_setup_true_lang-iGmgdrLf.js";import{g as J,M as X}from"./splitpanes.es-dEoJOrhT.js";import{_ as Z}from"./GEditor.vue_vue_type_script_setup_true_lang-a2qGOvtc.js";import"./GEditor.vue_vue_type_style_index_0_lang-FifEywK1.js";import{_ as ee}from"./FileDropzone.vue_vue_type_script_setup_true_lang-SVeHifZw.js";import{u as te}from"./file-Gx0JxWZZ.js";import{F as ce}from"./file-division-code-x51qUgaH.js";import"./use-model-wrapper-XtiLc3Xd.js";import"./FileListView.vue_vue_type_script_setup_true_lang-A40KFqZZ.js";import"./GNoData.vue_vue_type_script_setup_true_lang-rWUb5JCO.js";import"./GVideoPlayer-1SUF8s3O.js";import"./main-sHItgwS4.js";import"./vue.runtime.esm-bundler-3P3R-Xon.js";const ye=P({__name:"NoticeList",props:{height:{default:""},isLoading:{type:Boolean,default:!1},rowData:{default:()=>[]},pageInfo:{},selectedRowIndex:{default:0}},emits:["selected-rows","double-clicked-row","on-update-toggle","on-change-page"],setup(h,{emit:s}){const d=h,u=s,m=n=>{const _=document.createElement("div");_.className="h-full";const U={"onUpdate:modelValue":V=>{u("on-update-toggle",n.data.notiId,V)},modelValue:n.data.notiYn==="Y"};return se(me,U,_)},v=n=>{const _=n[0];u("selected-rows",_)},p=[{headerName:"순번",filter:!1,maxWidth:80,valueGetter:"node.rowIndex",cellRenderer:n=>pe(n)},{headerName:"제목",field:"notiTitl",filter:!1},{headerName:"첨부파일",maxWidth:150,field:"attcFiles",filter:!1,cellRenderer:n=>n.value.length===0?"":se(fe,{icon:"paper-clip",size:"w-4 h-4"},document.createElement("div"))},{headerName:"등록자",field:"inputrNm",maxWidth:150,filter:!1},{headerName:"등록일시",minWidth:130,maxWidth:180,field:"inputDtm",filter:!1},{headerName:"수정자",maxWidth:150,field:"updtrNm",filter:!1},{headerName:"수정일시",minWidth:130,maxWidth:180,field:"updtDtm",filter:!1},{headerName:"게시여부",field:"notiYn",maxWidth:120,filter:!1,cellRenderer:n=>m(n)}],N={rowData:d.rowData,columnDefs:p},D=n=>{u("double-clicked-row",n)},y=n=>{u("on-change-page",n)};return(n,_)=>(O(),Y(ue,{class:"w-full h-full flex flex-col","column-defs":p,"row-data":n.rowData,"grid-options":N,"is-loading":n.isLoading,"row-selection":"single","page-info":n.pageInfo,"selected-row-index":n.selectedRowIndex,onSelectedRows:v,onDoubleClickedRow:D,onOnChangePage:y},null,8,["row-data","is-loading","page-info","selected-row-index"]))}}),M=K(),be=ve("notice",{state:()=>({isLoading:!1,noticeItems:[]}),getters:{getNoticeItems(h){return h.noticeItems}},actions:{async fetchNotice(h){try{this.isLoading=!0;const s=await M.notice.basic.findAll(h);if(s.success)return this.noticeItems=s.data.content.map(d=>({...d,notiYn:d.notiYn})),s}catch(s){console.log(s)}finally{this.isLoading=!1}},async createNotice(h){try{this.isLoading=!0;const s=await M.notice.basic.create(h);if(s.success)return s}catch(s){console.log(s)}finally{this.isLoading=!1}},async deleteNotice(h){try{this.isLoading=!0;const s=await M.notice.basic.delete(h);if(s.success)return s}catch(s){console.log(s)}finally{this.isLoading=!1}},async updateNotice(h,s){try{this.isLoading=!0;const d=await M.notice.basic.update(h,s);if(d.success)return d}catch(d){console.log(d)}finally{this.isLoading=!1}}}}),ke={class:"space-y-3 text-xs h-full"},Ne={class:"p-2 space-y-2 border dark:border-dark-border rounded-md bg-white dark:bg-dark"},_e={class:"flex space-x-2 items-center"},Ce={class:"flex justify-between space-x-2"},Ve={class:"flex space-x-2"},De={class:"flex space-x-2 items-center"},Ue={class:"flex space-x-2 items-center"},Ie={class:"flex space-x-2 items-center"},Oe={class:"p-2 h-full bg-white dark:bg-dark border dark:border-dark-border rounded-md"},$e={class:"p-2 h-full bg-white dark:bg-dark border dark:border-dark-border rounded-md"},Le=P({__name:"NoticeDetail",props:{id:{default:null}},emits:["close"],setup(h,{emit:s}){const d=r(""),u=r(""),m=r(""),v=r(""),p=r(""),N=r(""),D=r(""),y=r(""),n=r([]),_=h,U=s,V=async()=>{const e=await K().notice.basic.findOne(_.id);try{if(e.success){const{notiTitl:$,notiCtt:t,inputrNm:i,inputDtm:g,updtrNm:k,updtDtm:z,inputrDeptNm:W,updtrDeptNm:j,attcFiles:q}=e.data;d.value=$,u.value=t,m.value=i,v.value=g,p.value=k,N.value=z,D.value=W,y.value=j,n.value=q.map(f=>({...f,name:f.fileNm,fileId:f.id}))}}catch($){console.log($)}},w=()=>{U("close")},{fileDownload:c}=te(),b=x=>{c(x.file)},C=x=>{x.key==="Escape"&&w()};return H(()=>{V(),window.addEventListener("keyup",C)}),Q(()=>{window.removeEventListener("keyup",C)}),(x,e)=>{const $=G("tooltip");return O(),A("div",ke,[l(I(X),{class:"default-theme"},{default:F(()=>[l(I(J),{class:"flex flex-col gap-2 overflow-auto"},{default:F(()=>[a("div",Ne,[a("div",_e,[e[9]||(e[9]=a("div",{class:"text-xs dark:text-white"},"제목",-1)),l(L,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),class:"flex-1",disabled:!0,title:d.value,placeholder:"Title"},null,8,["modelValue","title"])]),a("div",Ce,[a("div",Ve,[a("div",De,[e[10]||(e[10]=a("div",{class:"text-xs dark:text-white whitespace-nowrap"},"작성",-1)),l(L,{modelValue:D.value,"onUpdate:modelValue":e[1]||(e[1]=t=>D.value=t),class:"flex-1",disabled:!0,title:D.value,name:"inputDept"},null,8,["modelValue","title"]),l(L,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),class:"flex-1",disabled:!0,title:m.value,name:"inputer"},null,8,["modelValue","title"]),l(L,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=t=>v.value=t),class:"flex-1",disabled:!0,title:v.value,name:"inputDate"},null,8,["modelValue","title"])]),a("div",Ue,[e[11]||(e[11]=a("div",{class:"text-xs dark:text-white whitespace-nowrap"},"수정",-1)),l(L,{modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=t=>y.value=t),title:y.value,name:"updateDept",disabled:!0},null,8,["modelValue","title"]),l(L,{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=t=>p.value=t),title:p.value,name:"updater",disabled:!0},null,8,["modelValue","title"]),l(L,{modelValue:N.value,"onUpdate:modelValue":e[6]||(e[6]=t=>N.value=t),title:N.value,name:"updateDate",disabled:!0},null,8,["modelValue","title"])])]),a("div",Ie,[S(l(R,{icon:"x-mark",onClick:w},null,512),[[$,"취소"]])])])]),a("div",Oe,[u.value?(O(),Y(Z,{key:0,modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=t=>u.value=t),readonly:""},null,8,["modelValue"])):B("",!0)])]),_:1}),l(I(J),{"min-size":"30",size:"30"},{default:F(()=>[a("div",$e,[a("div",null,[e[12]||(e[12]=a("p",{class:"mb-2 dark:text-white text-xs"},"첨부파일",-1)),l(ee,{"file-data":n.value,"onUpdate:fileData":e[8]||(e[8]=t=>n.value=t),mode:"read","is-read-only":"",onOnDownloadFile:b},null,8,["file-data"])])])]),_:1})]),_:1})])}}}),Se={class:"space-y-3 text-xs h-full"},Fe={class:"flex space-x-2 items-center p-2 border dark:border-dark-border rounded-md bg-white dark:bg-dark"},Te={class:"flex flex-1 space-x-2 items-center"},Ee={class:"flex space-x-2 items-center"},Re={class:"p-2 h-full bg-white dark:bg-dark border dark:border-dark-border rounded-md"},Be=P({__name:"NoticeUpdate",props:{id:{type:Number,default:null}},emits:["close","on-update"],setup(h,{emit:s}){const{fileUpload:d,fileDownload:u}=te(),m=r(""),v=r(""),p=r([]),N=[],D=h,y=s,{swalConfirm:n}=re(),{changeTabCanClosed:_}=ne(),U=r(!1),V=r({title:"",contents:"",files:[]}),w=async()=>{const i=await K().notice.basic.findOne(D.id);try{i.success&&(m.value=i.data.notiTitl,v.value=i.data.notiCtt,p.value=i.data.attcFiles.map(g=>({...g,name:g.fileNm,fileId:g.id})),N.value=i.data.attcFiles.map(g=>g.id),V.value.title=JSON.parse(JSON.stringify(m.value)),V.value.contents=JSON.parse(JSON.stringify(v.value)),V.value.files=JSON.parse(JSON.stringify(p.value)))}catch(g){console.log(g)}},c=async t=>{t.map(async i=>{const g={fileName:i.name,publicYn:"Y",fileDivisionCode:ce.Board.id,file:i};try{const k=await d(g);k.success&&N.value.push(k.data.id)}catch(k){console.log("Fail to add file",k)}})},b=t=>{u(t.file)},C=async(t,i)=>{N.value.splice(i,1),p.value.splice(i,1)},x=async()=>{if(!m.value||!v.value){window.Notify.error({message:"입력하신 정보를 확인해주세요."});return}const t={notiTitl:m.value,notiCtt:v.value,attcFileIds:N.value};y("on-update",D.id,t),y("close")},e=()=>{U.value?n({html:"변경된 데이터가 있습니다.<br> 저장하시겠습니까?",confirmButtonText:"저장"}).then(t=>{t.isConfirmed?x():y("close"),_(!0)}):y("close")},$=t=>{t.key==="Escape"&&e()};return we(async()=>{await w(),window.addEventListener("keyup",$)}),Q(()=>{window.removeEventListener("keyup",$)}),ie(()=>[m.value,v.value,p.value],([t,i,g])=>{const{title:k,contents:z,files:W}=V.value;(t!==k||JSON.stringify(z)!==JSON.stringify(i)||JSON.stringify(g)!==JSON.stringify(W))&&(U.value=!0),_(!U.value)},{deep:!0}),(t,i)=>{const g=G("tooltip");return O(),A("div",Se,[l(I(X),{class:"default-theme"},{default:F(()=>[l(I(J),{class:"flex flex-col gap-2 overflow-auto"},{default:F(()=>[a("div",Fe,[a("div",Te,[i[3]||(i[3]=a("div",{class:"text-xs dark:text-white"},"제목",-1)),l(L,{modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=k=>m.value=k),title:m.value,name:"Title",focus:!0,placeholder:"제목을 입력하세요.",class:"flex-1"},null,8,["modelValue","title"])]),a("div",Ee,[S(l(R,{"button-text":"저장",icon:"arrow-down-tray",onClick:x},null,512),[[g,"저장"]]),S(l(R,{icon:"x-mark",onClick:e},null,512),[[g,"취소"]])])]),v.value?(O(),Y(Z,{key:0,modelValue:v.value,"onUpdate:modelValue":i[1]||(i[1]=k=>v.value=k)},null,8,["modelValue"])):B("",!0)]),_:1}),l(I(J),{"min-size":"25",size:"25"},{default:F(()=>[a("div",Re,[a("div",null,[i[4]||(i[4]=a("p",{class:"mb-2 dark:text-white text-xs"},"첨부파일",-1)),l(de,{text:"게시글 저장시 파일 첨부가 완료됩니다.",type:"warning"}),l(ee,{"file-data":p.value,"onUpdate:fileData":i[2]||(i[2]=k=>p.value=k),mode:"edit",onOnDownloadFile:b,onOnDeleteFile:C,onOnUploadFile:c},null,8,["file-data"]),i[5]||(i[5]=a("div",{class:"text-error text-xs"},[a("p",null,"* 파일하나 당 최대 200MB까지 업로드 할 수 있습니다."),a("p",null,"* 등록 개수는 최대 5개 입니다.")],-1))])])]),_:1})]),_:1})])}}}),Ye={class:"space-y-3 text-xs h-full"},Je={class:"flex space-x-2 items-center p-2 border dark:border-dark-border rounded-md bg-white dark:bg-dark"},ze={class:"flex flex-1 space-x-2 items-center"},We={class:"flex space-x-2 items-center"},Ae={class:"p-2 h-full bg-white dark:bg-dark border dark:border-dark-border rounded-md"},Pe=P({__name:"NoticeCreate",emits:["close","onSave"],setup(h,{emit:s}){const d=r(""),u=r(""),m=s,v=r(!1),p=r([]),{fileUpload:N}=te(),{swalConfirm:D}=re(),{changeTabCanClosed:y}=ne(),n=async()=>{var b;if(!p.value)return[];const w=(b=p==null?void 0:p.value)==null?void 0:b.map(async C=>{const x={fileName:C.name,publicYn:"Y",fileDivisionCode:ce.Board.id,file:C},e=await N(x);if(e.success)return e.data.id});return await Promise.all(w)},_=async()=>{if(!d.value||!u.value){window.Notify.error({message:"입력하신 정보를 확인해주세요."});return}const w=await n(),c={notiTitl:d.value,notiCtt:u.value,attcFileIds:w};m("onSave",c),m("close")},U=()=>{v.value?D({html:"변경된 데이터가 있습니다.<br> 저장하시겠습니까?",confirmButtonText:"저장"}).then(w=>{w.isConfirmed?_():m("close"),y(!0)}):m("close")},V=w=>{w.key==="Escape"&&U()};return ie(()=>[d.value,u.value,p.value],([w,c,b])=>{(w!==""||b.length||c!=="")&&(v.value=!0),y(!v.value)},{deep:!0}),H(()=>{window.addEventListener("keyup",V)}),Q(()=>{window.removeEventListener("keyup",V)}),(w,c)=>{const b=G("tooltip");return O(),A("div",Ye,[l(I(X),{class:"default-theme"},{default:F(()=>[l(I(J),{class:"flex flex-col gap-2 overflow-auto"},{default:F(()=>[a("div",Je,[a("div",ze,[c[3]||(c[3]=a("div",{class:"text-xs dark:text-white"},"제목",-1)),l(L,{modelValue:d.value,"onUpdate:modelValue":c[0]||(c[0]=C=>d.value=C),title:d.value,name:"Title",focus:!0,placeholder:"제목을 입력하세요.",class:"flex-1"},null,8,["modelValue","title"])]),a("div",We,[S(l(R,{"button-text":"저장",icon:"arrow-down-tray",onClick:_},null,512),[[b,"저장"]]),S(l(R,{icon:"x-mark",onClick:U},null,512),[[b,"취소"]])])]),l(Z,{modelValue:u.value,"onUpdate:modelValue":c[1]||(c[1]=C=>u.value=C)},null,8,["modelValue"])]),_:1}),l(I(J),{"min-size":"30",size:"30"},{default:F(()=>[a("div",Ae,[a("div",null,[c[4]||(c[4]=a("p",{class:"mb-2 dark:text-white text-xs"},"첨부파일",-1)),l(de,{text:"게시글 저장시 파일 첨부가 완료됩니다.",type:"warning"}),l(ee,{"file-data":p.value,"onUpdate:fileData":c[2]||(c[2]=C=>p.value=C),mode:"create","is-read-only":!1},null,8,["file-data"]),c[5]||(c[5]=a("div",{class:"text-error text-xs"},[a("p",null,"* 파일하나 당 최대 200MB까지 업로드 할 수 있습니다."),a("p",null,"* 등록 개수는 최대 5개 입니다.")],-1))])])]),_:1})]),_:1})])}}}),Me={key:0,class:"flex flex-col h-full gap-y-3"},Ge={class:"flex justify-between items-center flex-wrap"},je={class:"flex gap-x-1.5"},rt=P({__name:"NoticeView",setup(h){const s=r(""),d=r(1),u=r(),m=r(0),v=r(),p=be(),{fetchNotice:N,createNotice:D,deleteNotice:y,updateNotice:n}=p,{isLoading:_}=xe(p),U=r(),V=r(),w=r(!1),c=r(!1),b=r(!1),C=f=>{if(!f)return;const o=f.rowIndex;m.value=o,u.value=f.data},x=async()=>{const f={searchValue:s.value.value??"",page:d.value-1};try{const o=await N(f);o.success&&(V.value={isShow:!0,page:d.value,totalPages:o.data.totalPages,totalElements:o.data.totalElements,numberOfElements:o.data.numberOfElements,size:o.data.size},U.value=o.data.content)}catch(o){console.log(o)}},e=f=>{d.value=1,s.value=f,x()},$=()=>{w.value=!0},t=async f=>{try{const o=await D(f);await x(),o.success&&window.Notify.success({message:"작성 완료되었습니다."})}catch(o){window.Notify.error({message:"서버 연결이 불안정합니다."}),console.log(o)}},i=async(f,o)=>{const T={notiYn:o?"Y":"N"};try{(await n(f,T)).success&&(window.Notify.success({message:"[공지사항 수정] 완료되었습니다."}),await x())}catch(E){console.log(E)}},g=()=>{c.value=!0},k=async(f,o)=>{const T={notiTitl:o.notiTitl,notiCtt:o.notiCtt,attcFileIds:o.attcFileIds};try{(await n(f,T)).success&&await x()}catch(E){console.log(E)}},z=async()=>{var f;try{const o=await y((f=u.value)==null?void 0:f.notiId);await x(),o.success&&window.Notify.success({message:"삭제 되었습니다."})}catch(o){console.log(o)}},W=f=>{v.value=f.data,b.value=!0},j=()=>{d.value=1,s.value="",x(),m.value=0},q=f=>{d.value=f,x()};return H(()=>{x()}),(f,o)=>{var E,ae,le;const T=G("tooltip");return O(),A("div",null,[!w.value&&!c.value&&!b.value?(O(),A("div",Me,[a("div",Ge,[l(he,{"search-value":s.value.value,class:"gap-1.5","onClick:search":e},null,8,["search-value"]),a("div",je,[S(l(I(R),{icon:"arrow-path",onClick:j},null,512),[[T,"새로고침"]]),S(l(I(R),{icon:"plus",onClick:$},null,512),[[T,"추가"]]),S(l(I(R),{icon:"pencil",disabled:!u.value,onClick:g},null,8,["disabled"]),[[T,"수정"]]),S(l(ge,{icon:"trash","delete-count":1,title:(E=u.value)==null?void 0:E.notiTitl,disabled:!u.value,onOnConfirm:z},null,8,["title","disabled"]),[[T,"삭제"]])])]),l(ye,{"is-loading":I(_),"row-data":U.value,"selected-row-index":m.value,"page-info":V.value,onSelectedRows:C,onDoubleClickedRow:W,onOnUpdateToggle:i,onOnChangePage:q},null,8,["is-loading","row-data","selected-row-index","page-info"])])):B("",!0),w.value?(O(),Y(Pe,{key:1,class:"flex flex-col h-full",onClose:o[0]||(o[0]=oe=>w.value=!1),onOnSave:t})):B("",!0),c.value?(O(),Y(Be,{key:2,id:(ae=u.value)==null?void 0:ae.notiId,class:"flex flex-col h-full",onOnUpdate:k,onClose:o[1]||(o[1]=oe=>c.value=!1)},null,8,["id"])):B("",!0),b.value?(O(),Y(Le,{key:3,id:(le=u.value)==null?void 0:le.notiId,class:"flex flex-col h-full",onClose:o[2]||(o[2]=oe=>b.value=!1)},null,8,["id"])):B("",!0)])}}});export{rt as default};
