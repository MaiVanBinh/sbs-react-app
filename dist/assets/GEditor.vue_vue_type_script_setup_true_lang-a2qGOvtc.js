import{d as K,k as A,cN as H,x as O,b3 as b,v as U,dx as R,o as P,y as M,H as G,j as d,cA as Y,V as q,aw as Q,a as u,c as v,F as g,C as N,Y as k,h as z,a6 as m,ax as _,X as B,a0 as E,G as T,Q as f,K as D}from"./index-eLyz9_Ts.js";import{E as X,S as J,U as W,T as Z,a as ee,F as te,C as ie,I as ae}from"./GEditor.vue_vue_type_style_index_0_lang-FifEywK1.js";import{F as ce}from"./file-division-code-x51qUgaH.js";import{u as ne}from"./file-Gx0JxWZZ.js";function I(s){return Y((o,n)=>({get(){return o(),s},set(a){s=a,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}class oe extends X{constructor(o={}){return super(o),this.contentComponent=null,this.appContext=null,this.reactiveState=I(this.view.state),this.reactiveExtensionStorage=I(this.extensionStorage),this.on("beforeTransaction",({nextState:n})=>{this.reactiveState.value=n,this.reactiveExtensionStorage.value=this.extensionStorage}),M(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(o,n){const a=super.registerPlugin(o,n);return this.reactiveState&&(this.reactiveState.value=a),a}unregisterPlugin(o){const n=super.unregisterPlugin(o);return this.reactiveState&&n&&(this.reactiveState.value=n),n}}const le=K({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(s){const o=A(),n=H();return O(()=>{const a=s.editor;a&&a.options.element&&o.value&&G(()=>{if(!o.value||!a.options.element.firstChild)return;const e=d(o.value);o.value.append(...a.options.element.childNodes),a.contentComponent=n.ctx._,n&&(a.appContext={...n.appContext,provides:n.provides}),a.setOptions({element:e}),a.createNodeViews()})}),b(()=>{const a=s.editor;a&&(a.contentComponent=null,a.appContext=null)}),{rootEl:o}},render(){return U("div",{ref:s=>{this.rootEl=s}})}}),se=(s={})=>{const o=R();return P(()=>{o.value=new oe(s)}),b(()=>{var n,a,e;const p=(n=o.value)===null||n===void 0?void 0:n.options.element,x=p==null?void 0:p.cloneNode(!0);(a=p==null?void 0:p.parentNode)===null||a===void 0||a.replaceChild(x,p),(e=o.value)===null||e===void 0||e.destroy()}),o},re={key:0,class:"flex flex-auto items-center border-b gap-[2px] p-2 pr-4 pl-4 dark:text-white border-gray-300 dark:border-slate-600"},ue={key:0,class:"relative inline-block text-left"},ve=["onClick"],pe=["onClick"],de=["onClick"],fe={for:"imageFileInput",class:"hidden"},xe=K({__name:"GEditor",props:{modelValue:{type:String,default:""},readonly:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s,{emit:o}){const n=s,a=o,e=se({editorProps:{attributes:{class:"p-4 h-full w-full dark:text-white"}},autofocus:!1,content:n.modelValue,extensions:[J,W,Z.configure({types:["heading","paragraph"]}),ee,te,ie,ae],onUpdate:t=>{const r=t.editor.getHTML();a("update:modelValue",r)}}),p=A(),{fileUpload:x}=ne(),V=t=>{for(let l=0;l<t.length;l+=1)if(t[l].size>5242880)return window.Notify.error({message:"첨부파일 사이즈는 5MB 이내로 등록 가능합니다.",duration:3e3}),!1;return!0},L=async t=>{var l;const r={fileName:t[0].name,publicYn:"Y",fileDivisionCode:ce.Board.id,file:t[0]};try{const i=await x(r);if(i.success){const y=`http://192.168.1.11:9000/api/files/${i.data.fileUrl}`;(l=e==null?void 0:e.value)==null||l.chain().focus().setImage({src:y}).run()}}catch(i){console.log("Fail to add file",i)}},$=async t=>{const l=t.target.files;l&&V(l)&&L(l),p.value.value=null},F=q([{selectOriginText:"Normal",activeType:"fontFamily",activeKey:"textStyle",childShow:!1,clickAction:()=>{},options:[{activeText:"Normal",activeType:{fontFamily:"Pretendard"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setFontFamily("Pretendard").run()}},{activeText:"Comic Sans",activeType:{fontFamily:"Comic Sans MS, Comic Sans"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setFontFamily("Comic Sans MS, Comic Sans").run()}},{activeText:"serif",activeType:{fontFamily:"serif"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setFontFamily("serif").run()}},{activeText:"monospace",activeType:{fontFamily:"monospace"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setFontFamily("monospace").run()}},{activeText:"Cursive",activeType:{fontFamily:"cursive"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setFontFamily("cursive").run()}}]},{selectOriginText:"paragraph",activeType:"paragraph",activeKey:"heading",childShow:!1,clickAction:()=>{},options:[{activeText:"heading1",activeType:{level:1},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleHeading({level:1}).run()}},{activeText:"heading2",activeType:{level:2},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleHeading({level:2}).run()}},{activeText:"heading3",activeType:{level:3},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleHeading({level:3}).run()}},{activeText:"heading4",activeType:{level:4},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleHeading({level:4}).run()}},{activeText:"heading5",activeType:{level:5},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleHeading({level:5}).run()}},{activeText:"heading6",activeType:{level:6},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleHeading({level:6}).run()}}]},{activeType:"textAlign",childShow:!1,iconName:"bars-3",clickAction:()=>{},options:[{activeText:"left",activeType:{textAlign:"left"},iconName:"bars-3-bottom-left",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setTextAlign("left").run()}},{activeText:"center",activeType:{textAlign:"center"},iconName:"bars-3-center-left",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setTextAlign("center").run()}},{activeText:"right",activeType:{textAlign:"right"},iconName:"bars-3-bottom-right",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setTextAlign("right").run()}},{activeText:"justify",activeType:{textAlign:"justify"},iconName:"bars-3",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setTextAlign("justify").run()}}]},{activeType:"textColor",activeKey:"textStyle",childShow:!1,clickAction:()=>{},options:[{activeText:"Black",activeType:{color:"#111827"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().unsetColor().run()}},{activeText:"Red",activeType:{color:"#F98181"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setColor("#F98181").run()}},{activeText:"Orange",activeType:{color:"#FBBC88"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setColor("#FBBC88").run()}},{activeText:"Yellow",activeType:{color:"#FAF594"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setColor("#FAF594").run()}},{activeText:"Green",activeType:{color:"#B9F18D"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setColor("#B9F18D").run()}},{activeText:"Blue",activeType:{color:"#70CFF8"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setColor("#70CFF8").run()}},{activeText:"Purple",activeType:{color:"#958DF1"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setColor("#958DF1").run()}},{activeText:"Teal",activeType:{color:"#94FADB"},clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().setColor("#94FADB").run()}}]},{activeType:"bold",iconName:"bold",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleBold().run()}},{activeType:"italic",iconName:"italic",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleItalic().run()}},{activeType:"underline",iconName:"underline",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleUnderline().run()}},{activeType:"strike",iconName:"strikethrough",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleStrike().run()}},{activeType:"bulletList",iconName:"listBullet",size:"4",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleBulletList().run()}},{activeType:"orderedList",iconName:"numberedList",size:"4",clickAction:()=>{var t;return(t=e==null?void 0:e.value)==null?void 0:t.chain().focus().toggleOrderedList().run()}},{activeType:"image",iconName:"photo",size:"4",clickAction:()=>p.value.click()}]),C=A(null);Q(C,()=>{F.forEach(t=>{const r=t;r.childShow&&(r.childShow=!1)})});const S=(t,r,l="")=>{let i=t;const c=r.find(h=>{var y,w;return l?(y=e.value)==null?void 0:y.isActive(`${l}`,h.activeType):(w=e.value)==null?void 0:w.isActive(h.activeType)});return c&&(i=c.activeText,c!=null&&c.iconName&&(i=(c==null?void 0:c.iconName)??"")),i},j=t=>{let r="#111827";const l=t.find(i=>{var c;return(c=e.value)==null?void 0:c.isActive("textStyle",i.activeType)});return l&&(r=l.activeType.color),r};return P(()=>{var t;n.readonly&&((t=e==null?void 0:e.value)==null||t.setEditable(!1))}),b(()=>{var t;(t=e==null?void 0:e.value)==null||t.destroy()}),(t,r)=>{var l;return u(),v("div",{class:f(["cms-custom-editor flex flex-auto flex-col overflow-hidden w-full h-full bg-white dark:bg-dark border shadow-sm rounded-md border-gray-300 dark:border-slate-600",{"outline-none border border-primary dark:border-primary":(l=d(e))==null?void 0:l.isFocused}])},[d(e)&&!s.readonly?(u(),v("section",re,[(u(!0),v(g,null,N(F,i=>(u(),v(g,{key:i.activeType},[i.options?(u(),v("div",ue,[k("button",{type:"button",class:f(["inline-flex justify-between items-center gap-x-1.5 rounded-md bg-white dark:bg-dark h-9 px-3 py-2 text-sm text-gray-900 dark:text-white border border-gray-300 dark:border-slate-600",[i.childShow?"outline-none border border-primary dark:border-primary":"",i.iconName?"w-14":i.activeType==="textColor"?"w-17":"w-40"]]),onClick:c=>i.childShow=!i.childShow},[i.iconName?(u(),z(m,{key:0,size:"w-4 h-4",icon:S(i.activeType,i.options,i.activeKey)},null,8,["icon"])):i.activeType==="textColor"?(u(),v("p",{key:1,class:"d-block w-5 h-5 rounded-sm",style:_({backgroundColor:j(i.options)||""})},null,4)):(u(),v(g,{key:2},[B(E(S(i.selectOriginText??"",i.options,i.activeKey)),1)],64)),T(m,{icon:"chevron-down",size:"h-4 w-4",class:"-mr-1 text-gray-400"})],10,ve),i.childShow?(u(),v("div",{key:0,ref_for:!0,ref_key:"optionsDiv",ref:C,class:f(["absolute left-0 z-10 mt-2 origin-top-right rounded-md bg-white dark:bg-dark shadow-lg ring-1 ring-black ring-opacity-5",i.iconName?"w-14":"w-44"])},[(u(!0),v(g,null,N(i.options,(c,h)=>(u(),v("div",{key:c.buttonText,class:f(["text-gray-700 m-2 p-2 text-sm cursor-pointer",{"text-primary font-bold":i.activeKey?d(e).isActive(`${i.activeKey}`,c.activeType):d(e).isActive(c.activeType),"font-bold":i.activeKey==="heading"}]),style:_({fontSize:i.activeKey==="heading"?["2rem","1.5rem","1.17rem","1rem","0.83rem","0.67rem"][h]:""}),onClick:c.clickAction},[c.iconName?(u(),z(m,{key:0,size:"w-4 h-4",icon:c.iconName,onClick:c.clickAction},null,8,["icon","onClick"])):(u(),v(g,{key:1},[B(E(c.activeText),1)],64))],14,pe))),128))],2)):D("",!0)])):(u(),v("div",{key:1,class:f({"bg-primary rounded-sm":d(e).isActive(i.activeType),"flex items-center justify-center p-2 cursor-pointer w-8 h-8":!0}),onClick:i.clickAction},[T(m,{size:i.size?`w-${i.size} h-${i.size}`:"w-3 h-3",icon:i.iconName},null,8,["size","icon"])],10,de))],64))),128))])):D("",!0),k("label",fe,[k("input",{id:"imageFileInput",ref_key:"imageFileInput",ref:p,type:"file",class:"hidden",accept:"image/png, image/gif, image/jpeg",onInput:$},null,544)]),T(d(le),{editor:d(e),class:f(["editor flex flex-auto overflow-y-auto w-full h-full",s.readonly?"bg-gray-200 dark:bg-dark-disabled":""])},null,8,["editor","class"])],2)}}});export{xe as _};
