import{d as L,a5 as W,l as j,V as Q,W as X,x as me,a as b,h as U,w as O,Y as i,a0 as R,G as m,j as u,a1 as H,X as P,a2 as C,a3 as J,al as ue,am as fe,k as r,t as A,c as D,K as z,ak as he,az as ge,c6 as ve,aD as _e,ad as we,o as be,ai as Te,aj as $,aG as K,F as xe,C as ye,Q as Ie}from"./index-eLyz9_Ts.js";import{t as Z}from"./async-validator.util-IJrtpoc1.js";import{_ as ke}from"./RequestItemImage.vue_vue_type_script_setup_true_lang-9Wg4vW2c.js";import{G as Ce}from"./GTextarea-5GIFD2Mo.js";import{N as Me}from"./no-image-ERwb0SRC.js";import{u as Ge}from"./use-model-wrapper-XtiLc3Xd.js";import{F as $e}from"./file-division-code-x51qUgaH.js";/* empty css                                                                  */const Ne={class:"flex flex-col space-x-2 h-full"},De={class:"flex flex-1 flex-col space-y-3 h-full"},Oe={class:"sm:flex sm:flex-row-reverse"},Fe={class:"space-x-3 flex items-center"},Ue=L({__name:"GraphicTemplateInfoModal",props:{mode:{default:"create"},selectedTemplate:{default:void 0}},emits:["close","on-create","on-update"],setup(F,{emit:f}){const t=F,g=f,{t:p}=W(),M=j(()=>t.mode==="create"?p("Modal.GraphicTemplate.GraphicTemplateInfoModal.그래픽_템플릿_등록"):p("Modal.GraphicTemplate.GraphicTemplateInfoModal.그래픽_템플릿_수정")),w=()=>{g("close")},h=Q({title:""}),{pass:l,errorFields:v}=X(h,Z),T=()=>{const o={templateName:h.title};t.mode==="create"?g("on-create",o):g("on-update",t.selectedTemplate.id,o),w()};return me(()=>{t.mode==="edit"&&t.selectedTemplate&&(h.title=t.selectedTemplate.templateName)}),(o,y)=>(b(),U(J,{"modal-class":"w-1/3",onClose:w},{title:O(()=>[i("div",null,R(M.value),1)]),content:O(()=>{var c,d,_;return[i("div",Ne,[i("div",De,[m(u(H),{modelValue:h.title,"onUpdate:modelValue":y[0]||(y[0]=N=>h.title=N),"error-placeholder":"","error-msg":(d=(c=u(v))==null?void 0:c.title)!=null&&d.length?(_=u(v))==null?void 0:_.title[0].message:"",placeholder:"템플릿명",label:"템플릿명",required:""},null,8,["modelValue","error-msg"]),i("div",Oe,[i("div",Fe,[m(C,{type:"secondary",class:"dark:bg-dark-secondary dark:text-white dark:hover:bg-gray-600",onClick:w},{default:O(()=>y[1]||(y[1]=[P("취소")])),_:1}),m(C,{disabled:!u(l),onClick:T},{default:O(()=>[P(R(o.mode==="create"?"추가":"수정"),1)]),_:1},8,["disabled"])])])])])]}),_:1}))}}),Ve=L({__name:"GraphicTemplateList",props:{isLoading:{type:Boolean},rowData:{},customColumn:{},pageInfo:{}},emits:["selected-rows","double-clicked-row","on-change-page","on-update-item-order"],setup(F,{emit:f}){const t=f,g=[{headerName:"",suppressMovable:!0,field:"drag",sortable:!1,maxWidth:40,rowDrag:!0},{headerName:"",suppressMovable:!0,field:"checkbox",sortable:!1,maxWidth:50,headerCheckboxSelection:!0,checkboxSelection:!0,showDisabledCheckboxes:!0},{headerName:"순번",suppressMovable:!0,field:"NO",maxWidth:60,valueGetter:"node.rowIndex",cellRenderer:l=>fe(l)},{headerName:"이미지",field:"file.fileUrl",suppressMovable:!0,resizable:!1,cellClass:"flex items-center justify-center flex-none",maxWidth:114,cellRenderer:ke,cellRendererParams:l=>{const{file:{fileUrl:v}}=l.data;return{imageUrl:`http://192.168.1.11:9000/api/files/${v}`}}},{headerName:"이름",minWidth:260,suppressMovable:!0,field:"templateItemName"},{headerName:"설명",suppressMovable:!0,field:"explain"}],p=l=>{t("selected-rows",l)},M=l=>{t("double-clicked-row",l)},w=l=>{t("on-update-item-order",l)},h=l=>{t("on-change-page",l)};return(l,v)=>(b(),U(ue,{"column-defs":g,"row-data":l.rowData,"is-loading":l.isLoading,filter:!1,sortable:!1,"page-info":l.pageInfo,"suppress-movable":!1,"row-selection":"multiple","row-drag-managed":!0,"row-drag-multi-row":!0,"row-height":60,"first-selected-row":!1,onSelectedRows:p,onDoubleClickedRow:M,onOnRowDragEnd:w,onOnChangePage:h},null,8,["row-data","is-loading","page-info"]))}}),Se={class:"text-xs text-gray-700 dark:text-gray-200"},Re={key:0,class:"space-y-1"},Le={class:"filebox flex space-x-2"},Ee=["value","title"],je={class:"flex items-center justify-center p-4"},Pe=["src"],ze=["src"],We=["src"],Ae=L({__name:"GraphicTemplateMetaData",props:{graphicTemplateData:{default:()=>({graphicTemplateId:0,title:"",file:null,explain:""})},mode:{default:"create"}},emits:["update:graphicTemplateData","on-pass"],setup(F,{emit:f}){const t=F,g=f,p=Ge(t,g,"graphicTemplateData"),M="http://192.168.1.11:9000/api/files",w=r(),h=r(""),l=r(""),v=r(p.value.file),T=G=>{w.value=G.target.files[0],p.value.file=G.target.files[0],h.value=G.target.files[0].name,l.value=URL.createObjectURL(w.value)},o=()=>{w.value=null,h.value="",l.value="",p.value.file=v.value},y=j(()=>t.mode==="read"),c=Q({title:p.value.title}),{pass:d,errorFields:_}=X(c,Z);A(()=>d.value,()=>{g("on-pass",d.value)},{immediate:!0});const N=G=>{p.value.title=G};return(G,x)=>{var I,E,V;return b(),D("div",null,[i("div",Se,[G.mode!=="read"?(b(),D("div",Re,[x[3]||(x[3]=i("span",null,"첨부파일",-1)),i("div",Le,[i("input",{class:"upload-name flex-1 p-1 inline-block align-center rounded-md appearance-none border dark:border-dark-border",value:h.value,title:h.value,name:"fileName",disabled:!0},null,8,Ee),x[2]||(x[2]=i("label",{for:"upload_file"},[i("span",null,"첨부파일")],-1)),i("input",{id:"upload_file",type:"file",class:"upload-hidden",accept:".jpeg, .jpg, .png, .svg",onChange:T},null,32),l.value?(b(),U(he,{key:0,icon:"x-mark",onClick:o})):z("",!0)])])):z("",!0),i("div",je,[v.value&&!l.value?(b(),D("img",{key:0,src:`${M}/${v.value.fileUrl}`,alt:"img",class:"h-44 aspect-video rounded-md"},null,8,Pe)):l.value?(b(),D("img",{key:1,src:l.value,alt:"img",class:"h-44 aspect-video rounded-md"},null,8,ze)):(b(),D("img",{key:2,src:u(Me),alt:"no-image",class:"h-44 aspect-video rounded-md"},null,8,We))])]),m(u(H),{modelValue:c.title,"onUpdate:modelValue":[x[0]||(x[0]=S=>c.title=S),N],"error-placeholder":"","error-msg":(E=(I=u(_))==null?void 0:I.title)!=null&&E.length?(V=u(_))==null?void 0:V.title[0].message:"",placeholder:"템플릿명",label:"템플릿명",required:"",disabled:y.value},null,8,["modelValue","error-msg","disabled"]),i("div",null,[m(Ce,{modelValue:u(p).explain,"onUpdate:modelValue":x[1]||(x[1]=S=>u(p).explain=S),placeholder:"설명",label:"설명",rows:8,disabled:y.value},null,8,["modelValue","disabled"])])])}}}),Be=ge(Ae,[["__scopeId","data-v-c185b723"]]),Ye={class:"flex flex-col space-y-2 h-full"},qe={class:"flex flex-col space-y-2 px-2 h-full overflow-auto"},Ke={class:"sm:flex sm:flex-row-reverse"},Qe={class:"space-x-3 flex items-center"},Xe=L({__name:"GraphicTemplateItemInfoModal",props:{mode:{default:"create"},selectedTemplateItem:{}},emits:["close","on-create","on-update"],setup(F,{emit:f}){const t=F,g=f,{t:p}=W(),M=j(()=>t.mode==="create"?p("Modal.GraphicTemplate.GraphicTemplateItemInfoModal.템플릿_아이템_등록"):p("Modal.GraphicTemplate.GraphicTemplateItemInfoModal.템플릿_아이템_수정")),w=r(!1),h=j(()=>w.value),l=r({graphicTemplateId:0,title:"",explain:"",file:null}),v=r(!1),T=()=>{g("close")},o=()=>{t.mode==="create"?g("on-create",l.value):g("on-update",l.value,v.value),T()},y=c=>{w.value=c};return ve(()=>{var c,d,_;t.mode==="edit"&&(l.value={graphicTemplateId:(c=t.selectedTemplateItem)==null?void 0:c.graphicTemplateId,graphicTemplateItemId:t.selectedTemplateItem.id,explain:(d=t.selectedTemplateItem)==null?void 0:d.explain,file:(_=t.selectedTemplateItem)==null?void 0:_.file,title:t.selectedTemplateItem.templateItemName})}),A(()=>l.value.file,c=>{v.value=c===t.selectedTemplateItem.file},{deep:!0}),(c,d)=>(b(),U(J,{"modal-class":"xl:w-1/3","content-class":"h-[65vh]",onClose:T},{title:O(()=>[i("div",null,R(M.value),1)]),content:O(()=>[i("div",Ye,[i("div",qe,[m(Be,{"graphic-template-data":l.value,"onUpdate:graphicTemplateData":d[0]||(d[0]=_=>l.value=_),class:"space-y-2",onOnPass:y},null,8,["graphic-template-data"])]),i("div",Ke,[i("div",Qe,[m(C,{type:"secondary",class:"dark:bg-dark-secondary dark:text-white dark:hover:bg-gray-600",onClick:T},{default:O(()=>d[1]||(d[1]=[P("취소")])),_:1}),m(C,{disabled:!h.value,onClick:o},{default:O(()=>[P(R(c.mode==="create"?"추가":"수정"),1)]),_:1},8,["disabled"])])])])]),_:1}))}}),He={class:"flex items-center justify-end mb-3"},Je={class:"flex flex-wrap gap-1.5"},Ze={class:"flex items-center flex-wrap gap-1.5"},ea={class:"flex flex-col h-full overflow-hidden"},aa={class:"flex justify-between space-x-2 h-full w-full"},ta={class:"w-96 space-y-2 flex flex-col"},la={class:"dark:bg-dark-grid dark:text-dark-gray-200 bg-white flex flex-col border border-gray-300 dark:border-dark rounded-lg overflow-y-auto"},sa={class:"flex justify-end flex-wrap gap-1.5 p-2 border-b dark:border-dark-border"},oa={class:"w-full overflow-y-auto"},ia=["onClick"],na={class:"text-sm"},ga=L({__name:"GraphicTemplateManagementView",setup(F){const{t:f}=W(),t=_e(),g=r(we.sm),p=r(1),M=r("asc"),w=r(""),h=r(!1),l=r({isShow:!0,page:1,totalElements:0,totalPages:1,numberOfElements:0,size:g.value}),v=r(!1),T=r(),o=r(),y=r([]),c=r([]),d=r("create"),_=r(!1),N=r(!1),G=()=>{d.value="create",_.value=!0},x=async()=>{try{const e=await t.graphicTemplate.template.findAll();e.success&&(T.value=e.data)}catch(e){console.log("Fail to get graphic template",e)}},I=async e=>{const s={page:p.value-1,size:g.value,sort:M.value,searchValue:w.value,graphicTemplateId:e};try{v.value=!0;const a=await t.graphicTemplate.item.findAll(s);a.success&&(y.value=a.data.content,l.value={isShow:!0,page:p.value,totalElements:a.data.totalElements,totalPages:a.data.totalPages,numberOfElements:a.data.numberOfElements,size:a.data.size})}catch(a){console.log("Fail to get graphic template list",a)}finally{v.value=!1}},E=()=>{d.value="create",N.value=!0},V=async e=>{let s;const a={file:e,publicYn:"Y",fileDivisionCode:$e.Graphic.id};try{const n=await t.file.basic.upload(a);if(n.success)return s=n.data.id,s}catch(n){console.log("Fail to upload file",n)}},S=async e=>{var n;let s;e.file&&(s=await V(e.file));const a={templateItemName:e.title,graphicTemplateId:e.graphicTemplateId||((n=o.value)==null?void 0:n.id),explain:e.explain||null,fileId:s||null};try{(await t.graphicTemplate.item.create(a)).success&&(window.Notify.success({message:"[그래픽 템플릿 아이템 등록] 완료되었습니다."}),await I(o.value.id))}catch(k){console.log("Fail to create graphic template item",k)}},ee=async(e,s)=>{var k;let a=null;e.file&&!s&&(a=await V(e.file));const n={templateItemName:e.title,explain:e.explain||null,fileId:s?(k=e==null?void 0:e.file)==null?void 0:k.id:a};try{(await t.graphicTemplate.item.update(e.graphicTemplateItemId,n)).success&&(window.Notify.success({message:"[그래픽 템플릿 아이템 등록] 완료되었습니다."}),await I(o.value.id))}catch(q){console.log("Fail to create graphic template item",q)}},ae=async()=>{var s,a,n;const e={graphicTemplateId:(s=o.value)==null?void 0:s.id,graphicTemplateItemIdList:(a=c.value)==null?void 0:a.map(k=>k.id)};try{(await t.graphicTemplate.item.batchDelete(e)).success&&(window.Notify.success({message:"[그래픽 템플릿 아이템 삭제] 완료되었습니다."}),await I((n=o.value)==null?void 0:n.id))}catch(k){console.log("Fail to delete graphic template item",k)}},te=async e=>{o.value=e,await I(o.value.id)},le=async e=>{c.value=e.map(s=>s.data)},se=async e=>{const s={templateName:e.templateName};try{(await t.graphicTemplate.template.create(s)).success&&(window.Notify.success({message:"[그래픽 템플릿 등록] 완료되었습니다."}),await x())}catch(a){console.log("Fail to create graphic template",a)}},oe=()=>{d.value="edit",_.value=!0},B=e=>{d.value="edit",c.value=e.data,N.value=!0},ie=async e=>{var a;const s={graphicTemplateId:e.node.data.graphicTemplateId,graphicTemplateItemIdList:e.nodes.map(n=>n.data.id),index:e.overIndex};try{(await t.graphicTemplate.item.changeOrder(s)).success&&await I((a=o.value)==null?void 0:a.id)}catch(n){console.log("Fail to update template item order",n)}},ne=e=>{var s;p.value=e,I((s=o.value)==null?void 0:s.id)},ce=async(e,s)=>{const a={templateName:s.templateName};try{(await t.graphicTemplate.template.update(e,a)).success&&(window.Notify.success({message:"[그래픽 템플릿 등록] 완료되었습니다."}),await x())}catch(n){console.log("Fail to create graphic template",n)}},re=async()=>{var e;try{(await t.graphicTemplate.template.delete((e=o.value)==null?void 0:e.id)).success&&(window.Notify.success({message:"[그래픽 템플릿 삭제] 완료되었습니다."}),await x())}catch(s){console.log("Fail to delete graphic template",s)}},de=()=>{_.value=!1},Y=async()=>{var e;await x(),o.value&&await I((e=o.value)==null?void 0:e.id)},pe=()=>{var e;I((e=o.value)==null?void 0:e.id)};return be(()=>{Y()}),A(()=>T.value,()=>{var e;(e=T.value)!=null&&e.length&&(o.value=T.value[0])}),(e,s)=>{const a=Te("tooltip");return b(),D("div",null,[i("div",He,[i("div",Je,[i("div",Ze,[$(m(C,{icon:"chat-bubble-left-ellipsis",onClick:s[0]||(s[0]=n=>h.value=!0)},null,512),[[a,"알림 메세지"]]),$(m(C,{icon:"arrow-path",onClick:pe},null,512),[[a,u(f)("GraphicTemplateManage.새로고침")]]),$(m(C,{icon:"plus",onClick:E},null,512),[[a,u(f)("GraphicTemplateManage.템플릿_아이템_등록")]]),$(m(C,{icon:"pencil",disabled:!c.value.length,onClick:B},null,8,["disabled"]),[[a,u(f)("GraphicTemplateManage.템플릿_아이템_수정")]]),$(m(K,{disabled:!c.value.length,onOnConfirm:ae},null,8,["disabled"]),[[a,u(f)("GraphicTemplateManage.템플릿_아이템_삭제")]])])])]),i("div",ea,[i("div",aa,[i("div",ta,[i("div",la,[i("div",sa,[$(m(C,{icon:"arrow-path",onClick:Y},null,512),[[a,u(f)("GraphicTemplateManage.새로고침")]]),$(m(C,{icon:"plus",onClick:G},null,512),[[a,u(f)("GraphicTemplateManage.그래픽_템플릿_등록")]]),$(m(C,{icon:"pencil",disabled:!o.value,onClick:oe},null,8,["disabled"]),[[a,u(f)("GraphicTemplateManage.그래픽_템플릿_수정")]]),$(m(K,{disabled:!o.value,onOnConfirm:re},null,8,["disabled"]),[[a,u(f)("GraphicTemplateManage.그래픽_템플릿_삭제")]])]),i("div",oa,[(b(!0),D(xe,null,ye(T.value,n=>(b(),D("div",{key:n.id,class:Ie(["dark:hover:bg-[#1e3b54] hover:bg-blue-100 border-b dark:border-dark-border p-2",[{"bg-blue-50 dark:bg-[#1e3b54]":o.value&&n.id===o.value.id}]]),onClick:k=>te(n)},[i("span",na,R(n.templateName),1)],10,ia))),128))])])]),m(Ve,{"page-info":l.value,"row-data":y.value,onSelectedRows:le,onDoubleClickedRow:B,onOnUpdateItemOrder:ie,onOnChangePage:ne},null,8,["page-info","row-data"])])]),_.value?(b(),U(Ue,{key:0,mode:d.value,"selected-template":o.value,onOnCreate:se,onOnUpdate:ce,onClose:de},null,8,["mode","selected-template"])):z("",!0),N.value&&o.value?(b(),U(Xe,{key:1,mode:d.value,"selected-template-item":c.value,onOnCreate:S,onOnUpdate:ee,onClose:s[1]||(s[1]=n=>N.value=!1)},null,8,["mode","selected-template-item"])):z("",!0)])}}});export{ga as default};
